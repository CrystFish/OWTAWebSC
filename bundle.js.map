{
  "version": 3,
  "sources": ["src/compat.ts", "src/AudioManager.ts", "src/Enums.ts", "src/Vector2.ts", "src/Entity.ts", "src/Button.ts", "src/Screen.ts", "src/DatabaseScreen.ts", "src/GlobalMessenger.ts", "src/PlayerData.ts", "src/GameSave.ts", "src/TitleScreen.ts", "src/EventScreen.ts", "src/ScreenManager.ts", "src/ExploreData.ts", "src/Telescope.ts", "src/Node.ts", "src/NodeConnection.ts", "src/Sector.ts", "src/ExploreScreen.ts", "src/NodeAction.ts", "src/SectorEditor.ts", "src/SectorScreen.ts", "src/SectorTelescopeScreen.ts", "src/AnglerfishNode.ts", "src/QuantumNode.ts", "src/SectorLibrary.ts", "src/SolarSystem.ts", "src/SectorButtons.ts", "src/SolarSystemScreen.ts", "src/SupernovaScreen.ts", "src/GameManager.ts", "src/Locator.ts", "src/StatusFeed.ts", "src/TimeLoop.ts", "src/app.ts"],
  "sourcesContent": ["import { SoundFile } from \"p5\";\r\n\r\nconst preloadCache: Record<string, any> = {};\r\n\r\nexport function println(...args: any[]) {\r\n    console.log(...args);\r\n}\r\n\r\nexport function preloadJSONObject(path: string): void {\r\n    preloadCache[path] = loadJSON(path);\r\n}\r\n\r\nexport function preloadAudio(path: string): void {\r\n    preloadCache[path] = loadSound(path);\r\n}\r\n\r\nexport function loadJSONObject(path: string): JSONObject {\r\n    if (path in preloadCache) {\r\n        return new JSONObject(preloadCache[path])\r\n    } else {\r\n        throw new Error(`JSON object was not preloaded! Path: ${path}`);\r\n    }\r\n}\r\n\r\nexport function saveJSONObject(obj: JSONObject, path: string): void {\r\n    throw new Error(\"Method not implemented.\");\r\n}\r\n\r\nexport function exit() {\r\n    window.location.reload();\r\n}\r\n\r\nexport class Minim {\r\n    loadFile(path: string): AudioPlayer {\r\n        if (path in preloadCache) {\r\n            const sound = preloadCache[path];\r\n            return new AudioPlayer(sound);\r\n        } else {\r\n            throw new Error(`Audio file was not preloaded! Path: ${path}`);\r\n        }\r\n    }\r\n}\r\n\r\nexport class AudioPlayer {\r\n    private _sound: SoundFile;\r\n\r\n    constructor(sound: SoundFile) {\r\n        this._sound = sound;\r\n    }\r\n\r\n    play() {\r\n        this._sound.play();\r\n    }\r\n    pause() {\r\n        this._sound.pause();\r\n    }\r\n}\r\n\r\nexport class JSONArray {\r\n    private _data: any[];\r\n\r\n    constructor(data: any[] = []) {\r\n        this._data = data;\r\n    }\r\n\r\n    size(): number {\r\n        return this._data.length;\r\n    }\r\n    getJSONObject(index: number): JSONObject {\r\n        const value = this._data[index];\r\n        if (typeof value === 'object' && !(value instanceof JSONObject)) {\r\n            return new JSONObject(value);\r\n        }\r\n        return value;\r\n    }\r\n    getString(index: number): string {\r\n        return this._data[index];\r\n    }\r\n    toJSON(key: string): any {\r\n        return this._data;\r\n    }\r\n}\r\n\r\nexport class JSONObject {\r\n    private _data: Record<string, any>;\r\n\r\n    constructor(data: Record<string, any> = {}) {\r\n        this._data = data;\r\n    }\r\n\r\n    hasKey(key: string): boolean {\r\n        return key in this._data;\r\n    }\r\n    getFloat(key: string, defaultValue?: number): number {\r\n        const value = this._data[key];\r\n        if (value === null || value === undefined) return defaultValue;\r\n        if (typeof value === 'number') return value;\r\n        return Number(value);\r\n    }\r\n    getInt(key: string, defaultValue?: number): number {\r\n        const value = this._data[key];\r\n        if (value === null || value === undefined) return defaultValue;\r\n        if (typeof value === 'number') return value;\r\n        return Number(value);\r\n    }\r\n    getString(key: string, defaultValue?: string): string {\r\n        const value = this._data[key];\r\n        if (value === null || value === undefined) return defaultValue;\r\n        if (typeof value === 'string') return value;\r\n        return JSON.stringify(value);\r\n    }\r\n    getBoolean(key: string, defaultValue?: boolean): boolean {\r\n        const value = this._data[key];\r\n        if (value === null || value === undefined) return defaultValue;\r\n        if (typeof value === 'boolean') return value;\r\n        return Boolean(value);\r\n    }\r\n    getJSONArray(key: string): JSONArray {\r\n        const value = this._data[key];\r\n        if (Array.isArray(value) && !(value instanceof JSONArray)) {\r\n            return new JSONArray(value);\r\n        }\r\n        return key in this._data ? value : null;\r\n    }\r\n    getJSONObject(key: string): JSONObject {\r\n        const value = this._data[key];\r\n        if (typeof value === 'object' && !(value instanceof JSONObject)) {\r\n            return new JSONObject(value);\r\n        }\r\n        return key in this._data ? value : null;\r\n    }\r\n    setFloat(key: string, value: number): this {\r\n        this._data[key] = value;\r\n        return this;\r\n    }\r\n    setInt(key: string, value: number): this {\r\n        this._data[key] = value;\r\n        return this;\r\n    }\r\n    setString(key: string, value: string): this {\r\n        this._data[key] = value;\r\n        return this;\r\n    }\r\n    setBoolean(key: string, value: boolean): this {\r\n        this._data[key] = value;\r\n        return this;\r\n    }\r\n    setJSONArray(key: string, value: JSONArray): this {\r\n        this._data[key] = value;\r\n        return this;\r\n    }\r\n    setJSONObject(key: string, value: JSONObject): this {\r\n        this._data[key] = value;\r\n        return this;\r\n    }\r\n    keys(): string[] {\r\n        return Object.keys(this._data);\r\n    }\r\n    toJSON(key: string): any {\r\n        return this._data;\r\n    }\r\n}\r\n", "import { minim } from \"./app\";\r\nimport { AudioPlayer, println } from \"./compat\";\r\n\r\nexport class SoundLibrary\r\n{\r\n  static kazooTheme: AudioPlayer;\r\n  \r\n  static loadSounds(): void\r\n  {\r\n    println(\"Sounds loading...\");\r\n    SoundLibrary.kazooTheme = minim.loadFile(\"data/audio/ow_kazoo_theme.mp3\");\r\n  }\r\n}\r\n\r\nexport class AudioManager\r\n{\r\n  static currentSound: AudioPlayer;\r\n  \r\n  constructor()\r\n  {\r\n    SoundLibrary.loadSounds();\r\n  }\r\n  \r\n  static play(sound: AudioPlayer): void\r\n  {\r\n    AudioManager.currentSound = sound;\r\n    AudioManager.currentSound.play();\r\n  }\r\n  \r\n  static pause(): void\r\n  {\r\n    if (AudioManager.currentSound != null)\r\n    {\r\n      AudioManager.currentSound.pause();\r\n    }\r\n    else\r\n    {\r\n      println(\"Current sound is NULL!!!\");\r\n    }\r\n  }\r\n}", "\r\nexport enum SectorName {NONE, ROCKY_TWIN, SANDY_TWIN, TIMBER_HEARTH, BRITTLE_HOLLOW, GIANTS_DEEP, DARK_BRAMBLE, COMET, QUANTUM_MOON, EYE_OF_THE_UNIVERSE};\r\n\r\nexport enum Frequency {BEACON, QUANTUM, TRAVELER};\r\n\r\nexport enum Curiosity {VESSEL, TIME_LOOP_DEVICE, QUANTUM_MOON, ANCIENT_PROBE_LAUNCHER};", "\r\nexport class Vector2\r\n{\r\n  x: number;\r\n  y: number;\r\n\r\n  constructor()\r\n  constructor(x: number, y: number)\r\n  constructor(vec: Vector2)\r\n  constructor(vecOrX?: Vector2 | number, y?: number) {\r\n    this.x = vecOrX instanceof Vector2 ? vecOrX.x : typeof vecOrX === 'number' ? vecOrX : 0\r\n    this.y = vecOrX instanceof Vector2 ? vecOrX.y : typeof y === 'number' ? y : 0\r\n  }\r\n\r\n  assign(vec: Vector2): void\r\n  {\r\n    this.x = vec.x;\r\n    this.y = vec.y;\r\n  }\r\n  \r\n  toString(): string{\r\n    return \"(\" + this.x + \", \" + this.y + \")\";\r\n  }\r\n  \r\n  dist(v: Vector2): number{\r\n    return v.sub(this).magnitude();\r\n  }\r\n  \r\n  add(v: Vector2): Vector2{\r\n    return new Vector2(this.x + v.x, this.y + v.y);\r\n  }\r\n  \r\n  sub(v: Vector2): Vector2{\r\n    return new Vector2(this.x - v.x, this.y - v.y);\r\n  }\r\n  \r\n  mult(value: number): Vector2{\r\n    return new Vector2(this.x * value, this.y * value);\r\n  }\r\n  \r\n  scale(value: number): Vector2{\r\n    this.x *= value;\r\n    this.y *= value;\r\n    return this;\r\n  }\r\n  \r\n  magnitude(): number{\r\n    return Math.max(Math.sqrt(this.x*this.x+this.y*this.y), 0.001);\r\n  }\r\n  \r\n  normalize(): Vector2{\r\n    const mag: number = this.magnitude();\r\n    this.x /= mag;\r\n    this.y /= mag;\r\n    return this;\r\n  }\r\n  \r\n  normalized(): Vector2{\r\n    const mag: number = this.magnitude();\r\n    return new Vector2(this.x/mag, this.y/mag);\r\n  }\r\n  \r\n  theta(): number{\r\n    return Math.atan2(this.y, this.x);\r\n  }\r\n  \r\n  dx(): number{\r\n    return this.x/this.magnitude();\r\n  }\r\n  \r\n  dy(): number{\r\n    return this.y/this.magnitude();\r\n  }\r\n  \r\n  leftNormal(): Vector2{\r\n    return new Vector2(this.y,-this.x);\r\n  }\r\n  rightNormal(): Vector2{\r\n    return new Vector2(-this.y,this.x);\r\n  }\r\n  \r\n  dot(v1: Vector2): number{\r\n    return(this.x * v1.x + this.y * v1.y);\r\n  }\r\n  \r\n  scaledDot(v1: Vector2): number{\r\n    return(this.x * v1.dx() + this.y * v1.dy());\r\n  }\r\n  \r\n  projectOnto(v2: Vector2): Vector2{\r\n    const dot: number = this.scaledDot(v2);\r\n    return new Vector2(dot * v2.dx(), dot * v2.dy());\r\n  }\r\n}", "import { OWNode } from \"./Node\";\r\nimport { Sector } from \"./Sector\";\r\nimport { Vector2 } from \"./Vector2\";\r\n\r\nexport class Entity\r\n{\r\n  position: Vector2;\r\n  screenPosition: Vector2;\r\n\r\n  parent: Entity | null = null;\r\n  _children: Entity[];\r\n  \r\n  constructor()\r\n  constructor(x: number, y: number)\r\n  constructor(pos: Vector2)\r\n  constructor(posOrX?: Vector2 | number, y?: number)\r\n  {\r\n    let pos: Vector2 = new Vector2()\r\n    if (typeof posOrX === 'number' && typeof y === 'number') {\r\n      pos = new Vector2(posOrX, y)\r\n    } else if (posOrX instanceof Vector2) {\r\n      pos = posOrX\r\n    }\r\n    this.position = new Vector2();\r\n    this.screenPosition = new Vector2();\r\n    this._children = [];\r\n\r\n    this.setPosition(pos);\r\n  }\r\n\r\n  setPosition(newPos: Vector2): void\r\n  setPosition(x: number, y: number): void\r\n  setPosition(newPosOrX: Vector2 | number, y?: number): void\r\n  {\r\n    this.position.x = newPosOrX instanceof Vector2 ? newPosOrX.x : newPosOrX;\r\n    this.position.y = newPosOrX instanceof Vector2 ? newPosOrX.y : y ?? 0;\r\n\r\n    // update child screen positions\r\n    if (this.parent != null)\r\n    {\r\n      this.updateScreenPosition(this.parent.screenPosition);\r\n    }\r\n    else \r\n    {\r\n      this.updateScreenPosition(new Vector2(0, 0));\r\n    }\r\n  }\r\n\r\n  updateScreenPosition(parentScreenPos: Vector2): void\r\n  {\r\n    this.screenPosition.assign(parentScreenPos.add(this.position));\r\n\r\n    for (let i: number = 0; i < this._children.length; i++)\r\n    {\r\n      this._children[i].updateScreenPosition(this.screenPosition);\r\n    }\r\n  }\r\n\r\n  setScreenPosition(newScreenPos: Vector2): void\r\n  {\r\n    if (this.parent == null)\r\n    {\r\n      this.setPosition(newScreenPos);\r\n    }\r\n    else \r\n    {\r\n      this.setPosition(newScreenPos.sub(this.parent.screenPosition));\r\n    }\r\n  }\r\n\r\n  draw(): void\r\n  {\r\n    // stub to override\r\n  }\r\n\r\n  render(): void\r\n  {\r\n    this.draw();\r\n  }\r\n\r\n  addChild(child: Entity): void\r\n  {\r\n    if (!this._children.includes(child))\r\n    {\r\n      this._children.push(child);\r\n      child.parent = this;\r\n      child.updateScreenPosition(this.screenPosition);\r\n    }\r\n  }\r\n\r\n  removeChild(child: Entity): void\r\n  {\r\n    if (this._children.includes(child)) {\r\n      this._children.splice(this._children.indexOf(child), 1);\r\n    }\r\n    child.parent = null;\r\n  }\r\n}\r\n\r\nexport class Actor extends Entity\r\n{\r\n  currentSector: Sector | null = null;\r\n  lastSector: Sector | null = null;\r\n  currentNode: OWNode | null = null;\r\n\r\n  static SPEED: number = 10;\r\n  \r\n  _moveTowardsTarget: boolean = false;\r\n  _targetScreenPos: Vector2;\r\n  _distToTarget: number = 0;\r\n  _offset: Vector2;\r\n  \r\n  constructor()\r\n  {\r\n    super(new Vector2(0, 0));\r\n    this._targetScreenPos = new Vector2();\r\n    this._offset = new Vector2(0, 0);\r\n  }\r\n\r\n  isDead(): boolean\r\n  {\r\n    return false;\r\n  }\r\n  \r\n  update(): void\r\n  {\r\n    this._offset.y = 0;\r\n    \r\n    if (this.currentNode == null || !this.currentNode.gravity)\r\n    {\r\n      this._offset.y = Math.sin(millis() * 0.005) * 5.0;\r\n    }\r\n\r\n    if (this._moveTowardsTarget)\r\n    {\r\n      const d: Vector2 = this._targetScreenPos.sub(this.screenPosition);\r\n      this._distToTarget = d.magnitude();\r\n      const v: number = Math.min(this._distToTarget, Actor.SPEED);\r\n      this.setScreenPosition(this.screenPosition.add(d.normalize().mult(v)));\r\n    }\r\n  }\r\n  \r\n  draw(): void\r\n  {\r\n    fill(0, 0, 100);\r\n    ellipse(this.screenPosition.x, this.screenPosition.y, 10, 10);\r\n  }\r\n\r\n  setNode(node: OWNode): void\r\n  {\r\n    this.currentNode = node;\r\n    this._targetScreenPos.assign(node.screenPosition);\r\n    this.setScreenPosition(node.screenPosition);\r\n  }\r\n\r\n  moveToScreenPosition(screenPos: Vector2): void\r\n  {\r\n    this._targetScreenPos.assign(screenPos);\r\n    this._moveTowardsTarget = true;\r\n  }\r\n  \r\n  moveToNode(node: OWNode): void\r\n  {\r\n    this.currentNode = node;\r\n    this._targetScreenPos.assign(node.screenPosition);\r\n    this._moveTowardsTarget = true;\r\n  }\r\n}\r\n\r\nexport class Player extends Actor\r\n{\r\n  setNode(node: OWNode): void\r\n  {\r\n    super.setNode(node);\r\n    node.visit();\r\n  }\r\n\r\n  moveToNode(node: OWNode): void\r\n  {\r\n    super.moveToNode(node);\r\n    node.visit();\r\n  }\r\n\r\n  update(): void\r\n  {\r\n    super.update();\r\n    //println(this._targetScreenPos);\r\n  }\r\n  \r\n  draw(): void\r\n  {\r\n    this.drawAt(this.screenPosition.x, this.screenPosition.y + this._offset.y, 1);\r\n  }\r\n\r\n  drawAt(xPos: number, yPos: number, s: number): void\r\n  {\r\n    stroke(30, 100, 100);\r\n    fill(0, 0, 0);\r\n\r\n    push();\r\n      translate(xPos, yPos);\r\n      scale(s);\r\n      ellipse(0, 0, 10, 20);\r\n    pop();\r\n  }\r\n}\r\n\r\nexport class Ship extends Actor\r\n{\r\n  _player: Actor;\r\n\r\n  constructor(player: Actor)\r\n  {\r\n    super();\r\n    this._player = player;\r\n  }\r\n\r\n  update(): void\r\n  {\r\n    super.update();\r\n  }\r\n\r\n  draw(): void\r\n  {\r\n    this.drawAt(this.screenPosition.x, this.screenPosition.y + this._offset.y, 1, false);\r\n  }\r\n\r\n  drawAt(xPos: number, yPos: number, s: number, skipFill: boolean): void\r\n  {\r\n    stroke(30, 100, 100);\r\n    fill(0, 0, 0);\r\n\r\n    if (this._player.currentNode == this.currentNode && !skipFill) \r\n    {\r\n      fill(30,100,100);\r\n    }\r\n    \r\n    push();\r\n      translate(xPos, yPos);\r\n      scale(s);\r\n      triangle(-20, 15, 20, 15, 0, -20);\r\n    pop();\r\n  }\r\n}\r\n\r\nexport class Probe extends Actor\r\n{\r\n  isDead(): boolean\r\n  {\r\n    return this._distToTarget < 0.1;\r\n  }\r\n\r\n  update(): void\r\n  {\r\n    super.update();\r\n  }\r\n\r\n  draw(): void\r\n  {\r\n    noStroke();\r\n    fill(30, 100, 100);\r\n    \r\n    push();\r\n      translate(this.screenPosition.x, this.screenPosition.y);\r\n      ellipse(0, 0, 10, 10);\r\n    pop();\r\n  }\r\n}", "import { Color } from \"p5\";\r\nimport { Entity } from \"./Entity\";\r\nimport { Vector2 } from \"./Vector2\";\r\nimport { smallFontData } from \"./app\";\r\n\r\nexport interface ButtonObserver\r\n{\r\n  onButtonUp(button: Button): void;\r\n  onButtonEnterHover(button: Button): void;\r\n  onButtonExitHover(button: Button): void;\r\n}\r\n\r\nexport class Button extends Entity\r\n{\r\n  id: string;\r\n  hoverState: boolean = false;\r\n  visible: boolean = true;\r\n  enabled: boolean = true;\r\n  \r\n  _bounds: Vector2;  \r\n  _observer: ButtonObserver;\r\n    \r\n  _buttonDown: boolean = false;\r\n  _wasMousePressed: boolean = false;\r\n\r\n  _buttonColor: Color = color(0, 0, 100);\r\n  _hasDisabledPrompt: boolean = false;\r\n  _disabledPrompt: string;\r\n  \r\n  constructor(buttonID: string, x: number = 0, y: number = 0, w: number = 150, h: number = 50)\r\n  {\r\n    super(new Vector2(x, y));\r\n    this.id = this._disabledPrompt = buttonID;\r\n    this._bounds = new Vector2(w, h);\r\n  }\r\n\r\n  setColor(newColor: Color): void {this._buttonColor = newColor;}\r\n  setDisabledPrompt(prompt: string): void \r\n  {\r\n    this._disabledPrompt = prompt;\r\n    this._hasDisabledPrompt = true;\r\n  }\r\n\r\n  getWidth(): number\r\n  {\r\n    return this._bounds.x;\r\n  }\r\n  \r\n  setObserver(observer: ButtonObserver): void\r\n  {\r\n    this._observer = observer;\r\n  }\r\n  \r\n  update(): void\r\n  {\r\n    if (!this.enabled) \r\n    {\r\n      this._buttonDown = false;\r\n      this.hoverState = false;\r\n      return;\r\n    }\r\n    \r\n    if (this.isPointInBounds(mouseX, mouseY))\r\n    {\r\n      if (!this.hoverState)\r\n      {\r\n        this.hoverState = true;\r\n        this.onButtonEnterHover();\r\n        this._observer.onButtonEnterHover(this);\r\n      }\r\n      \r\n      if (!this._wasMousePressed && this.mousePressed())\r\n      {\r\n        this._buttonDown = true;\r\n      }\r\n      // fire event on release\r\n      if (this._buttonDown && !this.mousePressed())\r\n      {\r\n        this._buttonDown = false;\r\n        this.onButtonUp();\r\n        this._observer.onButtonUp(this);\r\n      }\r\n    }\r\n    else\r\n    {\r\n      this._buttonDown = false;\r\n      \r\n      if (this.hoverState)\r\n      {\r\n        this.hoverState = false;\r\n        this.onButtonExitHover();\r\n        this._observer.onButtonExitHover(this);\r\n      }\r\n    }\r\n    \r\n    this._wasMousePressed = this.mousePressed();\r\n  }\r\n\r\n  onButtonExitHover(): void{}\r\n  onButtonEnterHover(): void{}\r\n  onButtonUp(): void{}\r\n\r\n  mousePressed(): boolean\r\n  {\r\n    return mouseIsPressed;// && mouseButton == LEFT;\r\n  }\r\n  \r\n  draw(): void\r\n  {\r\n    if (!this.visible) {return;}\r\n\r\n    let alpha: number = 100;\r\n\r\n    if (!this.enabled) alpha = 25;\r\n    \r\n    stroke(hue(this._buttonColor), saturation(this._buttonColor), brightness(this._buttonColor), alpha);\r\n    fill(0, 0, 0);\r\n    \r\n    if (this.hoverState)\r\n    {\r\n      if (this._buttonDown)\r\n      {\r\n        stroke(0, 100, 100);\r\n      }\r\n      else\r\n      {\r\n        stroke(200, 100, 100);\r\n      }\r\n    }\r\n\r\n    this.drawShape();\r\n    this.drawText(alpha);\r\n  }\r\n\r\n  drawShape(): void\r\n  {\r\n    rectMode(CENTER);\r\n    rect(this.screenPosition.x, this.screenPosition.y, this._bounds.x, this._bounds.y);\r\n  }\r\n\r\n  drawText(alpha: number): void\r\n  {\r\n    fill(0, 0, 100, alpha);\r\n    textSize(14);\r\n    textFont(smallFontData);\r\n    textAlign(CENTER, CENTER);\r\n\r\n    if (this.enabled) \r\n    {\r\n      text(this.id, this.screenPosition.x, this.screenPosition.y);\r\n    }\r\n    else\r\n    {\r\n      text(this._disabledPrompt, this.screenPosition.x, this.screenPosition.y);\r\n    }\r\n  }\r\n  \r\n  isPointInBounds(x: number, y: number): boolean\r\n  {\r\n    if (x > this.screenPosition.x - this._bounds.x * 0.5 && x < this.screenPosition.x + this._bounds.x * 0.5)\r\n    {\r\n      if (y > this.screenPosition.y - this._bounds.y * 0.5 && y < this.screenPosition.y + this._bounds.y * 0.5)\r\n      {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n}", "import { Color } from \"p5\";\r\nimport { ButtonObserver, Button } from \"./Button\";\r\nimport { Entity } from \"./Entity\";\r\nimport { Vector2 } from \"./Vector2\";\r\nimport { playerData } from \"./app\";\r\n\r\nexport abstract class OWScreen implements ButtonObserver\r\n{\r\n  active: boolean = false;\r\n  overlay: boolean = false;\r\n\r\n  _buttons: Button[];\r\n  _toolbarButtons: Button[];\r\n  _starPositions: Vector2[];\r\n\r\n  _toolbarRoot: Entity;\r\n  \r\n  constructor()\r\n  {\r\n    this._buttons = new Array<Button>();\r\n    this._toolbarButtons = new Array<Button>();\r\n    this._starPositions = new Array<Vector2>(1000);\r\n    \r\n    for (let i: number = 0; i < this._starPositions.length; i++)\r\n    {\r\n      this._starPositions[i] = new Vector2(random(0, width), random(90, height - 90));\r\n    }\r\n\r\n    this._toolbarRoot = new Entity(width/2, height - 50);\r\n  }\r\n  \r\n  addButton(button: Button): void\r\n  {\r\n    this._buttons.push(button);\r\n    button.setObserver(this);\r\n  }\r\n  \r\n  removeButton(button: Button): void\r\n  {\r\n    if (this._buttons.includes(button)) {\r\n      this._buttons.splice(this._buttons.indexOf(button), 1);\r\n    }\r\n  }\r\n\r\n  addButtonToToolbar(button: Button): void\r\n  {\r\n    this.addButton(button);\r\n    this._toolbarButtons.push(button);\r\n    this._toolbarRoot.addChild(button);\r\n    this.updateToolbarPositions();\r\n  }\r\n\r\n  removeButtonFromToolbar(button: Button): void\r\n  {\r\n    this.removeButton(button);\r\n    this._toolbarButtons.splice(this._toolbarButtons.indexOf(button), 1);\r\n    this._toolbarRoot.removeChild(button);\r\n    this.updateToolbarPositions();\r\n  }\r\n\r\n  updateToolbarPositions(): void\r\n  {\r\n    const margins: number = 10;\r\n    let toolbarWidth: number = -margins;\r\n\r\n    for (let i: number = 0; i < this._toolbarButtons.length; i++)\r\n    {\r\n      toolbarWidth += margins;\r\n      toolbarWidth += this._toolbarButtons[i].getWidth();\r\n    }\r\n\r\n    let xPos: number = -(toolbarWidth * 0.5);\r\n\r\n    for (let i: number = 0; i < this._toolbarButtons.length; i++)\r\n    {\r\n      const buttonHalfWidth: number = this._toolbarButtons[i].getWidth() * 0.5;\r\n      xPos += buttonHalfWidth;\r\n      this._toolbarButtons[i].setPosition(xPos, 0);\r\n      xPos += buttonHalfWidth + margins;\r\n    }\r\n  }\r\n  \r\n  abstract update(): void;\r\n  abstract render(): void;\r\n  \r\n  onEnter(): void{}\r\n  onExit(): void{}\r\n  \r\n  onButtonUp(button: Button): void{}\r\n  onButtonEnterHover(button: Button): void{}\r\n  onButtonExitHover(button: Button): void{}\r\n  \r\n  updateInput(): void\r\n  {\r\n    for (let i: number = 0; i < this._buttons.length; i++)\r\n    {\r\n      this._buttons[i].update();\r\n    }\r\n  }\r\n  \r\n  renderBackground(): void\r\n  {\r\n    let bgColor: Color = color(0, 0, 0);\r\n    let starColor: Color = color(0, 0, 100);\r\n\r\n    // superhack to invert colors when player is at EYE_OF_THE_UNIVERSE\r\n    if (playerData.isPlayerAtEOTU())\r\n    {\r\n      bgColor = color(0, 0, 100);\r\n      starColor = color(0, 0, 0);\r\n    }\r\n\r\n    background(bgColor);\r\n    noStroke();\r\n    \r\n    /** DRAW STARFIELD **/\r\n    for (let j: number = 0; j < this._starPositions.length; j++)\r\n    {\r\n      fill(starColor);\r\n      rectMode(CENTER);\r\n      rect(this._starPositions[j].x, this._starPositions[j].y, 2, 2);\r\n    }\r\n  }\r\n  \r\n  renderButtons(): void\r\n  {\r\n    // only render buttons if the screen is active\r\n    if (this.active)\r\n    {\r\n      for (let i: number = 0; i < this._buttons.length; i++)\r\n      {\r\n        this._buttons[i].render();\r\n      }\r\n    }\r\n  }\r\n}", "import { Color } from \"p5\";\r\nimport { Button } from \"./Button\";\r\nimport { Entity } from \"./Entity\";\r\nimport { Curiosity } from \"./Enums\";\r\nimport { Clue } from \"./PlayerData\";\r\nimport { OWScreen } from \"./Screen\";\r\nimport { playerData, feed, gameManager, mediumFontData } from \"./app\";\r\n\r\nexport interface DatabaseObserver\r\n{\r\n  onInvokeClue(clue: Clue): void;\r\n}\r\n\r\nexport class DatabaseScreen extends OWScreen implements ClueButtonObserver\r\n{\r\n  _clueRoot: Entity;\r\n  _activeClue: Clue;\r\n  _observer: DatabaseObserver;\r\n\r\n  constructor()\r\n  {\r\n    super();\r\n    this.addButtonToToolbar(new Button(\"\u5173\u95ED\u6570\u636E\u5E93\",  0, 0, 150, 50));\r\n    this._clueRoot = new Entity(100, 140);\r\n\r\n    // create clue buttons using PlayerData's list of clues\r\n    for (let i: number = 0; i < playerData.getClueCount(); i++)\r\n    {\r\n      const clueButton: ClueButton = new ClueButton(playerData.getClueAt(i), i * 40, this);\r\n      this.addButton(clueButton);\r\n      this._clueRoot.addChild(clueButton);\r\n    }\r\n  }\r\n\r\n  setObserver(observer: DatabaseObserver): void\r\n  {\r\n    this._observer = observer;\r\n  }\r\n\r\n  onEnter(): void\r\n  {\r\n  }\r\n\r\n  onExit(): void\r\n  {\r\n    this._observer = null;\r\n  }\r\n\r\n  onClueMouseOver(clue: Clue): void\r\n  {\r\n    this._activeClue = clue;\r\n  }\r\n\r\n  onClueSelected(clue: Clue): void\r\n  {\r\n    if (this._observer != null)\r\n    {\r\n      this._observer.onInvokeClue(clue);\r\n    }\r\n    else\r\n    {\r\n      feed.publish(\"\u90A3\u4E2A\u73B0\u5728\u8FD8\u4E0D\u80FD\u5E2E\u52A9\u5230\u4F60\", true);\r\n    }\r\n  }\r\n\r\n  onButtonUp(button: Button): void\r\n  {\r\n    if (button.id == \"\u5173\u95ED\u6570\u636E\u5E93\")\r\n    {\r\n      gameManager.popScreen();\r\n    }\r\n  }\r\n\r\n  update(): void {}\r\n\r\n  render(): void\r\n  {\r\n    fill(0, 0, 0);\r\n    stroke(0, 0, 100);\r\n\r\n    rectMode(CORNER);\r\n\r\n    const x: number = width/2 - 100;\r\n    const y: number = 200;\r\n    const w: number = 500;\r\n    const h: number = 300;\r\n\r\n    rect(x, y, w, h);\r\n\r\n    let _displayText: string = \"\u9009\u62E9\u4E00\u9879\u6761\u76EE\";\r\n\r\n    if (this._activeClue != null)\r\n    {\r\n      _displayText = this._activeClue.description;\r\n    }\r\n    else if (playerData.getKnownClueCount() == 0)\r\n    {\r\n      _displayText = \"\u6682\u65E0\u6761\u76EE\";\r\n    }\r\n\r\n    textFont(mediumFontData);\r\n    textSize(18);\r\n    textAlign(LEFT, TOP);\r\n    fill(0, 0, 100);\r\n\r\n    // \u81EA\u52A8\u6362\u884C\u5904\u7406\r\n    const wrappedLines = this.wrapText(_displayText, w - 20);\r\n\r\n    let currentY = y + 10; // \u521D\u59CB y \u5750\u6807\r\n    const lineHeight = 24; // \u884C\u9AD8\r\n\r\n    for (const line of wrappedLines) {\r\n        if (line === \"\") {\r\n            // \u5982\u679C\u662F\u7A7A\u884C\uFF0C\u589E\u52A0 y \u5750\u6807\uFF0C\u4FDD\u7559\u7A7A\u884C\r\n            currentY += lineHeight;\r\n        } else {\r\n            text(line, x + 10, currentY); // \u7ED8\u5236\u6BCF\u4E00\u884C\u6587\u672C\r\n            currentY += lineHeight; // \u589E\u52A0 y \u5750\u6807\uFF0C\u786E\u4FDD\u4E0B\u4E00\u884C\u4E0D\u4F1A\u91CD\u53E0\r\n        }\r\n    }\r\n\r\n    feed.render();\r\n  }\r\n\r\n  /**\r\n   * \u81EA\u52A8\u6362\u884C\u51FD\u6570\uFF1A\u6839\u636E\u6700\u5927\u5BBD\u5EA6\u5C06\u6587\u672C\u5206\u5272\u6210\u591A\u884C\uFF0C\u5E76\u4FDD\u7559\u7A7A\u884C\r\n   * @param text \u539F\u59CB\u6587\u672C\r\n   * @param maxWidth \u6700\u5927\u5BBD\u5EA6\r\n   * @returns \u5206\u5272\u540E\u7684\u591A\u884C\u6587\u672C\u6570\u7EC4\r\n   */\r\n  wrapText(text: string, maxWidth: number): string[] {\r\n    const lines: string[] = [];\r\n    const paragraphs = text.split('\\n'); // \u6309\u6362\u884C\u7B26\u5206\u5272\u6BB5\u843D\r\n\r\n    for (const paragraph of paragraphs) {\r\n        if (paragraph.trim() === \"\") {\r\n            // \u5982\u679C\u6BB5\u843D\u662F\u7A7A\u7684\uFF0C\u4FDD\u7559\u7A7A\u884C\r\n            lines.push(\"\");\r\n            continue;\r\n        }\r\n\r\n        let currentLine = \"\";\r\n\r\n        for (const char of paragraph) {\r\n            const testLine = currentLine + char;\r\n            if (textWidth(testLine) > maxWidth) {\r\n                lines.push(currentLine); // \u5F53\u524D\u884C\u5DF2\u6EE1\uFF0C\u4FDD\u5B58\r\n                currentLine = char; // \u5F00\u59CB\u65B0\u7684\u4E00\u884C\r\n            } else {\r\n                currentLine = testLine; // \u7EE7\u7EED\u6DFB\u52A0\u5B57\u7B26\r\n            }\r\n        }\r\n\r\n        if (currentLine) {\r\n            lines.push(currentLine); // \u4FDD\u5B58\u6700\u540E\u4E00\u884C\r\n        }\r\n    }\r\n\r\n    return lines;\r\n  }\r\n}\r\n\r\nexport interface ClueButtonObserver\r\n{\r\n  onClueSelected(clue: Clue): void;\r\n  onClueMouseOver(clue: Clue): void;\r\n}\r\n\r\nexport class ClueButton extends Button\r\n{\r\n  _clue: Clue;\r\n  _clueObserver: ClueButtonObserver;\r\n\r\n  constructor(clue: Clue, y: number, observer: ClueButtonObserver)\r\n  {\r\n    super(clue.name, (textWidth(clue.name) + 10) * 0.5, y, textWidth(clue.name) + 10, 20);\r\n    this._clue = clue;\r\n    this._clueObserver = observer;\r\n  }\r\n\r\n  getClue(): Clue\r\n  {\r\n    return this._clue;\r\n  }\r\n\r\n  update(): void\r\n  {\r\n    this.enabled = this._clue.discovered;\r\n    this.visible = this._clue.discovered;\r\n    super.update();\r\n  }\r\n\r\n  draw(): void\r\n  {\r\n    if (!this.visible) {return;}\r\n    \r\n    super.draw();\r\n\r\n    let symbolColor: Color;\r\n\r\n    if (this._clue.curiosity == Curiosity.VESSEL)\r\n    {\r\n        symbolColor = color(100, 100, 100);\r\n    }\r\n    else if (this._clue.curiosity == Curiosity.ANCIENT_PROBE_LAUNCHER)\r\n    {\r\n      symbolColor = color(200, 100, 100);\r\n    }\r\n    else if (this._clue.curiosity == Curiosity.TIME_LOOP_DEVICE)\r\n    {\r\n      symbolColor = color(20, 100, 100);\r\n    }\r\n    else\r\n    {\r\n      symbolColor = color(300, 100, 100);\r\n    }\r\n\r\n    fill(symbolColor);\r\n    noStroke();\r\n    ellipse(this.screenPosition.x - this._bounds.x * 0.5 - 20, this.screenPosition.y, 10, 10);\r\n\r\n    noFill();\r\n    stroke(symbolColor);\r\n    ellipse(this.screenPosition.x - this._bounds.x * 0.5 - 20, this.screenPosition.y, 15, 15);\r\n  }\r\n\r\n  onButtonEnterHover(): void\r\n  {\r\n    this._clueObserver.onClueMouseOver(this._clue);\r\n  }\r\n\r\n  onButtonUp(): void\r\n  {\r\n    this._clueObserver.onClueSelected(this._clue);\r\n  }\r\n}", "\r\nexport interface GlobalObserver\r\n{\r\n\tonReceiveGlobalMessage(message: Message): void;\r\n}\r\n\r\nexport class GlobalMessenger\r\n{\r\n\t_observers: GlobalObserver[];\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis._observers = new Array<GlobalObserver>();\r\n\t}\r\n\r\n\taddObserver(observer: GlobalObserver): void\r\n\t{\r\n\t\tif (!this._observers.includes(observer))\r\n\t\t{\r\n\t\t\tthis._observers.push(observer);\r\n\t\t}\r\n\t\t//println(\"Observer Count:\", this._observers.length);\r\n\t}\r\n\r\n\tremoveObserver(observer: GlobalObserver): void\r\n\t{\r\n\t\tthis._observers.splice(this._observers.indexOf(observer), 1);\r\n\t}\r\n\r\n\tremoveAllObservers(): void\r\n\t{\r\n\t\tthis._observers.length = 0;\r\n\t}\r\n\r\n\tsendMessage(messageID: string): void\r\n\tsendMessage(message: Message): void\r\n\tsendMessage(messageOrID: string | Message): void\r\n\t{\r\n\t\tconst message = messageOrID instanceof Message ? messageOrID : new Message(messageOrID);\r\n\t\tfor (let i: number = 0; i < this._observers.length; i++)\r\n\t\t{\r\n\t\t\tthis._observers[i].onReceiveGlobalMessage(message);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class Message\r\n{\r\n\tid: string;\r\n\ttext: string;\r\n\r\n\tconstructor(messageID: string, t?: string)\r\n\t{\r\n\t\tthis.id = messageID;\r\n\t\tif (t !== undefined) this.text = t;\r\n\t}\r\n}", "import { Frequency, Curiosity } from \"./Enums\";\r\nimport { GameSave } from \"./GameSave\";\r\nimport { GlobalObserver, Message } from \"./GlobalMessenger\";\r\nimport { START_WITH_LAUNCH_CODES, START_WITH_COORDINATES, START_WITH_SIGNALS, messenger, feed, locator, gameManager, START_WITH_CLUES, frequencyToString } from \"./app\";\r\n\r\nexport class PlayerData implements GlobalObserver\r\n{\r\n\t_knowsLaunchCodes: boolean;\r\n\t_knowsSignalCoordinates: boolean;\r\n\r\n\t_clueList: Clue[];\r\n\t_knownFrequencies: Frequency[];\r\n\r\n\t_knownClueCount: number = 0;\r\n\r\n\t// resets every loop\r\n\t_isDead: boolean = false;\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis._knowsLaunchCodes = START_WITH_LAUNCH_CODES;\r\n\t\tthis._knowsSignalCoordinates = START_WITH_COORDINATES;\r\n\r\n\t\tthis._clueList = new Array<Clue>();\r\n\t\tthis._knownFrequencies = new Array<Frequency>();\r\n\t\tthis._knownFrequencies.push(Frequency.TRAVELER);\r\n\r\n\t\tif (START_WITH_SIGNALS)\r\n\t\t{ \r\n\t\t\tthis._knownFrequencies.push(Frequency.BEACON);\r\n\t\t\tthis._knownFrequencies.push(Frequency.QUANTUM);\r\n\t\t}\r\n\r\n\t\tthis._clueList.push(new Clue(Curiosity.ANCIENT_PROBE_LAUNCHER, \"APL_1\", \"\u6C89\u5E95\u6A21\u5757\", \"\u6570\u636E\u6536\u96C6\u6A21\u5757\u4ECE\u632A\u9EA6\u63A2\u6D4B\u5668\u53D1\u5C04\u5668\u4E0A\u8131\u843D\uFF0C\u6389\u8FDB\u4E86\u6DF1\u5DE8\u661F\u7684\u4E2D\u5FC3\u3002\"));\r\n\t\tthis._clueList.push(new Clue(Curiosity.ANCIENT_PROBE_LAUNCHER, \"APL_2\", \"\u6C79\u6D8C\u7684\u9F99\u5377\u98CE\", \"\u6DF1\u5DE8\u661F\u4E0A\u7684\u5927\u591A\u6570\u9F99\u5377\u98CE\u90FD\u6709\u5F3A\u70C8\u7684\u4E0A\u5347\u6C14\u6D41\uFF0C\u4F46\u6709\u4E9B\u9006\u65F6\u9488\u65CB\u8F6C\u7684\u9F99\u5377\u98CE\u6709\u7740\u4E0B\u884C\u6C14\u6D41\"));\r\n\t\tthis._clueList.push(new Clue(Curiosity.ANCIENT_PROBE_LAUNCHER, \"APL_3\", \"\u6C34\u6BCD\", \"\u6DF1\u5DE8\u661F\u6C34\u6BCD\u7684\u7A7A\u8154\u6070\u597D\u80FD\u591F\u5BB9\u4E0B\u4E00\u4E2A\u4EBA\"));\r\n\r\n\t\tthis._clueList.push(new Clue(Curiosity.QUANTUM_MOON, \"QM_3\", \"\u7B2C\u4E94\u4E2A\u4F4D\u7F6E\", \"\u91CF\u5B50\u536B\u661F\u6709\u65F6\u4F1A\u62DC\u8BBF\u592A\u9633\u7CFB\u5916\u7684\u7B2C\u4E94\u4E2A\u4F4D\u7F6E\"));\r\n\t\tthis._clueList.push(new Clue(Curiosity.QUANTUM_MOON, \"QM_1\", \"\u91CF\u5B50\u6210\u50CF\", \"\u89C2\u5BDF\u91CF\u5B50\u7269\u4F53\u7684\u7167\u7247\u4E0E\u76F4\u63A5\u89C2\u5BDF\u7269\u4F53\u672C\u8EAB\u4E00\u6837\uFF0C\u80FD\u6709\u6548\u5730\u9632\u6B62\u7269\u4F53\u79FB\u52A8\"));\r\n\t\tthis._clueList.push(new Clue(Curiosity.QUANTUM_MOON, \"QM_2\", \"\u91CF\u5B50\u7EA0\u7F20\", \"\u666E\u901A\u7269\u4F53\u5728\u9760\u8FD1\u91CF\u5B50\u7269\u4F53\u65F6\u4F1A\u4E0E\u4E4B\u201C\u7EA0\u7F20\u201D\u5728\u4E00\u8D77\uFF0C\u5E76\u5F00\u59CB\u8868\u73B0\u51FA\u91CF\u5B50\u5C5E\u6027\\n\\n\u53EA\u8981\u65E0\u6CD5\u89C2\u5BDF\u81EA\u5DF1\u6216\u5468\u56F4\u73AF\u5883\uFF0C\u5373\u4F7F\u662F\u751F\u547D\u4F53\u4E5F\u4F1A\u88AB\u7EA0\u7F20\"));\r\n\r\n\t\tthis._clueList.push(new Clue(Curiosity.VESSEL, \"D_1\", \"\u5931\u843D\u7684\u98DE\u8239\", \"\u632A\u9EA6\u4EBA\u6765\u5230\u8FD9\u4E2A\u592A\u9633\u7CFB\u662F\u4E3A\u4E86\u5BFB\u627E\u5B83\u4EEC\u79F0\u4E4B\u4E3A\u201C\u5B87\u5B99\u4E4B\u773C\u201D\u7684\u795E\u79D8\u7684\u4FE1\u53F7\uFF0C\u5B83\u4EEC\u4E58\u5750\u7684\u98DE\u8239\u5728\u9ED1\u8346\u661F\u7684\u67D0\u5904\u9047\u96BE\"));\r\n\t\tthis._clueList.push(new Clue(Curiosity.VESSEL, \"D_2\", \"\u5B69\u7AE5\u7684\u6E38\u620F\", \"\u632A\u9EA6\u4EBA\u5B69\u7AE5\u4EEC\u73A9\u4E86\u4E00\u4E2A\u6E38\u620F\uFF0C\u91CD\u73B0\u4E86\u65CF\u4EBA\u9003\u79BB\u9ED1\u8346\u661F\u7684\u60C5\u666F\u3002\u6839\u636E\u6E38\u620F\u89C4\u5219\uFF0C\u4E09\u540D\u73A9\u5BB6\uFF08\u9003\u751F\u8231\uFF09\u5FC5\u987B\u5728\u4E0D\u88AB\u53D1\u73B0\u7684\u60C5\u51B5\u4E0B\u5077\u5077\u6E9C\u8FC7\u8499\u7740\u773C\u775B\u7684\u73A9\u5BB6\uFF08\u9B9F\u9C47\u9C7C\uFF09\"));\r\n\t\tthis._clueList.push(new Clue(Curiosity.VESSEL, \"D_3\", \"\u8FFD\u8E2A\u88C5\u7F6E\", \"\u632A\u9EA6\u98DE\u8239\u5760\u6BC1\u5728\u9ED1\u8346\u7684\u6839\u90E8\u3002\u632A\u9EA6\u4EBA\u8BD5\u56FE\u5C06\u8FFD\u8E2A\u88C5\u7F6E\u63D2\u5165\u9ED1\u8346\u7684\u4E00\u6839\u85E4\u8513\u4E2D\uFF0C\u4EE5\u91CD\u65B0\u5B9A\u4F4D\u6839\u90E8\uFF0C\u4F46\u5B83\u4EEC\u65E0\u6CD5\u7A7F\u900F\u85E4\u8513\u575A\u786C\u7684\u5916\u8868\"));\r\n\r\n\t\tthis._clueList.push(new Clue(Curiosity.TIME_LOOP_DEVICE, \"TLD_1\", \"\u65F6\u95F4\u5FAA\u73AF\u88C5\u7F6E\", \"\u632A\u9EA6\u7814\u7A76\u4EBA\u5458\u5728\u6DF1\u5DE8\u661F\u5236\u9020\u51FA\u4E00\u4E2A\u5C0F\u578B\u4F46\u529F\u80FD\u6B63\u5E38\u7684\u65F6\u95F4\u5FAA\u73AF\u88C5\u7F6E\u540E\uFF0C\u8BA1\u5212\u5728\u7070\u70EC\u53CC\u661F\u4E0A\u5EFA\u9020\u4E00\u4E2A\u5B8C\u6574\u89C4\u6A21\u7684\u88C5\u7F6E\uFF08\u524D\u63D0\u662F\u80FD\u4EA7\u751F\u8DB3\u591F\u7684\u80FD\u91CF\u4E3A\u5176\u63D0\u4F9B\u52A8\u529B\uFF09\"));\r\n\t\tthis._clueList.push(new Clue(Curiosity.TIME_LOOP_DEVICE, \"TLD_2\", \"\u8DC3\u8FC1\u5854\", \"\u632A\u9EA6\u4EBA\u5EFA\u9020\u4E86\u7279\u6B8A\u7684\u5854\u697C\uFF0C\u53EF\u4EE5\u5C06\u5854\u5185\u7684\u4EFB\u4F55\u4EBA\u4F20\u9001\u5230\u76F8\u5E94\u7684\u63A5\u6536\u5E73\u53F0\u3002\u53EA\u6709\u5F53\u4F60\u80FD\u900F\u8FC7\u5854\u9876\u770B\u5230\u76EE\u7684\u5730\u65F6\uFF0C\u624D\u4F1A\u4F20\u9001\"));\r\n\t\tthis._clueList.push(new Clue(Curiosity.TIME_LOOP_DEVICE, \"TLD_3\", \"\u5927\u5DE5\u7A0B\", \"\u632A\u9EA6\u4EBA\u6316\u6398\u4E86\u6C99\u6F0F\u53CC\u661F\uFF0C\u5EFA\u9020\u4E86\u4E00\u53F0\u80FD\u591F\u5229\u7528\u8D85\u65B0\u661F\u80FD\u91CF\u7684\u5DE8\u5927\u88C5\u7F6E\\n\\n\u63A7\u5236\u4E2D\u5FC3\u4F4D\u4E8E\u884C\u661F\u4E2D\u5FC3\u7684\u4E00\u4E2A\u4E2D\u7A7A\u7A7A\u8154\u5185\uFF0C\u4E0E\u5730\u8868\u5B8C\u5168\u9694\u7EDD\"));\r\n\t}\r\n\r\n\tinit(): void\r\n\t{\r\n\t\tmessenger.addObserver(this);\r\n\t\tthis._isDead = false;\r\n\t}\r\n\r\n\tonReceiveGlobalMessage(message: Message): void\r\n\t{\r\n\t\tif (message.id === \"learn launch codes\" && !this._knowsLaunchCodes)\r\n\t\t{\r\n\t\t\tthis._knowsLaunchCodes = true;\r\n\t\t\tfeed.publish(\"\u5DF2\u83B7\u53D6\u53D1\u5C04\u5BC6\u7801\", true);\r\n\t\t\tmessenger.sendMessage(\"spawn ship\");\r\n\t\t}\r\n\t\telse if (message.id === \"learn signal coordinates\" && !this._knowsSignalCoordinates)\r\n\t\t{\r\n\t\t\tthis._knowsSignalCoordinates = true;\r\n\t\t\tfeed.publish(\"\u5DF2\u83B7\u53D6\u4FE1\u53F7\u5750\u6807\", true);\r\n\t\t}\r\n\r\n\t\tGameSave.saveData(this);\r\n\t}\r\n\r\n\tkillPlayer(): void\r\n\t{\r\n\t\tthis._isDead = true;\r\n\r\n\t\tGameSave.saveData(this);\r\n\t}\r\n\r\n\tisPlayerDead(): boolean\r\n\t{\r\n\t\treturn this._isDead;\r\n\t}\r\n\r\n\tisPlayerAtEOTU(): boolean\r\n\t{\r\n\t\treturn ((locator.player.currentSector == gameManager._solarSystem.quantumMoon && locator.getQuantumMoonLocation() == 4) || locator.player.currentSector == gameManager._solarSystem.eyeOfTheUniverse);\r\n\t}\r\n\r\n\tknowsFrequency(frequency: Frequency): boolean\r\n\t{\r\n\t\treturn this._knownFrequencies.includes(frequency);\r\n\t}\r\n\r\n\tknowsSignalCoordinates(): boolean\r\n\t{\r\n\t\treturn this._knowsSignalCoordinates;\r\n\t}\r\n\r\n\tlearnFrequency(frequency: Frequency): void\r\n\t{\r\n\t\tif (!this.knowsFrequency(frequency))\r\n\t\t{\r\n\t\t\tthis._knownFrequencies.push(frequency);\r\n\t\t\tfeed.publish(\"\u9891\u7387\u5DF2\u8BC6\u522B: \" + frequencyToString(frequency), true);\r\n\t\t}\r\n\r\n\t\tGameSave.saveData(this);\r\n\t}\r\n\r\n\tgetFrequencyCount(): number\r\n\t{\r\n\t\treturn this._knownFrequencies.length;\r\n\t}\r\n\r\n\tknowsLaunchCodes(): boolean\r\n\t{\r\n\t\treturn this._knowsLaunchCodes;\r\n\t}\r\n\r\n\tgetClueAt(i: number): Clue\r\n\t{\r\n\t\treturn this._clueList[i];\r\n\t}\r\n\r\n\tgetClueCount(): number\r\n\t{\r\n\t\treturn this._clueList.length;\r\n\t}\r\n\r\n\tgetKnownClueCount(): number\r\n\t{\r\n\t\treturn this._knownClueCount;\r\n\t}\r\n\r\n\tdiscoverClue(id: string): void\r\n\t{\r\n\t\tfor (let i: number = 0; i < this._clueList.length; i++)\r\n\t\t{\r\n\t\t\tif (this._clueList[i].id === id && !this._clueList[i].discovered)\r\n\t\t\t{\r\n\t\t\t\tthis._clueList[i].discovered = true;\r\n\t\t\t\tthis._knownClueCount++;\r\n\t\t\t\tfeed.publish(\"\u4FE1\u606F\u5DF2\u6DFB\u52A0\u81F3\u6570\u636E\u5E93\", true);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tGameSave.saveData(this);\r\n\t}\r\n}\r\n\r\nexport class Clue\r\n{\r\n\tid: string;\r\n\tname: string;\r\n\tdescription: string;\r\n\tdiscovered: boolean;\r\n\tinvoked: boolean = false;\r\n\tcuriosity: Curiosity;\r\n\r\n\tconstructor(curiosity: Curiosity, id: string, name: string, description: string)\r\n\t{\r\n\t\tthis.curiosity = curiosity;\r\n\t\tthis.id = id;\r\n\t\tthis.name = name;\r\n\t\tthis.description = description;\r\n\t\tthis.discovered = false || START_WITH_CLUES;\r\n\t}\r\n}\r\n", "import { PlayerData } from \"./PlayerData\";\r\n\r\nexport class GameSave {\r\n  static PLAYER_DATA = \"playerData\";\r\n\r\n  static saveData(data: PlayerData) {\r\n    localStorage.setItem(this.PLAYER_DATA, JSON.stringify(data));\r\n  }\r\n\r\n  static loadData(): PlayerData {\r\n    const playerData = new PlayerData();\r\n    if (!this.hasData()) {\r\n      return playerData;\r\n    }\r\n\r\n    const playerDataSave = JSON.parse(localStorage.getItem(this.PLAYER_DATA));\r\n    Object.assign(playerData, playerDataSave);\r\n    return playerData;\r\n  }\r\n\r\n  static clearData() {\r\n    localStorage.removeItem(this.PLAYER_DATA);\r\n  }\r\n\r\n  static hasData(): boolean {\r\n    return Boolean(localStorage.getItem(this.PLAYER_DATA));\r\n  }\r\n}\r\n", "import { AudioManager, SoundLibrary } from \"./AudioManager\";\r\nimport { Button } from \"./Button\";\r\nimport { SectorName } from \"./Enums\";\r\nimport { GameSave } from \"./GameSave\";\r\nimport { OWScreen } from \"./Screen\";\r\nimport { SKIP_TITLE, gameManager } from \"./app\";\r\nimport { exit } from \"./compat\";\r\n\r\nexport class TitleScreen extends OWScreen\r\n{\r\n  constructor()\r\n  {\r\n    super();\r\n    \r\n    if (GameSave.hasData()) {\r\n      this.addTitleButton(\"\u7EE7\u7EED\", 110);\r\n      this.addTitleButton(\"\u91CD\u7F6E\u8FDB\u5EA6\", -110);\r\n    } else {\r\n      this.addTitleButton(\"\u65B0\u6E38\u620F\", 0);\r\n    }\r\n  }\r\n\r\n  addTitleButton(text: string, xOffset: number) {\r\n    this.addButton(new Button(text, width/2 + xOffset, height - 50, 200, 50));\r\n  }\r\n  \r\n  onEnter(): void\r\n  {\r\n    if (SKIP_TITLE)\r\n    {\r\n      gameManager.loadSector(SectorName.TIMBER_HEARTH);\r\n      return;\r\n    }\r\n    \r\n    AudioManager.play(SoundLibrary.kazooTheme);\r\n  }\r\n  \r\n  onExit(): void\r\n  {\r\n    AudioManager.pause();\r\n  }\r\n  \r\n  update(): void\r\n  {\r\n  }\r\n  \r\n  render(): void\r\n  {\r\n    fill(142, 90, 90);\r\n    textAlign(CENTER, CENTER);\r\n    textSize(100);\r\n    text(\"Outer Wilds\", width/2, height/2 - 50);\r\n    \r\n    fill(0, 0, 100);\r\n    textSize(22);\r\n    text(\"\u4E00\u573A\u60CA\u5FC3\u52A8\u9B44\u7684\u56FE\u5F62\u6587\u672C\u5192\u9669\", width/2, height/2 + 50);\r\n  }\r\n  \r\n  onButtonUp(button: Button): void\r\n  {\r\n    if (button.id == \"\u65B0\u6E38\u620F\" || button.id == \"\u7EE7\u7EED\")\r\n    {\r\n      gameManager.loadSector(SectorName.TIMBER_HEARTH);\r\n    }\r\n    else if (button.id == \"\u91CD\u7F6E\u8FDB\u5EA6\")\r\n    {\r\n      GameSave.clearData();\r\n      exit();\r\n    }\r\n  }\r\n}\r\n\r\nexport class EndScreen extends OWScreen\r\n{\r\n  constructor()\r\n  {\r\n    super();\r\n    this.addButton(new Button(\"\u9000\u51FA\", width/2, height - 50, 200, 50));\r\n  }\r\n  \r\n  onEnter(): void\r\n  {\r\n    AudioManager.play(SoundLibrary.kazooTheme);\r\n  }\r\n  \r\n  onExit(): void\r\n  {\r\n    AudioManager.pause();\r\n  }\r\n  \r\n  update(): void\r\n  {\r\n  }\r\n  \r\n  render(): void\r\n  {\r\n    fill(142, 90, 90);\r\n    textAlign(CENTER, CENTER);\r\n    textSize(100);\r\n    text(\"Outer Wilds\", width/2, height/2 - 50);\r\n    \r\n    fill(0, 0, 100);\r\n    textSize(22);\r\n    text(\"\u611F\u8C22\u6E38\u73A9\uFF01\", width/2, height/2 + 50);\r\n  }\r\n  \r\n  onButtonUp(button: Button): void\r\n  {\r\n    if (button.id == \"\u9000\u51FA\")\r\n    {\r\n      exit();\r\n    }\r\n  }\r\n}\r\n", "import { Button } from \"./Button\";\r\nimport { DatabaseObserver } from \"./DatabaseScreen\";\r\nimport { Message } from \"./GlobalMessenger\";\r\nimport { Clue } from \"./PlayerData\";\r\nimport { OWScreen } from \"./Screen\";\r\nimport { EndScreen } from \"./TitleScreen\";\r\nimport { feed, timeLoop, gameManager, playerData, messenger, locator, mediumFontData } from \"./app\";\r\n\r\nexport abstract class EventScreen extends OWScreen implements DatabaseObserver\r\n{\r\n\tstatic BOX_WIDTH: number = 700;\r\n\tstatic BOX_HEIGHT: number = 400;\r\n\r\n\t_nextButton: Button;\r\n\t_databaseButton: Button;\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tsuper()\r\n\t\tthis.overlay = true; // continue to render BG\r\n\t\tthis.initButtons();\r\n\t}\r\n\r\n\tinitButtons(): void\r\n\t{\r\n\t\tthis.addButtonToToolbar(this._nextButton = new Button(\"\u7EE7\u7EED\", 0, 0, 150, 50));\r\n\t}\r\n\r\n\taddDatabaseButton(): void\r\n\t{\r\n\t\tthis.addButtonToToolbar(this._databaseButton = new Button(\"\u67E5\u770B\u6570\u636E\u5E93\", 0, 0, 150, 50));\r\n\t}\r\n\r\n\taddContinueButton(): void\r\n\t{\r\n\t\tthis.addButtonToToolbar(this._nextButton = new Button(\"\u7EE7\u7EED\", 0, 0, 150, 50));\r\n\t}\r\n\r\n\tupdate(): void{}\r\n\r\n\trenderBackground(): void {}\r\n\r\n\trender(): void {\r\n\t\tpush();\r\n\t\ttranslate(width / 2 - EventScreen.BOX_WIDTH / 2, height / 2 - EventScreen.BOX_HEIGHT / 2);\r\n\r\n\t\tstroke(0, 0, 100);\r\n\t\tfill(0, 0, 0);\r\n\t\trectMode(CORNER);\r\n\t\trect(0, 0, EventScreen.BOX_WIDTH, EventScreen.BOX_HEIGHT);\r\n\r\n\t\tfill(0, 0, 100);\r\n\r\n\t\ttextFont(mediumFontData);\r\n\t\ttextSize(18);\r\n\t\ttextAlign(LEFT, TOP);\r\n\r\n\t\t// \u83B7\u53D6\u9700\u8981\u663E\u793A\u7684\u6587\u672C\r\n\t\tconst displayText = this.getDisplayText();\r\n\t\tconst wrappedLines = this.wrapText(displayText, EventScreen.BOX_WIDTH - 20); // \u81EA\u52A8\u6362\u884C\u5904\u7406\r\n\r\n\t\tlet y = 10; // \u521D\u59CB y \u5750\u6807\r\n\t\tconst lineHeight = 24; // \u56FA\u5B9A\u884C\u9AD8\uFF0C\u786E\u4FDD\u884C\u95F4\u8DDD\u8DB3\u591F\r\n\r\n\t\tfor (const line of wrappedLines) {\r\n\t\t\tif (line === \"\") {\r\n\t\t\t\t// \u5982\u679C\u662F\u7A7A\u884C\uFF0C\u76F4\u63A5\u589E\u52A0 y \u5750\u6807\uFF0C\u4FDD\u7559\u7A7A\u884C\r\n\t\t\t\ty += lineHeight;\r\n\t\t\t} else {\r\n\t\t\t\ttext(line, 10, y); // \u7ED8\u5236\u6BCF\u4E00\u884C\u6587\u672C\r\n\t\t\t\ty += lineHeight; // \u589E\u52A0 y \u5750\u6807\uFF0C\u786E\u4FDD\u4E0B\u4E00\u884C\u4E0D\u4F1A\u91CD\u53E0\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpop();\r\n\r\n\t\tfeed.render();\r\n\t\ttimeLoop.renderTimer();\r\n\t}\r\n\r\n\t/**\r\n\t * \u81EA\u52A8\u6362\u884C\u51FD\u6570\uFF1A\u6839\u636E\u6700\u5927\u5BBD\u5EA6\u5C06\u6587\u672C\u5206\u5272\u6210\u591A\u884C\uFF0C\u5E76\u4FDD\u7559\u7A7A\u884C\r\n\t * @param text \u539F\u59CB\u6587\u672C\r\n\t * @param maxWidth \u6700\u5927\u5BBD\u5EA6\r\n\t * @returns \u5206\u5272\u540E\u7684\u591A\u884C\u6587\u672C\u6570\u7EC4\r\n\t */\r\n\twrapText(text: string, maxWidth: number): string[] {\r\n\t\tconst lines: string[] = [];\r\n\t\tconst paragraphs = text.split('\\n'); // \u6309\u6362\u884C\u7B26\u5206\u5272\u6BB5\u843D\r\n\r\n\t\tfor (const paragraph of paragraphs) {\r\n\t\t\tif (paragraph.trim() === \"\") {\r\n\t\t\t\t// \u5982\u679C\u6BB5\u843D\u662F\u7A7A\u7684\uFF0C\u4FDD\u7559\u7A7A\u884C\r\n\t\t\t\tlines.push(\"\");\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tlet currentLine = \"\";\r\n\r\n\t\t\tfor (const char of paragraph) {\r\n\t\t\t\tconst testLine = currentLine + char;\r\n\t\t\t\tif (textWidth(testLine) > maxWidth) {\r\n\t\t\t\t\tlines.push(currentLine); // \u5F53\u524D\u884C\u5DF2\u6EE1\uFF0C\u4FDD\u5B58\r\n\t\t\t\t\tcurrentLine = char; // \u5F00\u59CB\u65B0\u7684\u4E00\u884C\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrentLine = testLine; // \u7EE7\u7EED\u6DFB\u52A0\u5B57\u7B26\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (currentLine) {\r\n\t\t\t\tlines.push(currentLine); // \u4FDD\u5B58\u6700\u540E\u4E00\u884C\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn lines;\r\n\t}\r\n\r\n\tonButtonUp(button: Button): void\r\n\t{\r\n\t    if (button == this._nextButton)\r\n\t    {\r\n\t    \tthis.onContinue();\r\n\t    }\r\n\t    else if (button == this._databaseButton)\r\n\t    {\r\n\t\t\tgameManager.pushScreen(gameManager.databaseScreen);\r\n\t\t\tgameManager.databaseScreen.setObserver(this);\r\n\t    }\r\n\t}\r\n\r\n\tonInvokeClue(clue: Clue): void {}\r\n\r\n\tabstract getDisplayText(): string;\r\n\r\n\tabstract onContinue(): void;\r\n\r\n\tonEnter(): void{}\r\n\r\n\tonExit(): void{}\r\n}\r\n\r\nexport class DeathByAnglerfishScreen extends EventScreen\r\n{\r\n\tonEnter(): void\r\n\t{\r\n\t\tfeed.clear();\r\n\t\tfeed.publish(\"\u4F60\u88AB\u9B9F\u9C47\u9C7C\u5403\u6389\u4E86\", true);\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\treturn \"\u4F60\u5728\u98DE\u5411\u95EA\u8000\u7684\u5149\u8292\u65F6\uFF0C\u7A81\u7136\u610F\u8BC6\u5230\u8FD9\u5B9E\u9645\u4E0A\u662F\u5DE8\u578B\u9B9F\u9C47\u9C7C\u7684\u8BF1\u9975\uFF01\\n\\n\u4F60\u8BD5\u56FE\u626D\u5934\u5C31\u8DD1\uFF0C\u4F46\u4E3A\u65F6\u5DF2\u665A \u2014\u2014 \u9B9F\u9C47\u9C7C\u4E00\u53E3\u5C31\u628A\u4F60\u541E\u6CA1\u4E86\\n\\n\u4E16\u754C\u53D8\u5F97\u4E00\u7247\u6F06\u9ED1...\";\r\n\t}\r\n\tonContinue(): void\r\n\t{\r\n\t\tplayerData.killPlayer();\r\n\t}\r\n}\r\n\r\nexport class DiveAttemptScreen extends EventScreen\r\n{\r\n\tonEnter(): void\r\n\t{\r\n\t\tfeed.clear();\r\n\t\tfeed.publish(\"\u4F60\u5C1D\u8BD5\u6F5C\u5165\u6C34\u4E0B\", true);\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\treturn \"\u4F60\u5C1D\u8BD5\u6F5C\u5165\u6C34\u4E0B\uFF0C\u4F46\u6D45\u5C42\u5F3A\u5927\u7684\u6C34\u6D41\u963B\u6B62\u4F60\u7EE7\u7EED\u6F5C\u5165\u51E0\u767E\u7C73\u4E0B\u7684\u6DF1\u6C34\u533A\";\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tgameManager.popScreen();\r\n\t}\r\n}\r\n\r\nexport class TeleportScreen extends EventScreen\r\n{\r\n\t_text: string;\r\n\t_destination: string;\r\n\r\n\tconstructor(teleportText: string, destination: string)\r\n\t{\r\n\t\tsuper()\r\n\t\tthis._text = teleportText;\r\n\t\tthis._destination = destination;\r\n\t}\r\n\r\n\tonExit(): void\r\n\t{\r\n\t\tfeed.clear();\r\n\t\tfeed.publish(\"\u4F60\u5DF2\u88AB\u4F20\u9001\u81F3\u65B0\u5730\u70B9\", true);\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\treturn this._text;\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tgameManager.popScreen();\r\n\t\tmessenger.sendMessage(new Message(\"teleport to\", this._destination));\r\n\t}\r\n}\r\n\r\nexport class MoveToScreen extends EventScreen\r\n{\r\n\t_text: string;\r\n\t_destination: string;\r\n\r\n\tconstructor(moveText: string, destination: string)\r\n\t{\r\n\t\tsuper()\r\n\t\tthis._text = moveText;\r\n\t\tthis._destination = destination;\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\treturn this._text;\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tgameManager.popScreen();\r\n\t\tmessenger.sendMessage(new Message(\"move to\", this._destination));\r\n\t}\r\n}\r\n\r\nexport class SectorArrivalScreen extends EventScreen\r\n{\r\n\t_arrivalText: string;\r\n\t_sectorName: string;\r\n\r\n\tconstructor(arrivalText: string, sectorName: string)\r\n\t{\r\n\t\tsuper()\r\n\t\tthis._arrivalText = arrivalText;\r\n\t\tthis._sectorName = sectorName;\r\n\t}\r\n\r\n\tonEnter(): void\r\n\t{\r\n\t\tfeed.clear();\r\n\t\tfeed.publish(\"\u4F60\u5DF2\u62B5\u8FBE\" + this._sectorName);\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\treturn this._arrivalText;\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tgameManager.popScreen();\r\n\t}\r\n}\r\n\r\nexport class QuantumArrivalScreen extends EventScreen\r\n{\r\n\t_screenIndex: number = 0;\r\n\t_photoTaken: boolean = false;\r\n\r\n\tinitButtons(): void\r\n\t{\r\n\t\tthis.addDatabaseButton();\r\n\t\tthis.addContinueButton();\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\tif (this._screenIndex == 0)\r\n\t\t{\r\n\t\t\tif (!this._photoTaken)\r\n\t\t\t{\r\n\t\t\t\treturn \"\u4F60\u63A5\u8FD1\u4E86\u91CF\u5B50\u536B\u661F, \u4E00\u56E2\u5947\u602A\u7684\u8FF7\u96FE\u5F00\u59CB\u906E\u6321\u4F60\u7684\u89C6\u7EBF...\";\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\treturn \"\u5728\u5B83\u88AB\u9010\u6E10\u903C\u8FD1\u7684\u8FF7\u96FE\u5B8C\u5168\u906E\u6321\u4E4B\u524D\uFF0C\u4F60\u4F7F\u7528\u5C0F\u4FA6\u5BDF\u5175\u62CD\u6444\u4E86\u536B\u661F\u7684\u7167\u7247\";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (this._screenIndex == 1)\r\n\t\t{\r\n\t\t\tif (!this._photoTaken)\r\n\t\t\t{\r\n\t\t\t\treturn \"\u8FF7\u96FE\u5B8C\u5168\u541E\u6CA1\u4E86\u4F60\u7684\u98DE\u8239\uFF0C\u7136\u540E\u7A81\u7136\u6D88\u6563\uFF0C\u5C31\u50CF\u5B83\u51FA\u73B0\u65F6\u90A3\u6837\\n\\n\u4F60\u73AF\u987E\u56DB\u5468\uFF0C\u91CF\u5B50\u536B\u661F\u5DF2\u7ECF\u795E\u79D8\u6D88\u5931\u4E86\";\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\treturn \"\u4F60\u4E00\u5934\u624E\u8FDB\u96FE\u4E2D\uFF0C\u786E\u4FDD\u81EA\u5DF1\u76EF\u7740\u521A\u521A\u62CD\u5230\u7684\u7167\u7247\\n\\n\u7A81\u7136\uFF0C\u5DE8\u5927\u7684\u5F62\u72B6\u4ECE\u96FE\u4E2D\u6D6E\u73B0...\u4F60\u62B5\u8FBE\u4E86\u91CF\u5B50\u536B\u661F\u7684\u8868\u9762\uFF01\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tonInvokeClue(clue: Clue): void\r\n\t{\r\n\t\tif (clue.id === \"QM_1\")\r\n\t\t{\r\n\t\t\tgameManager.popScreen();\r\n\t\t\tthis._photoTaken = true;\r\n\t\t\tthis._databaseButton.enabled = false;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tfeed.publish(\"\u90A3\u4E2A\u73B0\u5728\u8FD8\u4E0D\u80FD\u5E2E\u52A9\u5230\u4F60\", true);\r\n\t\t}\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tthis._screenIndex++;\r\n\r\n\t\tthis._databaseButton.enabled = false;\r\n\r\n\t\tif (this._screenIndex > 1)\r\n\t\t{\r\n\t\t\tif (!this._photoTaken)\r\n\t\t\t{\r\n\t\t\t\tgameManager.popScreen();\r\n\t\t\t\tmessenger.sendMessage(\"quantum moon vanished\");\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tgameManager.popScreen();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class QuantumEntanglementScreen extends EventScreen\r\n{\r\n\t_displayText: string;\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tsuper()\r\n\t\tif (locator.player.currentSector.getName() === \"Quantum Moon\")\r\n\t\t{\r\n\t\t\tthis._displayText = \"\u4F60\u5173\u95ED\u4E86\u624B\u7535\u7B52\uFF0C\u4E16\u754C\u53D8\u5F97\u4E00\u7247\u6F06\u9ED1\\n\\n\u5F53\u4F60\u91CD\u65B0\u6253\u5F00\u624B\u7535\u7B52\u65F6\uFF0C\u56DB\u5468\u7684\u73AF\u5883\u53D1\u751F\u4E86\u53D8\u5316...\";\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis._displayText = \"\u4F60\u722C\u4E0A\u4E86\u91CF\u5B50\u788E\u7247\u7684\u9876\u90E8\u5E76\u5173\u95ED\u4E86\u624B\u7535\u7B52\u3002\u73AF\u5883\u5B9E\u5728\u662F\u592A\u9ED1\u4E86\uFF0C\u4F38\u624B\u4E0D\u89C1\u4E94\u6307\\n\\n\u5F53\u4F60\u91CD\u65B0\u6253\u5F00\u624B\u7535\u7B52\u65F6\uFF0C\u4F60\u4ECD\u7136\u7AD9\u5728\u91CF\u5B50\u788E\u7247\u7684\u9876\u90E8\uFF0C\u4F46\u56DB\u5468\u7684\u73AF\u5883\u53D1\u751F\u4E86\u53D8\u5316...\";\r\n\t\t}\r\n\t}\r\n\r\n\tonEnter(): void\r\n\t{\r\n\t\tfeed.clear();\r\n\t\tfeed.publish(\"\u4F60\u4E0E\u91CF\u5B50\u7269\u4F53\u4E00\u5757\u53D1\u751F\u7EA0\u7F20\u73B0\u8C61\u4E86\");\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\treturn this._displayText;\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tgameManager.popScreen();\r\n\t}\r\n}\r\n\r\nexport class FollowTheVineScreen extends EventScreen\r\n{\r\n\t_screenIndex: number = 0;\r\n\t_silentRunning: boolean = false;\r\n\r\n\tinitButtons(): void\r\n\t{\r\n\t\tthis.addDatabaseButton();\r\n\t\tthis.addContinueButton();\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\tif (this._screenIndex == 0)\r\n\t\t{\r\n\t\t\treturn \"\u4F60\u5411\u5176\u4E2D\u4E00\u6735\u602A\u5F02\u7684\u84DD\u8272\u82B1\u6735\u53D1\u5C04\u5C0F\u4FA6\u5BDF\u5175\uFF0C\u5B83\u5F88\u5FEB\u5C31\u88AB\u541E\u566C\u4E86\u3002\u4F60\u8DDF\u968F\u5C0F\u4FA6\u5BDF\u5175\u7684\u8FFD\u8E2A\u4FE1\u53F7\uFF0C\u987A\u7740\u9519\u7EFC\u590D\u6742\u7684\u85E4\u8513\u8FDB\u5165\u9ED1\u8346\u661F\u7684\u4E2D\u5FC3\u6DF1\u5904\\n\\n\u4F60\u5982\u6B64\u4E13\u6CE8\u4E8E\u8DDF\u968F\u5C0F\u4FA6\u5BDF\u5175\u7684\u4FE1\u53F7\uFF0C\u4EE5\u81F3\u4E8E\u4F60\u6CA1\u6709\u6CE8\u610F\u5230\u53D1\u5149\u7684\u8BF1\u9975\uFF0C\u4F46\u5DF2\u4E3A\u65F6\u5DF2\u665A\u3002\u4F60\u76F4\u63A5\u98DE\u8FDB\u4E86\u9B9F\u9C47\u9C7C\u7684\u5DE2\u7A74\u91CC\uFF01\";\r\n\t\t}\r\n\t\telse if (this._screenIndex == 1)\r\n\t\t{\r\n\t\t\tif (!this._silentRunning)\r\n\t\t\t{\r\n\t\t\t\treturn \"\u4F60\u53CD\u8F6C\u4E86\u98DE\u8239\u7684\u63A8\u8FDB\u5668\uFF0C\u4F46\u4E3A\u65F6\u5DF2\u665A\u3002\u9B9F\u9C47\u9C7C\u98DE\u901F\u731B\u6251\u8FC7\u6765\uFF0C\u541E\u566C\u4E86\u6574\u4E2A\u98DE\u8239\";\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\treturn \"\u4F60\u7A81\u7136\u60F3\u8D77\u4E86\u90A3\u4E2A\u53E4\u8001\u513F\u7AE5\u6E38\u620F\u7684\u89C4\u5219\uFF0C\u4F60\u5173\u6389\u4E86\u5F15\u64CE\uFF0C\u6084\u6084\u5730\u6F02\u8FDB\u4E86\u5DE2\u7A74\\n\\n\u4F3C\u4E4E\u6CA1\u6709\u9B9F\u9C47\u9C7C\u6CE8\u610F\u5230\u4F60\uFF0C\u4F60\u5B89\u5168\u5730\u5230\u8FBE\u4E86\u53E6\u4E00\u8FB9\u3002\u4F60\u7EE7\u7EED\u8DDF\u968F\u5C0F\u4FA6\u5BDF\u5175\u7684\u4FE1\u53F7\u524D\u8FDB\uFF0C\u6CA1\u8FC7\u591A\u4E45\uFF0C\u4F60\u5230\u8FBE\u4E86\u4E00\u4E2A\u7EA0\u7F20\u4E8E\u9ED1\u8346\u6839\u90E8\u7684\u53E4\u8001\u9057\u8FF9\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tonButtonUp(button: Button): void\r\n\t{\r\n\t    if (button == this._nextButton)\r\n\t    {\r\n\t    \tthis.onContinue();\r\n\t    }\r\n\t    else if (button == this._databaseButton)\r\n\t    {\r\n\t\t\tgameManager.pushScreen(gameManager.databaseScreen);\r\n\t\t\tgameManager.databaseScreen.setObserver(this);\r\n\t    }\r\n\t}\r\n\r\n\tonInvokeClue(clue: Clue): void\r\n\t{\r\n\t\tif (clue.id === \"D_2\")\r\n\t\t{\r\n\t\t\tgameManager.popScreen();\r\n\t\t\tthis._silentRunning = true;\r\n\t\t\tthis._screenIndex++;\r\n\t\t\tthis._databaseButton.enabled = false;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tfeed.publish(\"\u90A3\u4E2A\u73B0\u5728\u8FD8\u4E0D\u80FD\u5E2E\u52A9\u5230\u4F60\", true);\r\n\t\t}\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tthis._screenIndex++;\r\n\t\tthis._databaseButton.enabled = false;\r\n\r\n\t\tif (this._screenIndex > 1)\r\n\t\t{\r\n\t\t\tif (!this._silentRunning)\r\n\t\t\t{\r\n\t\t\t\tgameManager.popScreen();\r\n\t\t\t\tplayerData.killPlayer();\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tgameManager.popScreen();\r\n\t\t\t\tmessenger.sendMessage(new Message(\"move to\", \"\u53E4\u98DE\u8239\"));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class AncientVesselScreen extends EventScreen\r\n{\r\n\t_warpButton: Button;\r\n\t_displayText: string;\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tsuper();\r\n\t\tthis._displayText = \"\u4F60\u63A2\u7D22\u4E86\u8FD9\u7247\u5E9F\u589F\uFF0C\u6700\u7EC8\u627E\u5230\u4E86\u8FD9\u91CC\u3002\u5C3D\u7BA1\u98DE\u8239\u7684\u751F\u547D\u7EF4\u6301\u7CFB\u7EDF\u5DF2\u7ECF\u5931\u6548\uFF0C\u4F46\u4E00\u4E9B\u8BA1\u7B97\u673A\u7EC8\u7AEF\u4ECD\u5728\u4F7F\u7528\u67D0\u79CD\u8F85\u52A9\u7535\u6E90\u8FD0\u884C\u3002\u4F60\u627E\u5230\u4E86\u632A\u9EA6\u4EBA\u4ECE\u5B87\u5B99\u4E4B\u773C\u63A5\u6536\u7684\u539F\u59CB\u4FE1\u53F7\u7684\u8BB0\u5F55\u3002\u6839\u636E\u5B83\u4EEC\u7684\u5206\u6790\uFF0C\u65E0\u8BBA\u4FE1\u53F7\u6765\u81EA\u4EC0\u4E48\u7269\u4F53\uFF0C\u90FD\u6BD4\u5B87\u5B99\u672C\u8EAB\u66F4\u4E3A\u53E4\u8001\uFF01\\n\\n\u4F60\u53C8\u56DB\u5904\u63A2\u67E5\u4E86\u4E00\u756A\uFF0C\u53D1\u73B0\u8FD9\u8258\u8239\u7684\u8DC3\u8FC1\u88C5\u7F6E\u5728\u51E0\u767E\u5E74\u524D\u5C31\u5B8C\u6210\u4E86\u5145\u80FD\";\r\n\t}\r\n\r\n\tinitButtons(): void\r\n\t{\r\n\t\tthis.addButtonToToolbar(this._warpButton = new Button(\"\u4F7F\u7528\u8DC3\u8FC1\u88C5\u7F6E\", 0, 0, 150, 50));\r\n\t\tsuper.initButtons();\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\treturn this._displayText;\r\n\t}\r\n\r\n\tonButtonUp(button: Button): void\r\n\t{\r\n\t    if (button == this._warpButton)\r\n\t    {\r\n\t    \tif (playerData.knowsSignalCoordinates())\r\n\t    \t{\r\n\t    \t\tif (!timeLoop.getEnabled())\r\n\t    \t\t{\r\n\t    \t\t\tgameManager.popScreen();\r\n\t    \t\t\tmessenger.sendMessage(new Message(\"teleport to\", \"Ancient Vessel 2\"));\r\n\t    \t\t\tfeed.clear();\r\n\t    \t\t\tfeed.publish(\"\u53E4\u98DE\u8239\u8DC3\u8FC1\u5230\u4E86\u5B87\u5B99\u4E4B\u773C\u6240\u5728\u7684\u5750\u6807\");\r\n\t    \t\t}\r\n\t    \t\telse\r\n\t    \t\t{\r\n\t    \t\t\tthis._displayText = \"\u4F60\u8F93\u5165\u4E86\u5B87\u5B99\u4E4B\u773C\u7684\u5750\u6807\u5E76\u5C1D\u8BD5\u4F7F\u7528\u8DC3\u8FC1\u88C5\u7F6E\uFF0C\u4F46\u7531\u4E8E\u5B58\u5728\u201C\u5DE8\u5927\u7684\u65F6\u95F4\u626D\u66F2\u201D\uFF0C\u5B83\u62D2\u7EDD\u542F\u52A8'.\";\r\n\t    \t\t}\r\n\t    \t}\r\n\t    \telse\r\n\t    \t{\r\n\t    \t\tthis._displayText = \"\u4F60\u8BD5\u56FE\u4F7F\u7528\u8DC3\u8FC1\u88C5\u7F6E\uFF0C\u4F46\u6CA1\u6709\u76EE\u7684\u5730\u5750\u6807\uFF0C\u88C5\u7F6E\u663E\u7136\u65E0\u6CD5\u542F\u52A8\";\r\n\t    \t}\r\n\t    }\r\n\t    else if (button == this._nextButton)\r\n\t    {\r\n\t\t\tthis.onContinue();\r\n\t    }\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tgameManager.popScreen();\r\n\t}\r\n}\r\n\r\nexport class TimeLoopCentralScreen extends EventScreen\r\n{\r\n\t_screenIndex: number = 0;\r\n\t_yes: Button;\r\n\t_no: Button;\r\n\r\n\tinitButtons(): void\r\n\t{\r\n\t\tthis.addContinueButton();\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\tif (this._screenIndex == 0)\r\n\t\t{\r\n\t\t\treturn \"\u4F60\u6B63\u4F4D\u4E8E\u7070\u70EC\u53CC\u661F\u4E2D\u5FC3\u7684\u4E00\u4E2A\u5DE8\u5927\u7403\u5F62\u8231\u5185\u3002\u4F60\u5728\u5916\u9762\u770B\u5230\u7684\u4E24\u6839\u5DE8\u578B\u5929\u7EBF\u5EF6\u4F38\u5230\u4E86\u5730\u8868\u4EE5\u4E0B\uFF0C\u5E76\u6C47\u805A\u5230\u4E86\u5BC6\u5BA4\u4E2D\u5FC3\u4E00\u4E2A\u7CBE\u5FC3\u5236\u4F5C\u7684\u7EBF\u5708\u72B6\u7684\u632A\u9EA6\u79D1\u6280\u88C5\u7F6E\u4E2D\u3002\u8FD9\u4E00\u5B9A\u5C31\u662F\u65F6\u95F4\u5FAA\u73AF\u7684\u6E90\u5934\uFF01\\n\\n\u4F60\u53D1\u73B0\u4E86\u4E00\u4E2A\u4FE1\u53F7\u53D1\u5C04\u5668\uFF0C\u5B83\u80FD\u81EA\u52A8\u901A\u77E5\u6DF1\u5DE8\u661F\u8F68\u9053\u4E0A\u7684\u632A\u9EA6\u7A7A\u95F4\u7AD9\u5728\u6BCF\u6B21\u5FAA\u73AF\u5F00\u59CB\u65F6\u53D1\u5C04\u4E00\u4E2A\u63A2\u6D4B\u5668\\n\\n\u65F6\u95F4\u5FAA\u73AF\u88C5\u7F6E\u9700\u8981\u8D85\u65B0\u661F\u7684\u80FD\u91CF\u6765\u6539\u53D8\u65F6\u95F4\u7684\u6D41\u901D\u3002\u51E0\u5343\u5E74\u524D\uFF0C\u632A\u9EA6\u4EBA\u66FE\u8BD5\u4EBA\u5DE5\u6FC0\u53D1\u8D85\u65B0\u661F\uFF0C\u4F46\u6CA1\u6709\u6210\u529F\";\r\n\t\t}\r\n\r\n\t\treturn \"\u4F60\u6700\u7EC8\u627E\u5230\u4E86\u901A\u5F80\u5BC6\u5BA4\u4E2D\u5FC3\u7684\u8DEF\uFF0C\u5E76\u627E\u5230\u4E86\u770B\u8D77\u6765\u50CF\u662F\u65F6\u95F4\u5FAA\u73AF\u673A\u5668\u7684\u754C\u9762\\n\\n\u4F60\u60F3\u5173\u95ED\u65F6\u95F4\u5FAA\u73AF\u5417\uFF1F\";\r\n\t}\r\n\r\n\tonButtonUp(button: Button): void\r\n\t{\r\n\t\tsuper.onButtonUp(button);\r\n\t\t\r\n\t\tif (button == this._yes)\r\n\t\t{\r\n\t\t\tmessenger.sendMessage(\"\u5173\u95ED\u65F6\u95F4\u5FAA\u73AF\");\r\n\t\t\tgameManager.popScreen();\r\n\t\t}\r\n\t\telse if (button == this._no)\r\n\t\t{\r\n\t\t\tgameManager.popScreen();\r\n\t\t}\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tthis._screenIndex++;\r\n\t\tthis.removeButtonFromToolbar(this._nextButton);\r\n\t\tthis.addButtonToToolbar(this._yes = new Button(\"\u662F\"));\r\n\t\tthis.addButtonToToolbar(this._no = new Button(\"\u5426\"));\r\n\t}\r\n}\r\n\r\nexport class EyeOfTheUniverseScreen extends EventScreen\r\n{\r\n\t_screenIndex: number = 0;\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\tif (this._screenIndex == 0)\r\n\t\t{\r\n\t\t\treturn \"\u5F53\u4F60\u9760\u8FD1\u56F4\u7ED5\u7740\u5B87\u5B99\u4E4B\u773C\u7684\u5947\u7279\u80FD\u91CF\u4E91\u65F6\uFF0C\u4F60\u770B\u5230\u6700\u540E\u51E0\u9897\u6052\u661F\u5728\u8FDC\u5904\u7206\u53D1\u3002\u5B87\u5B99\u53D8\u6210\u4E86\u4E00\u7247\u6F06\u9ED1\u7684\u865A\u65E0\\n\\n\u5F53\u4F60\u5230\u8FBE\u4E91\u5C42\u4E2D\u5FC3\u65F6\uFF0C\u4E91\u5C42\u9010\u6E10\u6D88\u6563\uFF0C\u9732\u51FA\u4E00\u4E2A\u6F02\u6D6E\u5728\u7A7A\u4E2D\u7684\u5947\u7279\u7403\u5F62\u7269\u4F53\u3002\u5728\u5B83\u95EA\u95EA\u53D1\u5149\u7684\u8868\u9762\u4E0A\uFF0C\u4F60\u770B\u5230\u4E86\u6570\u5341\u4EBF\u4E2A\u5149\u70B9\u3002\u5F53\u4F60\u9760\u8FD1\u65F6\uFF0C\u4F60\u53D1\u73B0\u8FD9\u4E9B\u5149\u70B9\u50CF\u662F\u6052\u661F\u548C\u661F\u7CFB\u56E2\u3002\u6BCF\u5F53\u4F60\u628A\u76EE\u5149\u4ECE\u7403\u4F53\u4E0A\u79FB\u5F00\uFF0C\u518D\u79FB\u56DE\u6765\u65F6\uFF0C\u6052\u661F\u548C\u661F\u7CFB\u7684\u7ED3\u6784\u5C31\u4F1A\u53D1\u751F\u53D8\u5316\\n\\n\u4F60\u542F\u52A8\u4E86\u55B7\u6C14\u80CC\u5305\uFF0C\u8FDB\u5165\u4E86\u7403\u4F53...\";\r\n\t\t}\r\n\r\n\t\treturn \"\u6709\u90A3\u4E48\u4E00\u77AC\u95F4\uFF0C\u4F60\u53D1\u73B0\u81EA\u5DF1\u6F02\u6D6E\u5728\u661F\u8FB0\u548C\u94F6\u6CB3\u7684\u6D77\u6D0B\u4E2D\u3002\u7A81\u7136\uFF0C\u6240\u6709\u7684\u6052\u661F\u90FD\u574D\u7F29\u6210\u4F60\u6B63\u524D\u65B9\u7684\u4E00\u4E2A\u5149\u70B9\u3002\u524D\u51E0\u79D2\u4EC0\u4E48\u90FD\u6CA1\u6709\u53D1\u751F\uFF0C\u7136\u540E\u5149\u70B9\u7A81\u7136\u5411\u5916\u7206\u53D1\u51FA\u60CA\u4EBA\u7684\u80FD\u91CF\u3002\u51B2\u51FB\u6CE2\u5C06\u4F60\u731B\u70C8\u649E\u5411\u4E86\u7A7A\u4E2D\\n\\n\u4F60\u7684\u751F\u547D\u7EF4\u6301\u7CFB\u7EDF\u6B63\u5728\u5D29\u6E83\uFF0C\u800C\u4F60\u53EA\u80FD\u773C\u7741\u7741\u5730\u770B\u7740\u80FD\u91CF\u4E0E\u7269\u8D28\u56DB\u5411\u55B7\u5411\u592A\u7A7A\\n\\n\u8FC7\u4E86\u4E00\u4F1A\uFF0C\u4F60\u7684\u89C6\u91CE\u6B63\u5728\u9010\u6E10\u53D8\u9ED1\";\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tthis._screenIndex++;\r\n\r\n\t\tif (this._screenIndex == 2)\r\n\t\t{\r\n\t\t\tgameManager._solarSystem.player.currentSector = null;\r\n\t\t\tgameManager.pushScreen(new EndScreen());\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class BrambleOutskirtsScreen extends EventScreen\r\n{\r\n\t_screenIndex: number = 0;\r\n\t_yes: Button;\r\n\t_no: Button;\r\n\r\n\tinitButtons(): void\r\n\t{\r\n\t\tthis.addDatabaseButton();\r\n\t\tthis.addButtonToToolbar(this._yes = new Button(\"\u662F\"));\r\n\t\tthis.addButtonToToolbar(this._no = new Button(\"\u5426\"));\r\n\t}\r\n\r\n\tgetDisplayText(): string\r\n\t{\r\n\t\tif (this._screenIndex == 0)\r\n\t\t{\r\n\t\t\treturn \"\u4F60\u6B63\u5728\u63A2\u7D22\u9ED1\u8346\u661F\u7684\u5916\u56F4\uFF0C\u85E4\u8513\u7684\u9876\u7AEF\u4F1A\u5F00\u51FA\u5DE8\u5927\u7684\u5F02\u5F62\u767D\u82B1\uFF08\u4EE5\u53CA\u51E0\u6735\u84DD\u82B1\uFF09\\n\\n\u4F60\u6CE8\u610F\u5230\u9760\u8FD1\u6BCF\u6735\u82B1\u4E2D\u5FC3\u7684\u5730\u65B9\u90FD\u6709\u4E00\u4E2A\u5C0F\u5F00\u53E3...\u4F60\u60F3\u9760\u8FD1\u4ED4\u7EC6\u770B\u770B\u5417\uFF1F\";\r\n\t\t}\r\n\r\n\t\treturn \"\u5F53\u4F60\u9760\u8FD1\u65F6\uFF0C\u82B1\u6735\u6253\u5F00\u4E86\uFF0C\u4E00\u80A1\u5947\u602A\u7684\u529B\u91CF\u5F00\u59CB\u628A\u4F60\u63A8\u8FDB\u53BB\u3002\u4F60\u62FC\u547D\u60F3\u9003\u79BB\uFF0C\u4F46\u6CA1\u6709\u7528\\n\\n\u4F60\u88AB\u4E00\u6735\u5DE8\u5927\u7684\u82B1\u6735\u6BEB\u4E0D\u7559\u60C5\u5730\u541E\u566C\u4E86\u3002\u4E16\u754C\u4E00\u7247\u6F06\u9ED1\uFF0C\u4F60\u80FD\u542C\u5230\u81EA\u5DF1\u88AB\u6D88\u5316\u7684\u58F0\u97F3...\";\r\n\t}\r\n\r\n\tonButtonUp(button: Button): void\r\n\t{\r\n\t\tsuper.onButtonUp(button);\r\n\t\t\r\n\t\tif (button == this._yes)\r\n\t\t{\r\n\t\t\tthis._screenIndex++;\r\n\t\t\tthis.removeButtonFromToolbar(this._yes);\r\n\t\t\tthis.removeButtonFromToolbar(this._no);\r\n\t\t\tthis.removeButtonFromToolbar(this._databaseButton);\r\n\t\t\tthis.addContinueButton();\r\n\t\t}\r\n\t\telse if (button == this._no)\r\n\t\t{\r\n\t\t\tgameManager.popScreen();\r\n\t\t}\r\n\t}\r\n\r\n\tonInvokeClue(clue: Clue): void\r\n\t{\r\n\t\tif (clue.id === \"D_3\")\r\n\t\t{\r\n\t\t\tgameManager.popScreen();\r\n\t\t\tmessenger.sendMessage(\"follow the vine\");\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tfeed.publish(\"\u90A3\u4E2A\u73B0\u5728\u8FD8\u4E0D\u80FD\u5E2E\u52A9\u5230\u4F60\", true);\r\n\t\t}\r\n\t}\r\n\r\n\tonContinue(): void\r\n\t{\r\n\t\tplayerData.killPlayer();\r\n\t}\r\n}", "import { OWScreen } from \"./Screen\";\r\nimport { println } from \"./compat\";\r\n\r\nexport abstract class ScreenManager\r\n{\r\n  _screenStack: OWScreen[];\r\n  _skipRender: boolean = false;\r\n\r\n  constructor()\r\n  {\r\n    this._screenStack = new Array<OWScreen>();\r\n  }\r\n\r\n  lateUpdate(): void\r\n  {\r\n    // just in case gamemanager needs to do anything\r\n  }\r\n\r\n  runGameLoop(): void\r\n  {\r\n    if (this._screenStack.length > 0)\r\n    {\r\n      this._skipRender = false;\r\n      \r\n      // update active screen\r\n      const activeScreen: OWScreen = this._screenStack[this._screenStack.length - 1];\r\n      activeScreen.updateInput();\r\n      activeScreen.update();\r\n      this.lateUpdate();\r\n\r\n      if (this._skipRender)\r\n      {\r\n        return;\r\n      }\r\n\r\n      // find which screens should get rendered\r\n      let lowestRenderIndex: number = 0;\r\n\r\n      for (let i: number = this._screenStack.length - 1; i >= 0; i--)\r\n      {\r\n        if (!this._screenStack[i].overlay)\r\n        {\r\n          lowestRenderIndex = i;\r\n          break;\r\n        }\r\n      }\r\n\r\n      // render screens lowest-first\r\n      for (let i: number = lowestRenderIndex; i < this._screenStack.length; i++)\r\n      {\r\n        this._screenStack[i].renderBackground();\r\n        this._screenStack[i].renderButtons();\r\n        this._screenStack[i].render();\r\n      }\r\n    }\r\n    else\r\n    {\r\n      println(\"No screens on the stack!!!\");\r\n    }\r\n  }\r\n  \r\n  swapScreen(newScreen: OWScreen): void\r\n  {\r\n    if (this._screenStack.length > 0)\r\n    {\r\n      this._screenStack[this._screenStack.length - 1].onExit();\r\n      this._screenStack[this._screenStack.length - 1].active = false;\r\n      this._screenStack.splice(this._screenStack.length - 1, 1);\r\n    }\r\n    \r\n    this._screenStack.push(newScreen);\r\n    this._screenStack[this._screenStack.length - 1].active = true;\r\n    this._screenStack[this._screenStack.length - 1].onEnter();\r\n\r\n    this._skipRender = true;\r\n\r\n    println(\"SWAP:\", newScreen);\r\n  }\r\n  \r\n  pushScreen(nextScreen: OWScreen): void\r\n  {\r\n    if (this._screenStack.length > 0)\r\n    {\r\n      this._screenStack[this._screenStack.length - 1].onExit();\r\n      this._screenStack[this._screenStack.length - 1].active = false;\r\n    }\r\n    \r\n    this._screenStack.push(nextScreen);\r\n    nextScreen.active = true;\r\n    nextScreen.onEnter();\r\n\r\n    this._skipRender = true;\r\n\r\n    println(\"PUSH:\", nextScreen);\r\n  }\r\n  \r\n  popScreen(): void\r\n  {\r\n    this._screenStack[this._screenStack.length - 1].onExit();\r\n    this._screenStack[this._screenStack.length - 1].active = false;\r\n    this._screenStack.splice(this._screenStack.length - 1, 1);\r\n    \r\n    if (this._screenStack.length > 0)\r\n    {\r\n      this._screenStack[this._screenStack.length - 1].active = true;\r\n      this._screenStack[this._screenStack.length - 1].onEnter();\r\n    }\r\n\r\n    this._skipRender = true;\r\n\r\n    println(\"POP\");\r\n  }\r\n}", "import { MoveToScreen, TeleportScreen } from \"./EventScreen\";\r\nimport { OWNode } from \"./Node\";\r\nimport { timeLoop, gameManager, messenger, playerData, feed } from \"./app\";\r\nimport { JSONArray, JSONObject } from \"./compat\";\r\n\r\nexport class ExploreData\r\n{\r\n\t_node: OWNode;\r\n\t_exploreString: string;\r\n\t_exploreArray: JSONArray;\r\n\r\n\t_nodeObj: JSONObject;\r\n\t_activeExploreObj: JSONObject;\r\n\r\n\t_dirty: boolean;\r\n\r\n\tconstructor(node: OWNode, nodeObj: JSONObject)\r\n\t{\r\n\t\tthis._node = node;\r\n\t\tthis._nodeObj = nodeObj;\r\n\t}\r\n\r\n\tparseJSON(): void\r\n\t{\r\n\t    // parse as string\r\n\t    this._exploreString = this._nodeObj.getString(\"explore\", \"Nothing to see here!\");\r\n\t    this._exploreArray = new JSONArray();\r\n\r\n\t    // parse as explore object\r\n\t    if (this._exploreString.charAt(0) == '{')\r\n\t    {\r\n\t    \tthis._activeExploreObj = this._nodeObj.getJSONObject(\"explore\");\r\n\t    }\r\n\t    // parse as array of explore objects\r\n\t    else if (this._exploreString.charAt(0) == '[')\r\n\t    {\r\n\t    \tthis._exploreArray = this._nodeObj.getJSONArray(\"explore\");\r\n\t    \tthis._activeExploreObj = this._exploreArray.getJSONObject(0);\r\n\t    }\r\n\r\n\t    this._dirty = true;\r\n\t}\r\n\r\n\tupdateActiveExploreData(): void\r\n\t{\r\n\t\t// check wait times\r\n\t\tfor (let i: number = 0; i < this._exploreArray.size(); i++)\r\n\t    {\r\n\t    \tconst exploreObj: JSONObject = this._exploreArray.getJSONObject(i);\r\n\r\n\t    \tconst turnCycle: number = exploreObj.getInt(\"turn cycle\", 1);\r\n\t\t\tconst turn: number = timeLoop.getActionPoints() % turnCycle;\r\n\r\n\t\t\tif (exploreObj.getInt(\"on turn\", -1) == turn && exploreObj != this._activeExploreObj)\r\n\t\t\t{\r\n\t\t\t\tthis._activeExploreObj = exploreObj;\r\n\t\t\t\tthis._dirty = true;\r\n\t\t\t}\r\n\t    }\r\n\t}\r\n\r\n\tcanClueBeInvoked(clueID: string): boolean\r\n\t{\r\n\t\tif (clueID === \"QM_2\" && this._node.allowQuantumEntanglement())\r\n\t\t{\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tfor (let i: number = 0; i < this._exploreArray.size(); i++)\r\n\t    {\r\n\t    \tconst exploreObj: JSONObject = this._exploreArray.getJSONObject(i);\r\n\r\n\t    \tif (exploreObj.getString(\"require clue\", \"\") === clueID && exploreObj != this._activeExploreObj)\r\n\t    \t{\r\n\t    \t\treturn true;\r\n\t    \t}\r\n\r\n\t    \t// NO LONGER IN USE\r\n\t    \tif (exploreObj.hasKey(\"clue event\") && exploreObj.getJSONObject(\"clue event\").getString(\"clue id\") === clueID)\r\n\t    \t{\r\n\t    \t\treturn true;\r\n\t    \t}\r\n\t    }\r\n\t    return false;\r\n\t}\r\n\r\n\tinvokeClue(clueID: string): void\r\n\t{\r\n\t\tif (clueID === \"QM_2\" && this._node.allowQuantumEntanglement())\r\n\t\t{\r\n\t\t\tgameManager.popScreen();\r\n\t\t\tmessenger.sendMessage(\"quantum entanglement\");\r\n\t\t}\r\n\r\n\t\tfor (let i: number = 0; i < this._exploreArray.size(); i++)\r\n\t    {\r\n\t    \tconst exploreObj: JSONObject = this._exploreArray.getJSONObject(i);\r\n\r\n\t    \t// unlock explore screens\r\n\t    \tif (exploreObj.getString(\"require clue\", \"\") === clueID && exploreObj != this._activeExploreObj)\r\n\t    \t{\r\n\t    \t\tthis._activeExploreObj = exploreObj;\r\n\t    \t\tthis._dirty = true;\r\n\t    \t}\r\n\r\n\t    \t// NO LONGER IN USE\r\n\t    \t// fire clue events\r\n\t    \tif (exploreObj.hasKey(\"clue event\"))\r\n\t    \t{\r\n\t    \t\tconst eventClueID: string = exploreObj.getJSONObject(\"clue event\").getString(\"clue id\");\r\n\r\n\t    \t\tif (eventClueID === clueID)\r\n\t    \t\t{\r\n\t    \t\t\tconst eventID: string = exploreObj.getJSONObject(\"clue event\").getString(\"event id\");\r\n\t\t    \t\tmessenger.sendMessage(eventID);\r\n\t    \t\t}\r\n\t    \t}\r\n\t    }\r\n\t}\r\n\r\n\texplore(): void\r\n\t{\r\n\t\tthis.updateActiveExploreData(); // sets dirty flag if explore data has changed\r\n\r\n\t\tif (this._dirty && this._activeExploreObj != null)\r\n\t\t{\r\n\t\t    this.fireEvents(this._activeExploreObj);\r\n\t\t    this.discoverClues(this._activeExploreObj);\r\n\t\t    this.revealHiddenPaths(this._activeExploreObj);\r\n\t\t    this._dirty = false;\r\n\t\t}\r\n\t}\r\n\r\n\tfireEvents(exploreObj: JSONObject): void\r\n\t{\r\n\t\tif (exploreObj.hasKey(\"fire event\"))\r\n\t\t{\r\n\t\t\tmessenger.sendMessage(exploreObj.getString(\"fire event\"));\r\n\t\t}\r\n\t\tif (exploreObj.hasKey(\"move to\"))\r\n\t\t{\r\n\t\t\tgameManager.swapScreen(new MoveToScreen(exploreObj.getString(\"text\"), exploreObj.getString(\"move to\")));\r\n\t\t}\r\n\t\tif (exploreObj.hasKey(\"teleport to\"))\r\n\t\t{\r\n\t\t\tgameManager.swapScreen(new TeleportScreen(exploreObj.getString(\"text\"), exploreObj.getString(\"teleport to\")));\r\n\t\t}\r\n\t}\r\n\r\n\tdiscoverClues(exploreObj: JSONObject): void\r\n\t{\r\n\t\tif (exploreObj.hasKey(\"discover clue\"))\r\n\t\t{\r\n\t\t\tplayerData.discoverClue(exploreObj.getString(\"discover clue\"));\r\n\t\t}\r\n\t}\r\n\r\n\trevealHiddenPaths(exploreObj: JSONObject): void\r\n\t{\r\n\t\t// reveal hidden paths\r\n\t    if (exploreObj.hasKey(\"reveal paths\"))\r\n\t    {\r\n\t    \tconst pathArray: JSONArray = exploreObj.getJSONArray(\"reveal paths\");\r\n\r\n\t    \tfor (let i: number = 0; i < pathArray.size(); i++)\r\n\t    \t{\r\n\t    \t\tthis._node.getConnection(pathArray.getString(i)).revealHidden();\r\n\t    \t}\r\n\r\n\t    \tfeed.publish(\"\u4F60\u53D1\u73B0\u4E86\u4E00\u6761\u9690\u85CF\u901A\u9053\uFF01\", true);\r\n\t    }\r\n\t}\r\n\r\n\tgetExploreText(): string\r\n\t{\r\n\t\tif (this._activeExploreObj != null)\r\n\t\t{\r\n\t\t\treturn this._activeExploreObj.getString(\"text\", \"no explore text\");\r\n\t\t}\r\n\r\n\t\treturn this._exploreString;\r\n\t}\r\n}", "import { Button } from \"./Button\";\r\nimport { Entity } from \"./Entity\";\r\nimport { Frequency } from \"./Enums\";\r\nimport { OWNode } from \"./Node\";\r\nimport { Sector } from \"./Sector\";\r\nimport { Vector2 } from \"./Vector2\";\r\nimport { frequencyToString, mediumFontData, playerData, smallFontData } from \"./app\";\r\n\r\nexport class FrequencyButton extends Button\r\n{\r\n\t_rightFacing: boolean = true;\r\n\r\n\tconstructor(rightFacing: boolean)\r\n\t{\r\n\t\tsuper(\"\u5207\u6362\u9891\u7387\", width/2 + 140, 40, 50, 50);\r\n\r\n\t\tthis._rightFacing = rightFacing;\r\n\r\n\t\tif (!rightFacing)\r\n\t\t{\r\n\t\t\tthis.setScreenPosition(new Vector2(width/2 - 140, 40));\r\n\t\t}\r\n\t\t//_disabledPrompt = \"Switch Frequency\\n(none known)\";\r\n\t}\r\n\r\n\tdrawShape(): void\r\n\t{\r\n\t\tpush();\r\n\t\ttranslate(this.screenPosition.x, this.screenPosition.y);\r\n\r\n\t\tif (this._rightFacing)\r\n\t\t{\r\n\t\t\ttriangle(25, 0, 0, 15, 0, -15);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\ttriangle(-25, 0, 0, 15, 0, -15);\r\n\t\t}\r\n\r\n\t\tpop();\r\n\t}\r\n\r\n\tdrawText(alpha: number): void {}\r\n}\r\n\r\nexport class Telescope\r\n{\r\n\t_frequency: Frequency = Frequency.TRAVELER;\r\n\t_signalStrength: number;\r\n\r\n\tupdate(signalSources: SignalSource[]): void\r\n\t{\r\n\t\tthis._signalStrength = 0;\r\n\r\n\t\tfor (let i: number = 0; i < signalSources.length; i++)\r\n\t\t{\r\n\t\t\tthis._signalStrength += signalSources[i].getSignalStrength(new Vector2(mouseX, mouseY), this._frequency);\r\n\t\t}\r\n\t}\r\n\r\n\trender(): void\r\n\t{\r\n\t\tlet frequencyText: string = frequencyToString(this._frequency);\r\n\r\n\t\tif (!playerData.knowsFrequency(this._frequency))\r\n\t\t{\r\n\t\t\tif (this._frequency == Frequency.BEACON)\r\n\t\t\t{\r\n\t\t\t\tfrequencyText = \"\u672A\u77E5\u9891\u7387 001\";\r\n\t\t\t}\r\n\t\t    else if (this._frequency == Frequency.QUANTUM)\r\n\t\t    {\r\n\t\t    \tfrequencyText = \"\u672A\u77E5\u9891\u7387 002\";\r\n\t\t    }\r\n\t\t}\r\n\r\n\t\tconst xPos: number = width/2;\r\n\r\n\t\tfill(0, 0, 100);\r\n\t\ttextSize(18);\r\n\t\ttextFont(mediumFontData);\r\n\t\ttext(frequencyText, xPos, 40);\r\n\t\ttextFont(smallFontData);\r\n\r\n\t\t// draw signal feedback\r\n\t\tstroke(0, 0, 100);\r\n\t\tfill(200, 100, 100);\r\n\t\trectMode(CENTER);\r\n\t\trect(xPos, 70, max(0, this._signalStrength * 300 - random(50)), 7);\r\n\r\n\t\t// draw crosshairs\r\n\t    noFill();\r\n\t    stroke(0, 0, 100);\r\n\t    line(mouseX, 0, mouseX, height);\r\n\t    line(0, mouseY, width, mouseY);\r\n\t}\r\n\r\n\tnextFrequency(): void\r\n\t{\r\n\t\tconst index: number = (this._frequency + 1) % this.getFrequencyValues().length;\r\n\t\tthis._frequency = this.getFrequencyValues()[index];\r\n\r\n\t\t// if (!playerData.knowsFrequency(_frequency))\r\n\t\t// {\r\n\t\t// \tnextFrequency();\r\n\t\t// }\r\n\t}\r\n\r\n\tpreviousFrequency(): void\r\n\t{\r\n\t\tlet index: number = this._frequency - 1;\r\n\r\n\t\tif (index < 0)\r\n\t\t{\r\n\t\t\tindex = this.getFrequencyValues().length - 1;\r\n\t\t}\r\n\r\n\t\tthis._frequency = this.getFrequencyValues()[index];\r\n\r\n\t\t// if (!playerData.knowsFrequency(_frequency))\r\n\t\t// {\r\n\t\t// \tpreviousFrequency();\r\n\t\t// }\r\n\t}\r\n\r\n\tgetFrequencyValues(): Frequency[] {\r\n\t\treturn Object.values(Frequency).filter(f => typeof f === 'number') as Frequency[]\r\n\t}\r\n}\r\n\r\nexport class SignalSource extends Entity\r\n{\r\n\t_signals: Signal[];\r\n\r\n\tconstructor(node: OWNode)\r\n\tconstructor(screenPosition: Vector2, sector: Sector)\r\n\tconstructor(nodeOrPos: OWNode | Vector2, sector?: Sector)\r\n\t{\r\n\t\tsuper()\r\n\t\tif (nodeOrPos instanceof OWNode) {\r\n\t\t\tthis.setScreenPosition(nodeOrPos.screenPosition);\r\n\t\t\tthis._signals = new Array<Signal>();\r\n\t\t\tthis._signals.push(nodeOrPos.getSignal());\r\n\t\t} else {\r\n\t\t\tthis.setScreenPosition(nodeOrPos);\r\n\t\t\tthis._signals = sector.getSectorSignals();\r\n\t\t}\r\n\t}\r\n\r\n\taddSignal(signal: Signal): void\r\n\t{\r\n\t\tthis._signals.push(signal);\r\n\t}\r\n\r\n\tgetSignalStrength(telescopePos: Vector2, frequency: Frequency): number\r\n\t{\r\n\t\tif (this.hasSignalWithFrequency(frequency))\r\n\t\t{\r\n\t\t\tconst d: Vector2 = telescopePos.sub(this.screenPosition);\r\n\t\t\tconst dist: number = d.magnitude();\r\n\r\n\t\t\tconst u: number = max(0, 1 - (dist / 150));\r\n\t\t\treturn u * u * u;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n\thasSignalWithFrequency(frequency: Frequency): boolean\r\n\t{\r\n\t\tfor (let i: number = 0; i < this._signals.length; i++)\r\n\t\t{\r\n\t\t\tif (this._signals[i].frequency == frequency)\r\n\t\t\t{\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nexport class Signal\r\n{\r\n\tfrequency: Frequency = Frequency.BEACON;\r\n\r\n\tconstructor(signalType: string)\r\n\t{\r\n\t\tif (signalType === \"QUANTUM\")\r\n\t\t{\r\n\t\t\tthis.frequency = Frequency.QUANTUM;\r\n\t\t}\r\n\t\telse if (signalType === \"BEACON\")\r\n\t\t{\r\n\t\t\tthis.frequency = Frequency.BEACON;\r\n\t\t}\r\n\t\telse if (signalType === \"TRAVELER\")\r\n\t\t{\r\n\t\t\tthis.frequency = Frequency.TRAVELER;\r\n\t\t}\r\n\t}\r\n}", "import { ButtonObserver, Button } from \"./Button\";\r\nimport { Entity } from \"./Entity\";\r\nimport { ExploreData } from \"./ExploreData\";\r\nimport { GlobalObserver, Message } from \"./GlobalMessenger\";\r\nimport { NodeConnection } from \"./NodeConnection\";\r\nimport { Signal } from \"./Telescope\";\r\nimport { Vector2 } from \"./Vector2\";\r\nimport { messenger, EDIT_MODE, playerData, TEXT_SIZE } from \"./app\";\r\nimport { JSONObject, println } from \"./compat\";\r\n\r\nexport interface NodeButtonObserver\r\n{\r\n  onNodeSelected(node: OWNode): void;\r\n  onNodeGainFocus(node: OWNode): void;\r\n  onNodeLoseFocus(node: OWNode): void;\r\n}\r\n\r\nexport interface NodeObserver\r\n{\r\n  onNodeVisited(node: OWNode): void;\r\n}\r\n\r\nexport class OWNode extends Entity implements ButtonObserver, GlobalObserver\r\n{\r\n  /** NODE DATA **/\r\n  _id: string = \"\";\r\n  _name: string = \"\";\r\n  \r\n  entryPoint: boolean = false;\r\n  shipAccess: boolean = false;\r\n  allowTelescope: boolean = true;\r\n  gravity: boolean = true;\r\n\r\n  _signal: Signal | null = null;\r\n  \r\n  /** EXPLORE STATE **/\r\n  _visible: boolean = false;\r\n  _visited: boolean = false;\r\n  _explored: boolean = false;\r\n\r\n  _inRange: boolean = false;\r\n\r\n  _button: Button | null = null;\r\n  _connections: Map<OWNode, NodeConnection>;\r\n\r\n  _observers: NodeButtonObserver[];\r\n  _observer: NodeObserver | null = null;\r\n  \r\n  _nodeJSONObj: JSONObject | null = null;\r\n  _exploreData: ExploreData | null = null;\r\n\r\n  constructor(x: number, y: number)\r\n  constructor(id: string, nodeJSONObj: JSONObject)\r\n  constructor(xOrID: number | string, yOrObj: number | JSONObject)\r\n  {\r\n    super(typeof xOrID === 'number' ? xOrID : 0, typeof yOrObj === 'number' ? yOrObj : 0)\r\n    this._connections = new Map<OWNode, NodeConnection>();\r\n    this._observers = new Array<NodeButtonObserver>();\r\n    messenger.addObserver(this);\r\n    if (typeof xOrID === 'string' && typeof yOrObj !== 'number') {\r\n      this._id = xOrID;\r\n      this._name = xOrID;\r\n  \r\n      this.loadJSON(yOrObj);\r\n  \r\n      if (this.entryPoint) \r\n      {\r\n        this._visible = true;\r\n      }\r\n      \r\n      this._button = new Button(this._id, 0, 0, this.getSize() * 1.5, this.getSize() * 1.5);\r\n      this._button.setObserver(this);\r\n      this._button.visible = false;\r\n      this.addChild(this._button);\r\n    }\r\n  }\r\n\r\n  loadJSON(nodeJSONObj: JSONObject): void\r\n  {\r\n    this._nodeJSONObj = nodeJSONObj;\r\n\r\n    this._name = this._nodeJSONObj.getString(\"name\", this._id);\r\n\r\n    if (nodeJSONObj.hasKey(\"explore\"))\r\n    {\r\n      this._exploreData = new ExploreData(this, nodeJSONObj);\r\n    }\r\n    \r\n    this.position.x = this._nodeJSONObj.getJSONObject(\"position\").getFloat(\"x\");\r\n    this.position.y = this._nodeJSONObj.getJSONObject(\"position\").getFloat(\"y\");\r\n\r\n    this._visible = this._nodeJSONObj.getBoolean(\"start visible\", this._visible);\r\n\r\n    if (EDIT_MODE)\r\n    {\r\n      this._visible = true;\r\n    }\r\n    \r\n    this.entryPoint = this._nodeJSONObj.getBoolean(\"entry point\", this.entryPoint);\r\n    this.shipAccess = this.entryPoint || this._nodeJSONObj.getBoolean(\"ship access\", this.shipAccess);\r\n    this.allowTelescope = this._nodeJSONObj.getBoolean(\"allow telescope\", this.allowTelescope);\r\n    this.gravity = this._nodeJSONObj.getBoolean(\"gravity\", this.gravity);\r\n    \r\n    if (this._nodeJSONObj.hasKey(\"signal\"))\r\n    {\r\n      this._signal = new Signal(this._nodeJSONObj.getString(\"signal\"));\r\n    }\r\n  }\r\n\r\n  savePosition(): void\r\n  {\r\n    this._nodeJSONObj.getJSONObject(\"position\").setFloat(\"x\", this.position.x);\r\n    this._nodeJSONObj.getJSONObject(\"position\").setFloat(\"y\", this.position.y);\r\n    println(this._id + \" position saved:\", this.position);\r\n  }\r\n\r\n  onReceiveGlobalMessage(message: Message): void\r\n  {\r\n\r\n  }\r\n\r\n  isExplorable(): boolean {return (this._nodeJSONObj != null && this._nodeJSONObj.hasKey(\"explore\"));}\r\n\r\n  getExploreData(): ExploreData {return this._exploreData;}\r\n\r\n  getProbeDescription(): string \r\n  {\r\n    if (this._nodeJSONObj.hasKey(\"probe description\"))\r\n    {\r\n      return this._nodeJSONObj.getString(\"probe description\");\r\n    }\r\n    return this.getDescription();\r\n  }\r\n\r\n  getDescription(): string {return this._nodeJSONObj.getString(\"description\", \"a vast expanse of nothing\");}\r\n\r\n  hasDescription(): boolean {return (this._nodeJSONObj != null && this._nodeJSONObj.hasKey(\"description\"));}\r\n\r\n  isProbeable(): boolean {return (this._nodeJSONObj != null && this._nodeJSONObj.hasKey(\"description\"));}\r\n\r\n  isConnectedTo(node: OWNode): boolean {return this._connections.has(node);}\r\n\r\n  inRange(): boolean\r\n  {\r\n    return this._inRange;\r\n  }\r\n\r\n  updateInRange(isPlayerInShip: boolean, playerNode: OWNode): void \r\n  {\r\n    this._inRange = false;\r\n\r\n    if (playerNode == this)\r\n    {\r\n      this._inRange = true;\r\n    }\r\n\r\n    if (this.entryPoint && isPlayerInShip)\r\n    {\r\n      this._inRange = true;\r\n    }\r\n    \r\n    if (playerNode != null && this.isConnectedTo(playerNode))\r\n    {\r\n      this._inRange = true;\r\n    }\r\n  }\r\n  \r\n  getConnection(node: OWNode): NodeConnection\r\n  getConnection(nodeID: string): NodeConnection\r\n  getConnection(nodeOrID: OWNode | string): NodeConnection\r\n  {\r\n    if (nodeOrID instanceof OWNode) {\r\n      return this._connections.get(nodeOrID);\r\n    }\r\n    for (const node of this._connections.keys()) \r\n    {\r\n      if (node.getID() === nodeOrID)\r\n      {\r\n        return this.getConnection(node);\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  allowQuantumEntanglement(): boolean // note - \"quantum state\" only used for Quantum Moon right now\r\n  {\r\n    if (this._nodeJSONObj == null) return false;\r\n    return this._nodeJSONObj.getBoolean(\"entanglement node\", false);\r\n  }\r\n\r\n  getSignal(): Signal {return this._signal;}\r\n\r\n  getID(): string {return this._id;}\r\n\r\n  getActualName(): string {return this._name;}\r\n  \r\n  getKnownName(): string\r\n  {\r\n    if (this._visited) return this.getActualName();\r\n    else return \"???\";\r\n  } \r\n\r\n  setVisible(visible: boolean): void {this._visible = visible;}\r\n  \r\n  visit(): void\r\n  {\r\n    this._visited = true;\r\n    this.setVisible(true);\r\n\r\n    if (this._nodeJSONObj != null && this._nodeJSONObj.hasKey(\"fire event\"))\r\n    {\r\n      messenger.sendMessage(this._nodeJSONObj.getString(\"fire event\"));\r\n    }\r\n\r\n    for (const connection of this._connections.values()) \r\n    {\r\n      connection.reveal();\r\n    }\r\n\r\n    if (this._observer != null)\r\n    {\r\n      this._observer.onNodeVisited(this);\r\n    }\r\n  }\r\n\r\n  explore(): void\r\n  {\r\n    this._explored = true;\r\n    this._exploreData.explore();\r\n\r\n    if (this._signal != null)\r\n    {\r\n      playerData.learnFrequency(this._signal.frequency);\r\n    }\r\n  }\r\n  \r\n  update(): void\r\n  {\r\n    if (!this._visible) {return;}\r\n    this._button.enabled = this.inRange() || EDIT_MODE;\r\n    this._button.update();\r\n  }\r\n\r\n  getAlpha(): number\r\n  {\r\n    if (!this.inRange())\r\n    {\r\n      return 35;\r\n    }\r\n    return 100;\r\n  }\r\n\r\n  getSize(): number\r\n  {\r\n    if (this.entryPoint) \r\n    {\r\n      return 50;\r\n    }\r\n    else if (!this.isExplorable())\r\n    {\r\n      return 25;\r\n    }\r\n\r\n    return 35;\r\n  }\r\n  \r\n  draw(): void\r\n  {\r\n    if (!this._visible) {return;}\r\n\r\n    if (this._button.hoverState)\r\n    {\r\n      stroke(200, 100, 100, this.getAlpha());\r\n    }\r\n    else\r\n    {\r\n      stroke(0, 0, 100, this.getAlpha());\r\n    }\r\n\r\n    push();\r\n    translate(this.screenPosition.x, this.screenPosition.y);\r\n\r\n      if (!this.isExplorable())\r\n      {\r\n        fill(0, 0, 0);\r\n        ellipse(0, 0, this.getSize(), this.getSize());\r\n        pop();\r\n        return;\r\n      }\r\n          \r\n      if (this.entryPoint)\r\n      {\r\n        fill(0, 0, 0);\r\n        ellipse(0, 0, this.getSize(), this.getSize());\r\n\r\n        // halfWidth: number = getSize() * 0.5;\r\n        // halfHeight: number = getSize() * 0.5;\r\n        // offset: number = 7;\r\n\r\n        // push();\r\n        // rotate(PI * 0.25);\r\n        //   line(-halfWidth, 0, -halfWidth + offset, 0);\r\n        //   line(halfWidth - offset, 0, halfWidth, 0);\r\n        //   line(0, -halfHeight, 0, -halfHeight + offset);\r\n        //   line(0, halfHeight - offset, 0, halfHeight);\r\n        // pop();\r\n      }\r\n      else\r\n      {\r\n        fill(0, 0, 0);\r\n        rect(0, 0, this.getSize(), this.getSize());\r\n      }\r\n\r\n      if (!this._explored)\r\n      {\r\n        fill(0, 0, 100, this.getAlpha());\r\n        textAlign(CENTER, CENTER);\r\n        textSize(30);\r\n        text('?', 0, 0);\r\n      }\r\n\r\n    pop();\r\n  }\r\n\r\n  drawName(): void\r\n  {\r\n    if (!this._visible) {return;}\r\n    if (!this.isExplorable()) {return;}\r\n\r\n    // draw text backdrop\r\n    const textPos: Vector2 = new Vector2(this.screenPosition.x, this.screenPosition.y - this.getSize() / 2 - 20);\r\n    \r\n    noStroke();\r\n    fill(0, 0, 0);\r\n    textSize(TEXT_SIZE);\r\n    rect(textPos.x, textPos.y, textWidth(this.getKnownName()), TEXT_SIZE + 4);\r\n    \r\n    fill(0, 0, 100, this.getAlpha());\r\n    \r\n    textAlign(CENTER, CENTER);\r\n    text(this.getKnownName(), textPos.x, textPos.y);\r\n  }\r\n\r\n  addConnection(connection: NodeConnection): void\r\n  {\r\n    if ([...this._connections.values()].includes(connection))\r\n    {\r\n      println(\"These nodes are already connected!!!\");\r\n      return;\r\n    }\r\n        \r\n    if (connection.node1 != this)\r\n    {\r\n      this._connections.set(connection.node1, connection);\r\n    }\r\n    else\r\n    {\r\n      this._connections.set(connection.node2, connection);\r\n    }\r\n  }\r\n\r\n  setNodeObserver(observer: NodeObserver): void\r\n  {\r\n    this._observer = observer;\r\n  }\r\n\r\n  addObserver(observer: NodeButtonObserver): void\r\n  {\r\n    this._observers.push(observer);\r\n  }\r\n  \r\n  removeAllObservers(): void\r\n  {\r\n    this._observers.length = 0;\r\n  }\r\n  \r\n  onButtonUp(button: Button): void\r\n  {\r\n    for (let i: number = 0; i < this._observers.length; i++)\r\n    {\r\n      this._observers[i].onNodeSelected(this);\r\n    }\r\n  }\r\n  \r\n  onButtonEnterHover(button: Button): void\r\n  {\r\n    for (let i: number = 0; i < this._observers.length; i++)\r\n    {\r\n      this._observers[i].onNodeGainFocus(this);\r\n    }\r\n  }\r\n  \r\n  onButtonExitHover(button: Button): void\r\n  {\r\n    for (let i: number = 0; i < this._observers.length; i++)\r\n    {\r\n      this._observers[i].onNodeLoseFocus(this);\r\n    }\r\n  }\r\n}", "import { OWNode } from \"./Node\";\r\nimport { Vector2 } from \"./Vector2\";\r\nimport { EDIT_MODE, messenger } from \"./app\";\r\nimport { JSONObject } from \"./compat\";\r\n\r\nexport class NodeConnection\r\n{\r\n  node1: OWNode;\r\n  node2: OWNode;\r\n\r\n  _description: string;\r\n  _hasDescription: boolean = false;\r\n\r\n  _adjacentToPlayer: boolean = false;\r\n  \r\n  _traversed: boolean = false;\r\n  _visible: boolean = false;\r\n  _gated: boolean = false;\r\n  _oneWay: boolean = false;\r\n\r\n  _hidden: boolean = false;\r\n\r\n  _connectionObj: JSONObject;\r\n  \r\n  constructor(n1: OWNode, n2: OWNode, connectionObj: JSONObject)\r\n  {\r\n    this.node1 = n1;\r\n    this.node2 = n2;\r\n\r\n    this._connectionObj = connectionObj;\r\n    \r\n    this.node1.addConnection(this);\r\n    this.node2.addConnection(this);\r\n\r\n    this._oneWay = connectionObj.getBoolean(\"one-way\", this._oneWay);\r\n    this._hidden = connectionObj.getBoolean(\"hidden\", this._hidden);\r\n    this._gated = connectionObj.getBoolean(\"gated\", this._gated);\r\n\r\n    if (EDIT_MODE) \r\n    {\r\n      this._visible = true;\r\n    }\r\n\r\n    if (connectionObj.hasKey(\"description\"))\r\n    {\r\n      this._hasDescription = true;\r\n      this._description = connectionObj.getString(\"description\");\r\n    }\r\n  }\r\n\r\n  updateAdjacentToPlayer(playerNode: OWNode): void\r\n  {\r\n    this._adjacentToPlayer = false;\r\n\r\n    if (this.node1 == playerNode || this.node2 == playerNode)\r\n    {\r\n      this._adjacentToPlayer = true;\r\n    }\r\n  }\r\n\r\n  hasDescription(): boolean\r\n  {\r\n    return this._hasDescription;\r\n  }\r\n\r\n  getDescription(): string\r\n  {\r\n    return this._description;\r\n  }\r\n\r\n  getWrongWayText(): string\r\n  {\r\n    return \"\u770B\u8D77\u6765\u8FD9\u6761\u8DEF\u53EA\u80FD\u4ECE\u53E6\u4E00\u4FA7\u624D\u80FD\u901A\u884C\";\r\n  }\r\n\r\n  getOtherNode(node: OWNode): OWNode\r\n  {\r\n    if (node == this.node1)\r\n    {\r\n      return this.node2;\r\n    }\r\n\r\n    return this.node1;\r\n  }\r\n  \r\n  traversibleFrom(startingNode: OWNode): boolean\r\n  {\r\n    return (!this._gated && (!this._oneWay || startingNode == this.node1));\r\n  }\r\n\r\n  fireTraverseEvent(): void\r\n  {\r\n    if (this._connectionObj.hasKey(\"traverse event\"))\r\n    {\r\n      messenger.sendMessage(this._connectionObj.getString(\"traverse event\"));\r\n    }\r\n  }\r\n\r\n  fireFailEvent(): void\r\n  {\r\n    if (this._connectionObj.hasKey(\"fail event\"))\r\n    {\r\n      messenger.sendMessage(this._connectionObj.getString(\"fail event\"));\r\n    }\r\n  }\r\n\r\n  traverse(): void\r\n  {\r\n    //_oneWay = false;\r\n    this._traversed = true;\r\n  }\r\n\r\n  revealHidden(): void\r\n  {\r\n    this._hidden = false;\r\n    this.reveal();\r\n  }\r\n\r\n  setVisible(visible: boolean): void {this._visible = visible;}\r\n  \r\n  reveal(): void\r\n  {\r\n    if (this._hidden)\r\n    {\r\n      return;\r\n    }\r\n\r\n    this.node1.setVisible(true);\r\n    this.node2.setVisible(true);\r\n    this._visible = true;\r\n  }\r\n\r\n  getAlpha(): number\r\n  {\r\n    if (!this._adjacentToPlayer)\r\n    {\r\n      return 35;\r\n    }\r\n    return 100;\r\n  }\r\n  \r\n  render(): void\r\n  {\r\n      if (!this._visible) {return;}\r\n\r\n      const dir: Vector2 = (this.node2.screenPosition.sub(this.node1.screenPosition));\r\n      const dist: number = dir.magnitude();\r\n      dir.normalize();\r\n\r\n      // draw segmented line\r\n      if (!this._traversed)\r\n      {\r\n        stroke(0, 0, 100, this.getAlpha());\r\n        //stroke(200, 100, 100);\r\n\r\n        let l: number = 0;\r\n        const segmentLength: number = 5;\r\n\r\n        while(l < dist)\r\n        {\r\n          const startPos: Vector2 = this.node1.screenPosition.add(dir.mult(l));\r\n          const endPos: Vector2 = this.node1.screenPosition.add(dir.mult(l+segmentLength));\r\n          line(startPos.x, startPos.y, endPos.x, endPos.y);\r\n          l += segmentLength * 3;\r\n        }\r\n      }\r\n      // draw solid line\r\n      else\r\n      {\r\n        stroke(0, 0, 100, this.getAlpha());\r\n        line(this.node1.screenPosition.x, this.node1.screenPosition.y, this.node2.screenPosition.x, this.node2.screenPosition.y);\r\n      }\r\n      \r\n      if (!this._oneWay) {return;}\r\n      \r\n      // draw arrow\r\n      const tip: Vector2 = this.node1.screenPosition.add(dir.mult(dist * 0.6));\r\n      const base: Vector2 = tip.sub(dir.mult(14));\r\n      \r\n      const right: Vector2 = base.add(dir.rightNormal().scale(7));\r\n      const left: Vector2 = base.add(dir.leftNormal().scale(7));\r\n      \r\n      fill(0, 0, 0);\r\n      triangle(right.x, right.y, left.x, left.y, tip.x, tip.y);\r\n  }\r\n}", "import { Actor, Entity } from \"./Entity\";\r\nimport { SectorArrivalScreen, QuantumEntanglementScreen } from \"./EventScreen\";\r\nimport { GlobalObserver, Message } from \"./GlobalMessenger\";\r\nimport { NodeObserver, OWNode, NodeButtonObserver } from \"./Node\";\r\nimport { NodeConnection } from \"./NodeConnection\";\r\nimport { Clue } from \"./PlayerData\";\r\nimport { SignalSource, Signal } from \"./Telescope\";\r\nimport { Vector2 } from \"./Vector2\";\r\nimport { messenger, gameManager, locator } from \"./app\";\r\nimport { JSONObject, loadJSONObject, JSONArray, saveJSONObject, println } from \"./compat\";\r\n\r\nexport class Sector implements NodeObserver, GlobalObserver\r\n{\r\n  _sectorRoot: Entity;\r\n\r\n  _actors: Actor[];\r\n  _nodes: OWNode[];\r\n  _nodeConnections: NodeConnection[];\r\n  \r\n  _name: string = \"unnamed\";\r\n  _JSONFilename: string;\r\n  _sectorJSON: JSONObject;\r\n\r\n  _skipArrivalScreen: boolean = false;\r\n  \r\n  orbitNode: OWNode;\r\n  defaultActorPosition: Vector2 = new Vector2(width - 100, height - 100);\r\n      \r\n  constructor()\r\n  {\r\n    this._sectorRoot = new Entity(width/2, height/2);\r\n    this._actors = new Array<Actor>();\r\n    this._nodes = new Array<OWNode>();\r\n    this._nodeConnections = new Array<NodeConnection>();\r\n\r\n    this.orbitNode = new OWNode(80, 170); // screen space\r\n    this.orbitNode.gravity = false;\r\n\r\n    messenger.addObserver(this);\r\n  }\r\n\r\n  setAnchorOffset(offsetX: number, offsetY: number): void\r\n  {\r\n    this._sectorRoot.setPosition(width/2 + offsetX, height/2 + offsetY);\r\n  }\r\n  \r\n  loadFromJSON(filename: string): void\r\n  {\r\n    this._JSONFilename = filename;\r\n    this._sectorJSON = loadJSONObject(filename);\r\n    \r\n    /** LOAD NODES **/\r\n    const nodes: JSONObject = this._sectorJSON.getJSONObject(\"Nodes\");\r\n    \r\n    for (const nodeName of nodes.keys()) {\r\n      this.addNode(this.createNode(nodeName, nodes.getJSONObject(nodeName)));\r\n    }\r\n    \r\n    /** LOAD CONNECTIONS **/\r\n    const connectionJSONArray: JSONArray = this._sectorJSON.getJSONArray(\"Connections\");\r\n    \r\n    for (let i: number = 0; i < connectionJSONArray.size(); i++)\r\n    {\r\n      const connection: JSONObject = connectionJSONArray.getJSONObject(i);\r\n      \r\n      const node1: OWNode = this.getNode(connection.getString(\"Node 1\"));\r\n      const node2: OWNode = this.getNode(connection.getString(\"Node 2\"));\r\n\r\n      this._nodeConnections.push(new NodeConnection(node1, node2, connection));\r\n    }\r\n  }\r\n\r\n  createNode(name: string, nodeObj: JSONObject): OWNode\r\n  {\r\n    return new OWNode(name, nodeObj);\r\n  }\r\n\r\n  saveSectorJSON(): void\r\n  {\r\n    saveJSONObject(this._sectorJSON, \"data/\" + this._JSONFilename);\r\n    println(\"Sector JSON saved\");\r\n  }\r\n  \r\n  load(): void\r\n  {\r\n    // stub to override\r\n  }\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n    // stub to override\r\n  }\r\n\r\n  onReceiveGlobalMessage(message: Message): void\r\n  {\r\n    if (message.id === \"quantum entanglement\")\r\n    {\r\n      this.onQuantumEntanglement();\r\n    }\r\n  }\r\n\r\n  onNodeVisited(node: OWNode): void\r\n  {\r\n    this.updateNodeRanges(gameManager._solarSystem.isPlayerInShip(), node);\r\n  }\r\n\r\n  onArrival(): void\r\n  {\r\n    if (!this._skipArrivalScreen && this._sectorJSON.hasKey(\"Sector Arrival\"))\r\n    {\r\n      this._skipArrivalScreen = true;\r\n      gameManager.pushScreen(new SectorArrivalScreen(this._sectorJSON.getJSONObject(\"Sector Arrival\").getString(\"text\"), this.getName()));\r\n    }\r\n  }\r\n\r\n  onQuantumEntanglement(): void\r\n  {\r\n    if (locator.player.currentSector == this)\r\n    {\r\n      gameManager.pushScreen(new QuantumEntanglementScreen());\r\n\r\n      // teleport player\r\n      for (let i: number = 0; i < this._nodes.length; i++)\r\n      {\r\n        if (this._nodes[i].allowQuantumEntanglement() && this._nodes[i] != locator.player.currentNode)\r\n        {\r\n          locator.player.setNode(this._nodes[i]);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  canClueBeInvoked(clue: Clue): boolean\r\n  {\r\n    return false;\r\n  }\r\n\r\n  // called from SectorScreen\r\n  invokeClue(clue: Clue): void\r\n  {\r\n    // override in derrived class\r\n  }\r\n\r\n  // update whether each node is \"in range\" (i.e. selectable)\r\n  updateNodeRanges(isPlayerInShip: boolean, playerNode: OWNode): void\r\n  {\r\n    for (let i: number = 0; i < this._nodes.length; i++)\r\n    {\r\n      this._nodes[i].updateInRange(isPlayerInShip, playerNode);\r\n    }\r\n\r\n    for (let i: number = 0; i < this._nodeConnections.length; i++)\r\n    {\r\n      this._nodeConnections[i].updateAdjacentToPlayer(playerNode);\r\n    }\r\n  }\r\n\r\n  allowTelescope(): boolean {return true;}\r\n\r\n  getName(): string\r\n  {\r\n    return this._name;\r\n  }\r\n  \r\n  getNode(index: number): OWNode\r\n  getNode(nodeID: string): OWNode\r\n  getNode(indexOrID: number | string): OWNode\r\n  {\r\n    if (typeof indexOrID === 'number') {\r\n      if (this._nodes[indexOrID])\r\n      {\r\n        return this._nodes[indexOrID];\r\n      }\r\n      println(\"No nodes at index \" + indexOrID);\r\n      return null;\r\n    } else {\r\n      for (let i: number = 0; i < this._nodes.length; i++)\r\n      {\r\n        if (this._nodes[i].getID() === indexOrID)\r\n        {\r\n          return this._nodes[i];\r\n        }\r\n      }\r\n      return null;\r\n    }\r\n  }\r\n\r\n  getSectorSignalSources(): SignalSource[]\r\n  {\r\n    const signalSources: SignalSource[] = new Array<SignalSource>();\r\n\r\n    for (let i: number = 0; i < this._nodes.length; i++)\r\n    {\r\n      if (this._nodes[i].getSignal() != null)\r\n      {\r\n        signalSources.push(new SignalSource(this._nodes[i]));\r\n      }\r\n    }\r\n    return signalSources;\r\n  }\r\n\r\n  getSectorSignals(): Signal[]\r\n  {\r\n    const nodeSignals: Signal[] = new Array<Signal>();\r\n\r\n    for (let i: number = 0; i < this._nodes.length; i++)\r\n    {\r\n      if (this._nodes[i].getSignal() != null)\r\n      {\r\n        nodeSignals.push(this._nodes[i].getSignal());\r\n      }\r\n    }\r\n    return nodeSignals;\r\n  }\r\n  \r\n  addNodeButtonObserver(observer: NodeButtonObserver): void\r\n  {\r\n    for (let i: number = 0; i < this._nodes.length; i++)\r\n    {\r\n      this._nodes[i].addObserver(observer);\r\n    }\r\n  }\r\n  \r\n  removeAllNodeButtonObservers(): void\r\n  {\r\n    for (let i: number = 0; i < this._nodes.length; i++)\r\n    {\r\n      this._nodes[i].removeAllObservers();\r\n    }\r\n  }\r\n  \r\n  update(): void\r\n  {\r\n    for (let i: number = 0; i < this._nodes.length; i++)\r\n    {\r\n      this._nodes[i].update();\r\n    }\r\n    \r\n    for (let i: number = 0; i < this._actors.length; i++)\r\n    {\r\n      this._actors[i].update();\r\n\r\n      if (this._actors[i].isDead())\r\n      {\r\n        this.removeActor(this._actors[i]);\r\n      }\r\n    }\r\n  }\r\n\r\n  renderBackground(): void\r\n  {\r\n    push();\r\n      translate(this._sectorRoot.position.x, this._sectorRoot.position.y);\r\n      this.drawSectorBackdrop();\r\n    pop();\r\n\r\n    // draw letterbox\r\n    fill(0, 0, 0);\r\n    noStroke();\r\n    rectMode(CORNER);\r\n    rect(0, 0, width, 90);\r\n    rect(0, height - 90, width, 90);\r\n    rectMode(CENTER);\r\n  }\r\n  \r\n  render(): void\r\n  {\r\n    for (let i: number = 0; i < this._nodeConnections.length; i++)\r\n    {\r\n      this._nodeConnections[i].render();\r\n    }\r\n    \r\n    for (let i: number = 0; i < this._nodes.length; i++)\r\n    {\r\n      this._nodes[i].render();\r\n    }\r\n    \r\n    for (let i: number = 0; i < this._actors.length; i++)\r\n    {\r\n      this._actors[i].render();\r\n    }\r\n\r\n    for (let i: number = 0; i < this._nodes.length; i++)\r\n    {\r\n      this._nodes[i].drawName();\r\n    }\r\n  }\r\n  \r\n  addNode(node: OWNode): void\r\n  {\r\n    if (!this._nodes.includes(node))\r\n    {\r\n      this._nodes.push(node);\r\n      node.setNodeObserver(this);\r\n      this._sectorRoot.addChild(node);\r\n    }\r\n    else\r\n    {\r\n      println(\"Node is already in this Sector!!!\");\r\n    }\r\n  }\r\n  \r\n  removeNode(node: OWNode): void\r\n  {\r\n    if (this._nodes.includes(node))\r\n    {\r\n      this._nodes.splice(this._nodes.indexOf(node), 1);\r\n      node.setNodeObserver(null);\r\n      this._sectorRoot.removeChild(node);\r\n    }\r\n    else\r\n    {\r\n      println(\"Node is not in this Sector!!!\");\r\n    }\r\n  }\r\n  \r\n  addActor(actor: Actor): void\r\n  addActor(actor: Actor, nodeName: string): void\r\n  addActor(actor: Actor, atNode: OWNode): void\r\n  addActor(actor: Actor, nodeOrName?: OWNode | string): void\r\n  {\r\n    const atNode: OWNode | null = (nodeOrName instanceof OWNode ? nodeOrName : this.getNode(nodeOrName)) ?? null\r\n    if (!this._actors.includes(actor))\r\n    {\r\n      actor.currentSector = this;\r\n\r\n      this._actors.push(actor);\r\n      this._sectorRoot.addChild(actor);\r\n      \r\n      if (atNode != null)\r\n      {\r\n        actor.setNode(atNode);\r\n      }\r\n      else\r\n      {\r\n        // spawn actor off-screen\r\n        actor.setScreenPosition(this.orbitNode.screenPosition.sub(new Vector2(200, 0)));\r\n        actor.moveToNode(this.orbitNode);\r\n      }\r\n    }\r\n    else\r\n    {\r\n      println(\"Actor is already in this Sector!!!\");\r\n    }\r\n  }\r\n  \r\n  removeActor(actor: Actor): void\r\n  {\r\n    if (this._actors.includes(actor))\r\n    {\r\n      actor.currentNode = null;\r\n      actor.currentSector = null;\r\n      actor.lastSector = this;\r\n      this._actors.splice(this._actors.indexOf(actor), 1);\r\n      this._sectorRoot.removeChild(actor);\r\n    }\r\n    else\r\n    {\r\n      println(\"Actor is not in this Sector!!!\");\r\n    }\r\n  }\r\n}", "import { Button } from \"./Button\";\r\nimport { DatabaseObserver } from \"./DatabaseScreen\";\r\nimport { ExploreData } from \"./ExploreData\";\r\nimport { OWNode } from \"./Node\";\r\nimport { Clue } from \"./PlayerData\";\r\nimport { OWScreen } from \"./Screen\";\r\nimport { feed, timeLoop, gameManager, locator, mediumFontData } from \"./app\";\r\n\r\nexport class ExploreScreen extends OWScreen implements DatabaseObserver\r\n{\r\n\tstatic BOX_WIDTH: number = 700;\r\n\tstatic BOX_HEIGHT: number = 400;\r\n\t_exploreData: ExploreData;\r\n\r\n\t_databaseButton: Button;\r\n\t_backButton: Button;\r\n\t_waitButton: Button;\r\n\r\n\tconstructor(location: OWNode)\r\n\t{\r\n\t\tsuper();\r\n\t\tthis._exploreData = location.getExploreData();\r\n\t\tthis.overlay = true; // continue to render BG\r\n\r\n\t\tthis.addButtonToToolbar(this._databaseButton = new Button(\"\u67E5\u770B\u6570\u636E\u5E93\", 0, 0, 150, 50));\r\n\t\tthis.addButtonToToolbar(this._waitButton  = new Button(\"\u7B49\u5F85 [ 1\u5206\u949F ]\", 0, 0, 150, 50));\r\n\t\tthis.addButtonToToolbar(this._backButton = new Button(\"\u7EE7\u7EED\", 0, 0, 150, 50));\r\n\r\n\t\tthis._exploreData.parseJSON();\r\n\t}\r\n\r\n\tupdate(): void{}\r\n\r\n\trenderBackground(): void {}\r\n\r\n\trender(): void\r\n\t{\r\n\t\tpush();\r\n\t\ttranslate(width / 2 - ExploreScreen.BOX_WIDTH / 2, height / 2 - ExploreScreen.BOX_HEIGHT / 2);\r\n\r\n\t\tstroke(0, 0, 100);\r\n\t\tfill(0, 0, 0);\r\n\t\trectMode(CORNER);\r\n\t\trect(0, 0, ExploreScreen.BOX_WIDTH, ExploreScreen.BOX_HEIGHT);\r\n\r\n\t\tfill(0, 0, 100);\r\n\r\n\t\ttextFont(mediumFontData);\r\n\t\ttextSize(18);\r\n\t\ttextAlign(LEFT, TOP);\r\n\r\n\t\tconst exploreText = this._exploreData.getExploreText();\r\n\t\tconst wrappedLines = this.wrapText(exploreText, ExploreScreen.BOX_WIDTH - 20); // \u81EA\u52A8\u6362\u884C\u5904\u7406\r\n\r\n\t\tlet y = 10; // \u521D\u59CB y \u5750\u6807\r\n\t\tconst lineHeight = 24; // \u56FA\u5B9A\u884C\u9AD8\uFF0C\u786E\u4FDD\u884C\u95F4\u8DDD\u8DB3\u591F\r\n\r\n\t\tfor (const line of wrappedLines) {\r\n\t\t\tif (line === \"\") {\r\n\t\t\t\t// \u5982\u679C\u662F\u7A7A\u884C\uFF0C\u76F4\u63A5\u589E\u52A0 y \u5750\u6807\uFF0C\u4FDD\u7559\u7A7A\u884C\r\n\t\t\t\ty += lineHeight;\r\n\t\t\t} else {\r\n\t\t\t\ttext(line, 10, y); // \u7ED8\u5236\u6BCF\u4E00\u884C\u6587\u672C\r\n\t\t\t\ty += lineHeight; // \u589E\u52A0 y \u5750\u6807\uFF0C\u786E\u4FDD\u4E0B\u4E00\u884C\u4E0D\u4F1A\u91CD\u53E0\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpop();\r\n\r\n\t\tfeed.render();\r\n\t\ttimeLoop.renderTimer();\r\n\t}\r\n\r\n\t/**\r\n\t * \u81EA\u52A8\u6362\u884C\u51FD\u6570\uFF1A\u6839\u636E\u6700\u5927\u5BBD\u5EA6\u5C06\u6587\u672C\u5206\u5272\u6210\u591A\u884C\uFF0C\u5E76\u4FDD\u7559\u7A7A\u884C\r\n\t * @param text \u539F\u59CB\u6587\u672C\r\n\t * @param maxWidth \u6700\u5927\u5BBD\u5EA6\r\n\t * @returns \u5206\u5272\u540E\u7684\u591A\u884C\u6587\u672C\u6570\u7EC4\r\n\t */\r\n\twrapText(text: string, maxWidth: number): string[] {\r\n\t\tconst lines: string[] = [];\r\n\t\tconst paragraphs = text.split('\\n'); // \u6309\u6362\u884C\u7B26\u5206\u5272\u6BB5\u843D\r\n\r\n\t\tfor (const paragraph of paragraphs) {\r\n\t\t\tif (paragraph.trim() === \"\") {\r\n\t\t\t\t// \u5982\u679C\u6BB5\u843D\u662F\u7A7A\u7684\uFF0C\u4FDD\u7559\u7A7A\u884C\r\n\t\t\t\tlines.push(\"\");\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tlet currentLine = \"\";\r\n\r\n\t\t\tfor (const char of paragraph) {\r\n\t\t\t\tconst testLine = currentLine + char;\r\n\t\t\t\tif (textWidth(testLine) > maxWidth) {\r\n\t\t\t\t\tlines.push(currentLine); // \u5F53\u524D\u884C\u5DF2\u6EE1\uFF0C\u4FDD\u5B58\r\n\t\t\t\t\tcurrentLine = char; // \u5F00\u59CB\u65B0\u7684\u4E00\u884C\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcurrentLine = testLine; // \u7EE7\u7EED\u6DFB\u52A0\u5B57\u7B26\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (currentLine) {\r\n\t\t\t\tlines.push(currentLine); // \u4FDD\u5B58\u6700\u540E\u4E00\u884C\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn lines;\r\n\t}\r\n\r\n\tonEnter(): void {}\r\n\r\n\tonExit(): void {}\r\n\r\n\tonInvokeClue(clue: Clue): void\r\n\t{\r\n\t\t// try to invoke it on the node first\r\n\t\tif (this._exploreData.canClueBeInvoked(clue.id))\r\n\t\t{\r\n\t\t\t// force-quit the database screen\r\n\t\t\tgameManager.popScreen();\r\n\t\t\tthis._exploreData.invokeClue(clue.id);\r\n\t\t\tthis._exploreData.explore();\r\n\t\t}\r\n\t\t// next try the whole sector\r\n\t\telse if (locator.player.currentSector != null && locator.player.currentSector.canClueBeInvoked(clue))\r\n\t\t{\r\n\t\t\tgameManager.popScreen();\r\n\t\t\tlocator.player.currentSector.invokeClue(clue);\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tfeed.publish(\"\u90A3\u4E2A\u73B0\u5728\u8FD8\u4E0D\u80FD\u5E2E\u52A9\u5230\u4F60\", true);\r\n\t\t}\r\n\t}\r\n\r\n\tonButtonUp(button: Button): void\r\n\t{\r\n\t\tif (button == this._databaseButton)\r\n\t    {\r\n\t      gameManager.pushScreen(gameManager.databaseScreen);\r\n\t      gameManager.databaseScreen.setObserver(this);\r\n\t    }\r\n\t    else if (button == this._backButton)\r\n\t    {\r\n\t    \tgameManager.popScreen();\r\n\t    }\r\n\t    else if (button == this._waitButton)\r\n\t    {\r\n\t    \ttimeLoop.waitFor(1);\r\n\t    \tthis._exploreData.explore();\r\n\t    }\r\n\t}\r\n\r\n\tonButtonEnterHover(button: Button): void{}\r\n\tonButtonExitHover(button: Button): void{}\r\n}", "import { Actor, Probe } from \"./Entity\";\r\nimport { ExploreScreen } from \"./ExploreScreen\";\r\nimport { OWNode } from \"./Node\";\r\nimport { NodeConnection } from \"./NodeConnection\";\r\nimport { feed, timeLoop, gameManager, messenger } from \"./app\";\r\n\r\nexport interface NodeActionObserver\r\n{\r\n\tonExploreNode(node: OWNode): void;\r\n\tonProbeNode(node: OWNode): void;\r\n\tonTravelAttempt(succeeded: boolean, node: OWNode, connection: NodeConnection): void;\r\n}\r\n\r\nexport abstract class NodeAction\r\n{\r\n\t_prompt: string = \"\";\r\n\t_mouseButton: string = LEFT;\r\n\t_observer: NodeActionObserver;\r\n\r\n\tsetObserver(observer: NodeActionObserver): void\r\n\t{\r\n\t\tthis._observer = observer;\r\n\t}\r\n\r\n\tgetMouseButton(): string\r\n\t{\r\n\t\treturn this._mouseButton;\r\n\t}\r\n\r\n\tsetMouseButton(button: string): void\r\n\t{\r\n\t\tthis._mouseButton = button;\r\n\t}\r\n\r\n\tabstract execute(): void;\r\n\t\r\n\tgetCost(): number\r\n\t{\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tgetPrompt(): string\r\n\t{\r\n\t\treturn this._prompt;\r\n\t}\r\n\r\n\tsetPrompt(description: string): void\r\n\t{\r\n\t\tif (this._mouseButton == LEFT)\r\n\t\t{\r\n\t\t\tthis._prompt += \"\u5DE6\u952E - \" + description;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis._prompt += \"\u53F3\u952E - \" + description;\r\n\t\t}\r\n\r\n\t\tthis._prompt += \" [ \" + this.getCost() + \" \u5206\u949F ]\";\r\n\t}\r\n}\r\n\r\nexport class ProbeAction extends NodeAction\r\n{\r\n\t_player: Actor;\r\n\t_location: OWNode;\r\n\r\n\tconstructor(button: string, player: Actor, location: OWNode, observer: NodeActionObserver)\r\n\t{\r\n\t\tsuper();\r\n\t\tthis._player = player;\r\n\t\tthis._location = location;\r\n\t\tthis.setMouseButton(button);\r\n\t\tthis.setObserver(observer);\r\n\t\tthis.setPrompt(\"\u53D1\u5C04\u4FA6\u5BDF\u5175\");\r\n\t}\r\n\r\n\texecute(): void\r\n\t{\r\n\t\tfeed.publish(\"\u4F60\u770B\u89C1\u4E86\" + this._location.getProbeDescription());\r\n\r\n\t\tconst probe: Actor = new Probe();\r\n\t\tthis._player.currentSector.addActor(probe);\r\n\t\tprobe.setScreenPosition(this._player.screenPosition);\r\n\t\tprobe.moveToNode(this._location);\r\n\r\n\t\tthis._observer.onProbeNode(this._location);\r\n\t}\r\n}\r\n\r\nexport class ExploreAction extends NodeAction\r\n{\r\n\t_location: OWNode;\r\n\r\n\tconstructor(button: string, location: OWNode, observer: NodeActionObserver)\r\n\t{\r\n\t\tsuper();\r\n\t\tthis._location = location;\r\n\t\tthis.setMouseButton(button);\r\n\t\tthis.setObserver(observer);\r\n\t\tthis.setPrompt(\"\u63A2\u7D22\");\r\n\t}\r\n\r\n\tgetCost(): number\r\n\t{\r\n\t\treturn 1;\r\n\t}\r\n\r\n\texecute(): void\r\n\t{\r\n\t\ttimeLoop.spendActionPoints(this.getCost());\r\n\r\n\t\t// prevent the action from happening if the sun's going to explode\r\n\t\tif (timeLoop.getActionPoints() == 0) \r\n\t\t{\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfeed.clear();\r\n\t\tfeed.publish(\"\u4F60\u63A2\u7D22\u4E86\" + this._location.getActualName());\r\n\t\t\r\n\t\tthis._observer.onExploreNode(this._location);\r\n\t\tgameManager.pushScreen(new ExploreScreen(this._location));\r\n\t\tthis._location.explore();\r\n\t}\r\n}\r\n\r\nexport class TravelAction extends NodeAction\r\n{\r\n\t_player: Actor;\r\n\t_ship: Actor;\r\n\t_destination: OWNode;\r\n\r\n\tconstructor(button: string, player: Actor, ship: Actor | null, destination: OWNode, observer: NodeActionObserver)\r\n\t{\r\n\t\tsuper();\r\n\t\tthis._ship = ship;\r\n\t\tthis._player = player;\r\n\t\tthis._destination = destination;\r\n\t\tthis.setMouseButton(button);\r\n\t\tthis.setObserver(observer);\r\n\t\tthis.setPrompt();\r\n\t}\r\n\r\n\tsetPrompt(prompt?: string): void\r\n\t{\r\n\t\tif (prompt !== undefined) return super.setPrompt(prompt);\r\n\t\tif (this._ship != null)\r\n\t\t{\r\n\t\t\tif (this._ship.currentNode == null && this._destination.gravity)\r\n\t\t\t{\r\n\t\t\t\tthis.setPrompt(\"\u964D\u843D\u5230\u6B64\u5904\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.setPrompt(\"\u98DE\u5230\u6B64\u5904\");\r\n\t\t}\r\n\t\telse if (this._destination.gravity)\r\n\t\t{\r\n\t\t\tthis.setPrompt(\"\u79FB\u52A8\u5230\u6B64\u5904\");\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tthis.setPrompt(\"\u98DE\u5230\u6B64\u5904\");\r\n\t\t}\r\n\t}\r\n\r\n\tgetCost(): number\r\n\t{\r\n\t\treturn 1;\r\n\t}\r\n\r\n\texecute(): void\r\n\t{\r\n\t\tfeed.clear();\r\n\r\n\t\tif (this._player.currentNode != null)\r\n\t\t{\r\n\t\t\tconst connection: NodeConnection = this._destination.getConnection(this._player.currentNode);\r\n\r\n\t\t\tif (connection != null)\r\n\t\t\t{\t\r\n\t\t\t\tif (!connection.traversibleFrom(this._player.currentNode))\r\n\t\t\t\t{\r\n\t\t\t\t\tconnection.fireFailEvent();\r\n\t\t\t\t\tfeed.publish(connection.getWrongWayText(), true);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconnection.fireTraverseEvent();\r\n\t\t\t\tconnection.traverse();\r\n\r\n\t\t\t\tif (connection.hasDescription())\r\n\t\t\t\t{\r\n\t\t\t\t\tfeed.publish(\"\u4F60\u7A7F\u8FC7\u4E86\" + connection.getDescription());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// publish feed first in case we want to override it (e.g. death-by-anglerfish scenario)\r\n\t\tif (this._destination.hasDescription())\r\n\t\t{\r\n\t\t\tfeed.publish(\"\u4F60\u5DF2\u62B5\u8FBE\" + this._destination.getDescription());\r\n\t\t}\r\n\r\n\t\tif (this._ship != null)\r\n\t\t{\r\n\t\t\tthis._ship.moveToNode(this._destination);\r\n\t\t}\r\n\t\t\r\n\t\tmessenger.sendMessage(\"reset reachability\");\r\n\t\tthis._player.moveToNode(this._destination);\r\n\t\tthis._observer.onTravelAttempt(true, this._destination, this._destination.getConnection(this._player.currentNode));\r\n\t\ttimeLoop.spendActionPoints(this.getCost());\r\n\t}\r\n}", "import { ButtonObserver, Button } from \"./Button\";\r\nimport { NodeButtonObserver, OWNode } from \"./Node\";\r\nimport { Sector } from \"./Sector\";\r\nimport { Vector2 } from \"./Vector2\";\r\n\r\nexport class SectorEditor implements NodeButtonObserver, ButtonObserver\r\n{\r\n  _activeSector: Sector;\r\n  _saveButton: Button;\r\n  \r\n  _selection: OWNode;\r\n  _dragging: boolean = false;\r\n  \r\n  constructor(sector: Sector)\r\n  {\r\n    this._activeSector = sector;\r\n    this._saveButton = new Button(\"\u4FDD\u5B58\", width - 75, height - 50, 100, 50);\r\n    this._saveButton.setObserver(this);\r\n  }\r\n  \r\n  update(): void\r\n  {\r\n    this._saveButton.update();\r\n    \r\n    if (this._selection != null)\r\n    {\r\n      if (this._dragging)\r\n      {\r\n        this._selection.setScreenPosition(new Vector2(mouseX, mouseY));\r\n        \r\n        if (!mouseIsPressed)\r\n        {\r\n          this._selection.savePosition();\r\n          this._selection = null;\r\n          this._dragging = false;\r\n        }\r\n      }\r\n      \r\n      this._dragging = (mouseIsPressed && mouseButton == CENTER);\r\n    }\r\n  }\r\n  \r\n  render(): void\r\n  {\r\n    this._saveButton.render();\r\n  }\r\n  \r\n  onButtonUp(button: Button): void\r\n  {\r\n    if (button == this._saveButton)\r\n    {\r\n      this._activeSector.saveSectorJSON();\r\n    }\r\n  }\r\n  \r\n  onNodeGainFocus(node: OWNode): void\r\n  {\r\n    this._selection = node;\r\n  }\r\n  \r\n  onNodeLoseFocus(node: OWNode): void\r\n  {\r\n    if (!this._dragging)\r\n    {\r\n      this._selection = null;\r\n    }\r\n  }\r\n\r\n  onTravelToNode(node: OWNode): void{}\r\n  onExploreNode(node: OWNode): void{}\r\n  onProbeNode(node: OWNode): void{}\r\n  \r\n  onButtonEnterHover(button: Button): void{}\r\n  onButtonExitHover(button: Button): void{}\r\n  onNodeSelected(node: OWNode): void{}\r\n}", "import { Button } from \"./Button\";\r\nimport { DatabaseObserver } from \"./DatabaseScreen\";\r\nimport { Actor } from \"./Entity\";\r\nimport { ExploreData } from \"./ExploreData\";\r\nimport { ExploreScreen } from \"./ExploreScreen\";\r\nimport { NodeButtonObserver, OWNode } from \"./Node\";\r\nimport { NodeActionObserver, NodeAction, ProbeAction, TravelAction, ExploreAction } from \"./NodeAction\";\r\nimport { NodeConnection } from \"./NodeConnection\";\r\nimport { Clue } from \"./PlayerData\";\r\nimport { OWScreen } from \"./Screen\";\r\nimport { Sector } from \"./Sector\";\r\nimport { SectorEditor } from \"./SectorEditor\";\r\nimport { gameManager, feed, timeLoop, EDIT_MODE, mediumFontData, smallFont } from \"./app\";\r\n\r\nexport class SectorScreen extends OWScreen implements NodeButtonObserver, NodeActionObserver, DatabaseObserver\r\n{\r\n  _player: Actor;\r\n  _ship: Actor;\r\n  _sector: Sector;\r\n  \r\n  _editor: SectorEditor;\r\n  \r\n  _focusNode: OWNode;\r\n\r\n  _databaseButton: Button;\r\n  _liftoffButton: Button;\r\n  _waitButton: Button;\r\n  _telescopeButton: Button;\r\n\r\n  _actionlessPrompt: string = \"inaccessible\";\r\n  _actions: NodeAction[];\r\n\r\n  constructor(sector: Sector, player: Actor, ship: Actor)\r\n  {\r\n    super();\r\n    \r\n    this._actions = new Array<NodeAction>();\r\n    this._editor = new SectorEditor(sector);\r\n    \r\n    this._player = player;\r\n    this._ship = ship;\r\n    this._sector = sector;\r\n\r\n    this.addButtonToToolbar(this._databaseButton = new Button(\"\u67E5\u770B\u6570\u636E\u5E93\", 0, 0, 150, 50));\r\n    this.addButtonToToolbar(this._telescopeButton = new Button(\"\u626B\u63CF\u4FE1\u53F7\", 0, 0, 150, 50));\r\n    this._telescopeButton.setDisabledPrompt(\"\u626B\u63CF\u4FE1\u53F7\\n\uFF08\u89C6\u91CE\u53D7\u963B\uFF09\");\r\n\r\n    this.addButtonToToolbar(this._waitButton  = new Button(\"\u7B49\u5F85 [ 1 \u5206\u949F ]\", 0, 0, 150, 50));\r\n    this.addButtonToToolbar(this._liftoffButton  = new Button(\"\u79BB\u5F00\u8BE5\u533A\u57DF\", 0, 0, 150, 50));\r\n    this._liftoffButton.setDisabledPrompt(\"\u79BB\u5F00\u8BE5\u533A\u57DF\\n\uFF08\u5FC5\u987B\u4F4D\u4E8E\u98DE\u8239\u65C1\u8FB9\uFF09\");\r\n  }\r\n\r\n  onEnter(): void\r\n  {\r\n    this._sector.addNodeButtonObserver(this);\r\n    this._sector.addNodeButtonObserver(this._editor);\r\n    this._sector.updateNodeRanges(this.isPlayerInShip(), this._player.currentNode);\r\n    this._focusNode = null;\r\n  }\r\n  \r\n  onExit(): void\r\n  {\r\n    this._sector.removeAllNodeButtonObservers();\r\n  }\r\n\r\n  onButtonUp(button: Button): void\r\n  {\r\n    if (button == this._databaseButton)\r\n    {\r\n      gameManager.databaseScreen.setObserver(this);\r\n      gameManager.pushScreen(gameManager.databaseScreen);\r\n    }\r\n    else if (button == this._liftoffButton)\r\n    {\r\n      this._sector.removeActor(this._player);\r\n      this._sector.removeActor(this._ship);\r\n      gameManager.loadSolarSystemMap();\r\n      feed.clear();\r\n      feed.publish(\"\u4F60\u5DF2\u79BB\u5F00\" + this._sector.getName());\r\n    }\r\n    else if (button == this._telescopeButton)\r\n    {\r\n      gameManager.loadTelescopeView();\r\n    }\r\n    else if (button == this._waitButton)\r\n    {\r\n      timeLoop.waitFor(1);\r\n    }\r\n  }\r\n\r\n  onInvokeClue(clue: Clue): void\r\n  {\r\n    // check for node-specific clue effects\r\n    if (this._player.currentNode != null && this._player.currentNode.isExplorable())\r\n    {\r\n      const exploreData: ExploreData = this._player.currentNode.getExploreData();\r\n      exploreData.parseJSON();\r\n\r\n      if (exploreData.canClueBeInvoked(clue.id))\r\n      {\r\n        gameManager.popScreen(); // force-quit the database screen\r\n        gameManager.pushScreen(new ExploreScreen(this._player.currentNode)); // push on a new explorescreen\r\n        exploreData.invokeClue(clue.id);\r\n        exploreData.explore();\r\n        return;\r\n      }\r\n    }\r\n    \r\n    // next try the whole sector\r\n    if (this._player.currentSector != null && this._player.currentSector.canClueBeInvoked(clue))\r\n    {\r\n      this._player.currentSector.invokeClue(clue);\r\n    }\r\n    else\r\n    {\r\n      feed.publish(\"\u90A3\u4E2A\u73B0\u5728\u8FD8\u4E0D\u80FD\u5E2E\u52A9\u5230\u4F60\", true);\r\n    }\r\n  }\r\n\r\n  update(): void\r\n  {\r\n    // update action button visibility\r\n    this._liftoffButton.enabled = (this._player.currentNode == this._ship.currentNode);\r\n    this._telescopeButton.enabled = (this._player.currentNode != null && this._player.currentNode.allowTelescope && this._player.currentSector.allowTelescope());\r\n\r\n    this._sector.update();\r\n    if (EDIT_MODE) this._editor.update();\r\n  }\r\n\r\n  renderBackground(): void\r\n  {\r\n    super.renderBackground();\r\n    this._sector.renderBackground();\r\n  }\r\n\r\n  render(): void\r\n  {\r\n    this._sector.render();\r\n    feed.render();\r\n    timeLoop.renderTimer();\r\n\r\n    fill(0, 0, 100);\r\n    textSize(18);\r\n    textFont(mediumFontData);\r\n    textAlign(RIGHT);\r\n    text(this._sector.getName(),width - 20, height - 100);\r\n\r\n    if (!this.active) return;\r\n    if (EDIT_MODE) this._editor.render();\r\n\r\n    this.drawNodeGUI(this._focusNode, this._actions);\r\n  }\r\n\r\n  drawNodeGUI(target: OWNode, actions: NodeAction[]): void\r\n  {\r\n    if (target == null || (this._actions.length == 0 && target == this._player.currentNode)) {return;}\r\n\r\n    smallFont();\r\n\r\n    const yOffset: number = 60;\r\n    let promptWidth: number = textWidth(this._actionlessPrompt);\r\n\r\n    // find prompt width\r\n    for (let i: number = 0; i < actions.length; i++) \r\n    {\r\n      promptWidth = max(promptWidth, textWidth(actions[i].getPrompt()));\r\n    }\r\n\r\n    // draw box\r\n    stroke(200, 100, 100);\r\n    fill(0, 0, 0);\r\n    rectMode(CORNER);\r\n    rect(target.screenPosition.x - promptWidth * 0.5 - 10, target.screenPosition.y + yOffset - 15, promptWidth + 15, max(20, 20 * actions.length) + 10);\r\n\r\n    // draw prompts\r\n    fill(0, 0, 100);\r\n    textAlign(LEFT, CENTER);\r\n\r\n    for (let i: number = 0; i < actions.length; i++) \r\n    {\r\n      text(actions[i].getPrompt(), target.screenPosition.x - promptWidth * 0.5, target.screenPosition.y + yOffset + 20 * i);\r\n    }\r\n\r\n    if (actions.length == 0)\r\n    {\r\n      text(this._actionlessPrompt, target.screenPosition.x - promptWidth * 0.5, target.screenPosition.y + yOffset);\r\n    }\r\n  }\r\n\r\n  onTravelAttempt(succeeded: boolean, node: OWNode, connection: NodeConnection): void{}\r\n  onExploreNode(node: OWNode): void{}\r\n  onProbeNode(node: OWNode): void{}\r\n\r\n  onNodeSelected(node: OWNode): void\r\n  {\r\n    /** EXCECUTE ACTION **/\r\n    for (let i: number = 0; i < this._actions.length; i++) \r\n    {\r\n      if (this._actions[i].getMouseButton() == mouseButton)\r\n      {\r\n        this._actions[i].execute();\r\n        break;\r\n      }\r\n    }\r\n\r\n    this.refreshAvailableActions();\r\n  }\r\n  \r\n  onNodeGainFocus(node: OWNode): void\r\n  {\r\n    this._focusNode = node;\r\n    this.refreshAvailableActions();\r\n  }\r\n  \r\n  onNodeLoseFocus(node: OWNode): void\r\n  {\r\n    if (node == this._focusNode)\r\n    {\r\n      this._focusNode = null;\r\n      this.refreshAvailableActions();\r\n    }\r\n  }\r\n\r\n  refreshAvailableActions(): void\r\n  {\r\n    this._actions.length = 0;\r\n\r\n    if (this._focusNode == null) \r\n    {\r\n      return;\r\n    }\r\n\r\n    if (this._player.currentNode != this._focusNode)\r\n    {\r\n      if (this._focusNode.inRange())\r\n      {\r\n        if (this._focusNode.isProbeable())\r\n        {\r\n          this._actions.push(new ProbeAction(RIGHT, this._player, this._focusNode, this));\r\n        }\r\n        \r\n        if (this.isPlayerInShip() && this._focusNode.shipAccess)\r\n        {\r\n          this._actions.push(new TravelAction(LEFT, this._player, this._ship, this._focusNode, this));\r\n        }\r\n        else\r\n        {\r\n          this._actions.push(new TravelAction(LEFT, this._player, null, this._focusNode, this));\r\n        }\r\n      }\r\n    }\r\n    else\r\n    {\r\n      if (this._focusNode.isExplorable())\r\n      {\r\n        this._actions.push(new ExploreAction(LEFT, this._focusNode, this));\r\n      }\r\n    }\r\n  }\r\n\r\n  isPlayerInShip(): boolean\r\n  {\r\n    return(this._player.currentNode == this._ship.currentNode);\r\n  }\r\n}", "import { Button } from \"./Button\";\r\nimport { OWScreen } from \"./Screen\";\r\nimport { Sector } from \"./Sector\";\r\nimport { Telescope, SignalSource, FrequencyButton } from \"./Telescope\";\r\nimport { gameManager } from \"./app\";\r\n\r\nexport class SectorTelescopeScreen extends OWScreen\r\n{\r\n\t_sector: Sector;\r\n\t_telescope: Telescope;\r\n\t_exitButton: Button;\r\n\t_zoomOutButton: Button;\r\n\t_nextFrequency: Button;\r\n\t_previousFrequency: Button;\r\n\r\n\t_signalSources: SignalSource[];\r\n\r\n\tconstructor(sector: Sector, telescope: Telescope)\r\n\t{\r\n\t\tsuper();\r\n\t\tthis._sector = sector;\r\n\t\tthis._telescope = telescope;\r\n\t\tthis._signalSources = sector.getSectorSignalSources();\r\n\t\t\r\n\t\tthis.addButton(this._nextFrequency = new FrequencyButton(true));\r\n\t\tthis.addButton(this._previousFrequency = new FrequencyButton(false));\r\n\r\n\t\tthis.addButtonToToolbar(this._zoomOutButton = new Button(\"\u7F29\u5C0F\", 0, 0, 150, 50));\r\n\t\tthis.addButtonToToolbar(this._exitButton = new Button(\"\u9000\u51FA\", 0, 0, 150, 50));\r\n\t}\r\n\r\n\tonEnter(): void\r\n\t{\r\n\t\tnoCursor();\r\n\t}\r\n\r\n\tonExit(): void\r\n\t{\r\n\t\tcursor(HAND);\r\n\t}\r\n\r\n\tupdate(): void\r\n\t{\r\n\t\t// don't want to update node buttons\r\n\t\t//_sector.update();\r\n\t\tthis._telescope.update(this._signalSources);\r\n\t}\r\n\r\n\trenderBackground(): void\r\n\t{\r\n\t\tsuper.renderBackground();\r\n\t\tthis._sector.renderBackground();\r\n\t}\r\n\r\n\trender(): void\r\n\t{\r\n\t\tthis._sector.render();\r\n\t\tthis._telescope.render();\r\n\t}\r\n\r\n\tonButtonUp(button: Button): void\r\n\t{\r\n\t\tif (button == this._exitButton)\r\n\t\t{\r\n\t\t\tgameManager.popScreen();\r\n\t\t\tgameManager.popScreen();\r\n\t\t}\r\n\t\telse if (button == this._zoomOutButton)\r\n\t\t{\r\n\t\t\tgameManager.popScreen();\r\n\t\t}\r\n\t\telse if (button == this._nextFrequency)\r\n\t\t{\r\n\t\t\tthis._telescope.nextFrequency();\r\n\t\t}\r\n\t\telse if (button == this._previousFrequency)\r\n\t    {\r\n\t\t\tthis._telescope.previousFrequency();\r\n\t    }\r\n\t}\r\n}", "import { OWNode } from \"./Node\";\r\nimport { messenger } from \"./app\";\r\nimport { JSONObject } from \"./compat\";\r\n\r\nexport class AnglerfishNode extends OWNode\r\n{\r\n\tconstructor(nodeName: string, nodeJSONObj: JSONObject)\r\n\t{\r\n\t\tsuper(nodeName, nodeJSONObj);\r\n\t\tthis.entryPoint = true;\r\n\t\tthis.shipAccess = true;\r\n\t\tthis.gravity = false;\r\n\r\n\t\tthis._visible = true;\r\n\t}\r\n\r\n\tgetKnownName(): string\r\n\t{\r\n\t\tif (this._visited) return \"\u9B9F\u9C47\u9C7C\";\r\n\t\telse return \"\uFF1F\uFF1F\uFF1F\";\r\n\t} \r\n\r\n\tgetDescription(): string \r\n\t{\r\n\t\treturn \"\u4E00\u6761\u5DE8\u5927\u800C\u9965\u997F\u7684\u9B9F\u9C47\u9C7C\";\r\n\t}\r\n\r\n\tgetProbeDescription(): string \r\n\t{\r\n\t\treturn \"\u4E00\u675F\u5149\u7A7F\u8FC7\u96FE\u6C14\";\r\n\t}\r\n\r\n\thasDescription(): boolean {return true;}\r\n\r\n\tisProbeable(): boolean {return true;}\r\n\r\n\tisExplorable(): boolean {return true;} // tricks graphics into rendering question mark\r\n\r\n\tvisit(): void\r\n\t{\r\n\t\tthis._visited = true;\r\n\t\tthis.setVisible(true);\r\n\r\n\t\tmessenger.sendMessage(\"death by anglerfish\");\r\n\r\n\t\tif (this._observer != null)\r\n\t\t{\r\n\t\t\tthis._observer.onNodeVisited(this);\r\n\t\t}\r\n\t}\r\n}", "import { OWNode } from \"./Node\";\r\nimport { locator } from \"./app\";\r\nimport { JSONObject } from \"./compat\";\r\n\r\nexport class QuantumNode extends OWNode\r\n{\r\n\tconstructor(name: string, nodeJSON: JSONObject)\r\n\t{\r\n\t\tsuper(name, nodeJSON);\r\n\t}\r\n\r\n\tupdateQuantumStatus(quantumState: number): void\r\n\t{\r\n\t\tconst visible: boolean = this._nodeJSONObj.getInt(\"quantum location\") == quantumState;\r\n\t\tthis.setVisible(visible);\r\n\r\n\t\t// hide connections\r\n\t\tif (!visible)\r\n\t\t{\r\n\t\t\tfor (const connection of this._connections.values()) \r\n\t\t    {\r\n\t\t    \tconnection.setVisible(visible);\r\n\t\t    }\r\n\t\t}\r\n\t}\r\n\r\n\tallowQuantumEntanglement(): boolean\r\n\t{\r\n\t\treturn this._nodeJSONObj.getInt(\"quantum location\") == locator.getQuantumMoonLocation() && this._nodeJSONObj.getBoolean(\"entanglement node\", false);\r\n\t}\r\n}", "import { AnglerfishNode } from \"./AnglerfishNode\";\r\nimport { Actor } from \"./Entity\";\r\nimport { QuantumArrivalScreen } from \"./EventScreen\";\r\nimport { Message } from \"./GlobalMessenger\";\r\nimport { OWNode } from \"./Node\";\r\nimport { QuantumNode } from \"./QuantumNode\";\r\nimport { Sector } from \"./Sector\";\r\nimport { Vector2 } from \"./Vector2\";\r\nimport { locator, gameManager } from \"./app\";\r\nimport { JSONObject } from \"./compat\";\r\n\r\nexport class Comet extends Sector\r\n{  \r\n  load(): void\r\n  {\r\n    this._name = \"\u5F57\u661F\";\r\n    this.loadFromJSON(\"data/sectors/comet.json\");\r\n    //setAnchorOffset(100, 30);\r\n  }\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n    stroke(200, 30, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(0, 0, 300, 300);\r\n  }\r\n}\r\n\r\nexport class RockyTwin extends Sector\r\n{  \r\n  load(): void\r\n  {\r\n    this._name = \"\u4F59\u70EC\u53CC\u661F\";\r\n    this.loadFromJSON(\"data/sectors/rocky_twin.json\");\r\n    //setAnchorOffset(100, 30);\r\n  }\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n    stroke(60, 100, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(0, 0, 500, 500);\r\n  }\r\n}\r\n\r\nexport class SandyTwin extends Sector\r\n{  \r\n  load(): void\r\n  {\r\n    this._name = \"\u7070\u70EC\u53CC\u661F\";\r\n    this.loadFromJSON(\"data/sectors/sandy_twin.json\");\r\n    //setAnchorOffset(100, 30);\r\n  }\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n    stroke(60, 100, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(0, 0, 500, 500);\r\n  }\r\n}\r\n\r\nexport class TimberHearth extends Sector\r\n{  \r\n  load(): void\r\n  {\r\n    this._name = \"\u6728\u7076\u661F\";\r\n    this.loadFromJSON(\"data/sectors/timber_hearth.json\");\r\n    //setAnchorOffset(100, 30);\r\n  }\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n    stroke(200, 100, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(0, 0, 500, 500);\r\n  }\r\n}\r\n\r\nexport class BrittleHollow extends Sector\r\n{  \r\n  load(): void\r\n  { \r\n    this._name = \"\u788E\u7A7A\u661F\";\r\n    this.loadFromJSON(\"data/sectors/brittle_hollow.json\");\r\n  }\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n    stroke(0, 100, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(0, 0, 500, 500);\r\n    this.drawBlackHole(35);\r\n  }\r\n\r\n  drawBlackHole(radius: number): void \r\n  {\r\n    // black hole\r\n    noStroke();\r\n    fill(0,100,0);\r\n    ellipse(0, 0, radius * 0.5, radius * 0.5);\r\n    \r\n    // spiral\r\n    noFill();\r\n    strokeWeight(1);\r\n    stroke(260, 80, 70);\r\n\r\n    const start: number = radius * 0.125;\r\n    const end: number = radius;\r\n    const spirals: number = 3;\r\n    const step: number = 0.1 * PI;\r\n\r\n    let x0: number = start;\r\n    let y0: number = 0;\r\n\r\n    for (let t: number = step; t < spirals * TWO_PI; t += step) \r\n    {\r\n      let theta: number = t;\r\n\r\n      let r: number = (theta / (spirals * TWO_PI)) * (end - start) + start;\r\n      const x3: number = r * cos(theta);\r\n      const y3: number = r * sin(theta);\r\n\r\n      theta -= step / 3;\r\n      r = (theta / (spirals * TWO_PI)) * (end - start) + start;\r\n      const x2: number = r * cos(theta);\r\n      const y2: number = r * sin(theta);\r\n\r\n      theta -= step / 3;\r\n      r = (theta / (spirals * TWO_PI)) * (end - start) + start;\r\n      const x1: number = r * cos(theta);\r\n      const y1: number = r * sin(theta);\r\n\r\n      bezier(x0, y0, x1, y1, x2, y2, x3, y3);\r\n      x0 = x3;\r\n      y0 = y3;\r\n    }\r\n  }\r\n}\r\n\r\nexport class GiantsDeep extends Sector\r\n{  \r\n  load(): void\r\n  { \r\n    this._name = \"\u6DF1\u5DE8\u661F\";\r\n    this.loadFromJSON(\"data/sectors/giants_deep.json\");\r\n    this.setAnchorOffset(0, 60);\r\n  }\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n    fill(0, 0, 0);\r\n\r\n    stroke(180, 100, 100);\r\n    ellipse(0, 0, 600, 600);\r\n\r\n    stroke(200, 100, 60);\r\n    ellipse(0, 0, 400, 400);\r\n\r\n    // stroke(220, 100, 50);\r\n    // ellipse(0, 0, 100, 100);\r\n  }\r\n}\r\n\r\nexport class DarkBramble extends Sector\r\n{\r\n  _fogLightNodes: OWNode[];\r\n  _fogLightPositions: Vector2[];\r\n\r\n  constructor()\r\n  {\r\n    super();\r\n    this._fogLightNodes = new Array<OWNode>();\r\n    this._fogLightPositions = new Array<Vector2>();\r\n  }\r\n\r\n  load(): void\r\n  {\r\n    this._name = \"\u9ED1\u8346\u661F\";\r\n    this.loadFromJSON(\"data/sectors/dark_bramble.json\");\r\n\r\n    for (let i: number = 0; i < this._fogLightNodes.length; i++)\r\n    {\r\n      const index: number = int(random(0, this._fogLightPositions.length));\r\n      //println(\"pos:\", this._fogLightPositions[index]);\r\n      this._fogLightNodes[i].setPosition(this._fogLightPositions[index]);\r\n      this._fogLightPositions.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  createNode(name: string, nodeObj: JSONObject): OWNode\r\n  {\r\n    let newNode: OWNode;\r\n\r\n    if (nodeObj.hasKey(\"anglerfish\"))\r\n    {\r\n      newNode = new AnglerfishNode(name, nodeObj);\r\n      this._fogLightNodes.push(newNode);\r\n      this._fogLightPositions.push(new Vector2(newNode.position));\r\n    }\r\n    else\r\n    {\r\n      newNode = new OWNode(name, nodeObj);\r\n    }\r\n\r\n    if (nodeObj.getBoolean(\"fog light\", false))\r\n    {\r\n      this._fogLightNodes.push(newNode);\r\n      this._fogLightPositions.push(new Vector2(newNode.position));\r\n    }\r\n\r\n    return newNode;\r\n  }\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n    stroke(120, 100, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(100, 0, 700, 500);\r\n  }\r\n}\r\n\r\nexport class QuantumMoon extends Sector\r\n{\r\n  _quantumLocation: number = 0;\r\n  _turnsSinceEOTU: number = 0;\r\n\r\n  load(): void\r\n  {\r\n    this._name = \"\u91CF\u5B50\u536B\u661F\";\r\n    this.loadFromJSON(\"data/sectors/quantum_moon.json\");\r\n    //setAnchorOffset(100, 30);\r\n  }\r\n\r\n  onReceiveGlobalMessage(message: Message): void\r\n  {\r\n    if (message.id === \"quantum entanglement\")\r\n    {\r\n      if (locator.player.currentSector == this)\r\n      {\r\n        this.collapse();\r\n        this.onQuantumEntanglement();\r\n      }\r\n    }\r\n  }\r\n\r\n  onArrival(): void\r\n  {\r\n    // overrides normal arrival screen\r\n    gameManager.pushScreen(new QuantumArrivalScreen());\r\n  }\r\n\r\n  createNode(name: string, nodeObj: JSONObject): OWNode\r\n  {\r\n    return new QuantumNode(name, nodeObj);\r\n  }\r\n\r\n  collapse(): void\r\n  {\r\n    // move to random location\r\n    let tLocation: number = this._quantumLocation;\r\n    while (tLocation == this._quantumLocation)\r\n    {\r\n      tLocation = int(random(5));\r\n    }\r\n    this._quantumLocation = tLocation;\r\n\r\n    // limit how many turns can pass without going to the EOTU\r\n    if (this._quantumLocation != 4)\r\n    {\r\n      this._turnsSinceEOTU++;\r\n\r\n      if (this._turnsSinceEOTU > 4)\r\n      {\r\n        this._quantumLocation = 4;\r\n        this._turnsSinceEOTU = 0;\r\n      }\r\n    }\r\n    \r\n    // update node visibility\r\n    for (let i: number = 0; i < this._nodes.length; i++)\r\n    {\r\n      (this._nodes[i] as QuantumNode).updateQuantumStatus(this._quantumLocation);\r\n    }\r\n  }\r\n\r\n  onQuantumEntanglement(): void\r\n  {\r\n    super.onQuantumEntanglement();\r\n      \r\n    // remove ship\r\n    if (locator.ship.currentSector == this)\r\n    {\r\n      locator.ship.currentSector.removeActor(locator.ship);\r\n    }\r\n  }\r\n\r\n  getQuantumLocation(): number {return this._quantumLocation;}\r\n\r\n  allowTelescope(): boolean {return false;}\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n    stroke(300, 50, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(0, 0, 300, 300);\r\n  }\r\n\r\n  removeActor(actor: Actor): void\r\n  {\r\n    super.removeActor(actor);\r\n    actor.lastSector = null; // prevents animation of leaving Sector\r\n  }\r\n}\r\n\r\nexport class EyeOfTheUniverse extends Sector\r\n{  \r\n  load(): void\r\n  {\r\n    this._name = \"\u6BD4\u5B87\u5B99\u66F4\u4E3A\u53E4\u8001\u7684\u4E8B\u7269\";\r\n    this.loadFromJSON(\"data/sectors/eye_of_the_universe.json\");\r\n  }\r\n\r\n  allowTelescope(): boolean {return false;}\r\n  \r\n  drawSectorBackdrop(): void\r\n  {\r\n  }\r\n}", "import { Actor, Player, Ship } from \"./Entity\";\r\nimport { SectorName } from \"./Enums\";\r\nimport { GlobalObserver, Message } from \"./GlobalMessenger\";\r\nimport { OWNode } from \"./Node\";\r\nimport { Sector } from \"./Sector\";\r\nimport { Comet, RockyTwin, SandyTwin, TimberHearth, BrittleHollow, GiantsDeep, DarkBramble, QuantumMoon, EyeOfTheUniverse } from \"./SectorLibrary\";\r\nimport { messenger, feed, gameManager } from \"./app\";\r\nimport { println } from \"./compat\";\r\n\r\nexport class SolarSystem implements GlobalObserver\r\n{\r\n  player: Actor;\r\n  ship: Actor;\r\n  \r\n  comet: Sector;\r\n  rockyTwin: Sector;\r\n  sandyTwin: Sector;\r\n  timberHearth: Sector;\r\n  brittleHollow: Sector;\r\n  giantsDeep: Sector;\r\n  darkBramble: Sector;\r\n  quantumMoon: Sector;\r\n  eyeOfTheUniverse: Sector;\r\n\r\n  _sectorList: Sector[];\r\n  \r\n  constructor()\r\n  {\r\n    messenger.addObserver(this);\r\n\r\n    println(\"Solar System loading...\");\r\n\r\n    this._sectorList = new Array<Sector>();\r\n\r\n    this._sectorList.push(this.comet = new Comet());\r\n    this._sectorList.push(this.rockyTwin = new RockyTwin());\r\n    this._sectorList.push(this.sandyTwin = new SandyTwin());\r\n    this._sectorList.push(this.timberHearth = new TimberHearth());\r\n    this._sectorList.push(this.brittleHollow = new BrittleHollow());\r\n    this._sectorList.push(this.giantsDeep = new GiantsDeep());\r\n    this._sectorList.push(this.darkBramble = new DarkBramble());\r\n    this._sectorList.push(this.quantumMoon = new QuantumMoon());\r\n    this._sectorList.push(this.eyeOfTheUniverse = new EyeOfTheUniverse());\r\n    \r\n    this.comet.load();\r\n    this.rockyTwin.load();\r\n    this.sandyTwin.load();\r\n    this.timberHearth.load();\r\n    this.brittleHollow.load();\r\n    this.giantsDeep.load();\r\n    this.darkBramble.load();\r\n    this.quantumMoon.load();\r\n    this.eyeOfTheUniverse.load();\r\n\r\n    this.player = new Player();\r\n    this.ship = new Ship(this.player);\r\n  }\r\n\r\n  onReceiveGlobalMessage(message: Message): void\r\n  {\r\n    if (message.id === \"spawn ship\")\r\n    {\r\n      this.timberHearth.addActor(this.ship, \"\u6751\u5E84\");\r\n\r\n      // keeps player on top of ship\r\n      const tNode: OWNode = this.player.currentNode;\r\n      this.timberHearth.removeActor(this.player);\r\n      this.timberHearth.addActor(this.player, tNode);\r\n    }\r\n    else if (message.id === \"move to\")\r\n    {\r\n      const node: OWNode = this.getNodeByName(message.text);\r\n\r\n      this.player.moveToNode(node);\r\n\r\n      if (node.shipAccess)\r\n      {\r\n        this.ship.moveToNode(node);\r\n      }\r\n\r\n      feed.clear();\r\n      feed.publish(\"\u4F60\u5DF2\u62B5\u8FBE\" + node.getDescription());\r\n    }\r\n    else if (message.id === \"teleport to\")\r\n    {\r\n      for (let i: number = 0; i < this._sectorList.length; i++)\r\n      {\r\n        const teleportNode: OWNode = this._sectorList[i].getNode(message.text);\r\n\r\n        if (teleportNode != null)\r\n        {\r\n          this.player.currentSector.removeActor(this.player);\r\n          this._sectorList[i].addActor(this.player, teleportNode);\r\n          gameManager.loadSector(this._sectorList[i]);\r\n\r\n          feed.clear();\r\n          feed.publish(\"\u4F60\u5DF2\u88AB\u4F20\u9001\u81F3\" + teleportNode.getDescription());\r\n        }\r\n      }\r\n    }\r\n    else if (message.id === \"quantum moon vanished\")\r\n    {\r\n      this.player.currentSector.removeActor(this.player);\r\n      this.ship.currentSector.removeActor(this.ship);\r\n      gameManager.loadSolarSystemMap();\r\n    }\r\n  }\r\n\r\n  isPlayerInShip(): boolean\r\n  {\r\n    return(this.player.currentNode === this.ship.currentNode);\r\n  }\r\n\r\n  getNodeByName(nodeName: string): OWNode\r\n  {\r\n    for (let i: number = 0; i < this._sectorList.length; i++)\r\n    {\r\n      const node: OWNode = this._sectorList[i].getNode(nodeName);\r\n\r\n      if (node != null)\r\n      {\r\n        return node;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  \r\n  getSectorByName(sectorName: SectorName): Sector\r\n  {    \r\n    switch(sectorName)\r\n    {\r\n      case SectorName.COMET:\r\n        return this.comet;\r\n      case SectorName.ROCKY_TWIN:\r\n        return this.rockyTwin;\r\n      case SectorName.SANDY_TWIN:\r\n        return this.sandyTwin;\r\n      case SectorName.TIMBER_HEARTH:\r\n        return this.timberHearth;\r\n      case SectorName.BRITTLE_HOLLOW:\r\n        return this.brittleHollow;\r\n      case SectorName.GIANTS_DEEP:\r\n        return this.giantsDeep;\r\n      case SectorName.DARK_BRAMBLE:\r\n        return this.darkBramble;\r\n      case SectorName.QUANTUM_MOON:\r\n        return this.quantumMoon;\r\n      case SectorName.EYE_OF_THE_UNIVERSE:\r\n        return this.eyeOfTheUniverse;\r\n      default:\r\n        break;\r\n    }\r\n    return null;\r\n  }\r\n}", "import { Button } from \"./Button\";\r\nimport { Ship, Player } from \"./Entity\";\r\nimport { OWNode } from \"./Node\";\r\nimport { Sector } from \"./Sector\";\r\nimport { QuantumMoon } from \"./SectorLibrary\";\r\nimport { locator, smallFontData } from \"./app\";\r\nimport { println } from \"./compat\";\r\n\r\nexport abstract class SectorButton extends Button\r\n{\r\n  _sector: Sector;\r\n  node: OWNode;\r\n\r\n  constructor(id: string, x: number, y: number, w: number, h: number, sector: Sector)\r\n  {\r\n    super(id, x, y, w, h);\r\n    this.node = new OWNode(x, y);\r\n    this._sector = sector;\r\n  }\r\n\r\n  getRadius(): number\r\n  {\r\n    return this._bounds.y * 0.5;\r\n  }\r\n\r\n  getSector(): Sector\r\n  {\r\n    return this._sector;\r\n  }\r\n  \r\n  render(): void\r\n  {\r\n    this.drawNonHighlighted();\r\n\r\n    if (this.hoverState)\r\n    {\r\n      strokeWeight(2);\r\n    }\r\n    \r\n    this.drawPlanet();\r\n    this.drawYouAreHere();\r\n    \r\n    strokeWeight(1);\r\n  }\r\n  \r\n  abstract drawPlanet(): void;\r\n\r\n  drawNonHighlighted(): void{}\r\n  \r\n  drawName(name?: string, xPos?: number): void\r\n  {\r\n    fill(0, 0, 100);\r\n    textAlign(CENTER, CENTER);\r\n    textSize(18);\r\n    text(name ?? this.id, xPos ?? this.screenPosition.x, this.screenPosition.y - this.getRadius() - 40);\r\n  }\r\n\r\n  drawYouAreHere(): void\r\n  {\r\n    if (locator.ship.currentSector == this._sector)\r\n    {\r\n      (locator.ship as Ship).drawAt(this.screenPosition.x, this.screenPosition.y, 0.5, true);\r\n    }\r\n\r\n    if (locator.player.currentSector == this._sector)\r\n    {\r\n      (locator.player as Player).drawAt(this.screenPosition.x, this.screenPosition.y, 0.5);\r\n    }\r\n  }\r\n\r\n  drawZoomPrompt(): void\r\n  {\r\n    textSize(14);\r\n    textFont(smallFontData);\r\n\r\n    fill(0, 0, 0);\r\n    stroke(0, 0, 100);\r\n    rectMode(CENTER);\r\n    rect(this.screenPosition.x, this.screenPosition.y + this.getRadius() + 40, textWidth(\"\u5DE6\u952E\u653E\u5927\") + 10, 20);\r\n\r\n    fill(0, 0, 100);\r\n    textAlign(CENTER, CENTER);\r\n    text(\"\u5DE6\u952E\u653E\u5927\", this.screenPosition.x, this.screenPosition.y + this.getRadius() + 40);\r\n  }\r\n}\r\n\r\nexport class CometButton extends SectorButton\r\n{\r\n  constructor(x: number, y: number, sector: Sector)\r\n  {\r\n    super(\"\u5F57\u661F\", x, y, 40, 40, sector);\r\n  }\r\n  \r\n  drawPlanet(): void\r\n  {\r\n    noStroke();\r\n    fill(0, 0, 0);\r\n\r\n    push();\r\n      translate(this.screenPosition.x, this.screenPosition.y);\r\n      triangle(0, this.getRadius(), 0, -this.getRadius(), 130, 0);\r\n      stroke(200, 30, 100);\r\n      arc(0, 0, this._bounds.y, this._bounds.y, PI * 0.5, PI * 1.5);\r\n      line(0, this._bounds.y * 0.5, 130, 0);\r\n      line(0, -this._bounds.y * 0.5, 130, 0);\r\n    pop();\r\n  }\r\n}\r\n\r\nexport class HourglassTwinsButton extends SectorButton\r\n{\r\n  _centerX: number;\r\n  _isRightTwin: boolean = false;\r\n  _twinName: string;\r\n\r\n  constructor(centerX: number, y: number, isRightTwin: boolean, sector: Sector)\r\n  {\r\n    super(\"\u70EC\u53CC\u661F\", centerX, y, 50, 50, sector);\r\n    this._isRightTwin = isRightTwin;\r\n    this._centerX = centerX;\r\n    \r\n    if (isRightTwin) \r\n    {\r\n      this._twinName = \"\u7070\";\r\n      this.setPosition(centerX + 35, this.position.y);\r\n    }\r\n    else\r\n    {\r\n      this._twinName = \"\u4F59\";\r\n      this.setPosition(centerX - 35, this.position.y);\r\n    }\r\n  }\r\n\r\n  drawName(): void\r\n  {\r\n    super.drawName(this._twinName + this.id, this._centerX);\r\n  }\r\n\r\n  drawNonHighlighted(): void\r\n  {\r\n    if (!this._isRightTwin)\r\n    {\r\n      stroke(60, 100, 100);\r\n      fill(0, 0, 0);\r\n      rectMode(CENTER);\r\n      rect(this._centerX, this.position.y, this._bounds.y * 1.5, this._bounds.y * 0.2);\r\n    }\r\n  }\r\n  \r\n  drawPlanet(): void\r\n  {\r\n    stroke(60, 100, 100);\r\n    fill(0, 0, 0);    \r\n    ellipse(this.position.x, this.position.y, this._bounds.y, this._bounds.y);\r\n  }\r\n}\r\n\r\nexport class TimberHearthButton extends SectorButton\r\n{\r\n  constructor(x: number, y: number, sector: Sector)\r\n  {\r\n    super(\"\u6728\u7076\u661F\", x, y, 80, 80, sector);\r\n  }\r\n  \r\n  drawPlanet(): void\r\n  {\r\n    stroke(200, 100, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(this.position.x, this.position.y, this._bounds.x, this._bounds.y);\r\n  }\r\n}\r\n\r\nexport class BrittleHollowButton extends SectorButton\r\n{\r\n  constructor(x: number, y: number, sector: Sector)\r\n  {\r\n    super(\"\u788E\u7A7A\u661F\", x, y, 80, 80, sector);\r\n  }\r\n  \r\n  drawPlanet(): void\r\n  {\r\n    stroke(0, 100, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(this.position.x, this.position.y, this._bounds.x, this._bounds.y);\r\n  }\r\n}\r\n\r\nexport class GiantsDeepButton extends SectorButton\r\n{\r\n  constructor(x: number, y: number, sector: Sector)\r\n  {\r\n    super(\"\u6DF1\u5DE8\u661F\", x, y, 150, 150, sector);\r\n  }\r\n  \r\n  drawPlanet(): void\r\n  {\r\n    stroke(180, 100, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(this.position.x, this.position.y, this._bounds.x, this._bounds.y);\r\n  }\r\n}\r\n\r\nexport class DarkBrambleButton extends SectorButton\r\n{\r\n  constructor(x: number, y: number, sector: Sector)\r\n  {\r\n    super(\"\u9ED1\u8346\u661F\", x, y, 230, 230, sector);\r\n  }\r\n  \r\n  drawPlanet(): void\r\n  {\r\n    stroke(120, 100, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(this.position.x, this.position.y, this._bounds.x, this._bounds.y);\r\n  }\r\n}\r\n\r\nexport class QuantumMoonButton extends SectorButton\r\n{\r\n  _currentTarget: SectorButton;\r\n  _targets: SectorButton[];\r\n\r\n  constructor(targets: SectorButton[], sector: Sector)\r\n  {\r\n    super(\"\u91CF\u5B50\u536B\u661F\", 0, 0, 30, 30, sector);\r\n    this._targets = targets;\r\n  }\r\n\r\n  collapse(): void\r\n  {\r\n    (this._sector as QuantumMoon).collapse();\r\n    this.updatePosition();\r\n  }\r\n\r\n  updatePosition(): void\r\n  {\r\n    const i: number = (this._sector as QuantumMoon).getQuantumLocation();\r\n\r\n    println(i);\r\n\r\n    if (i == 4)\r\n    {\r\n      this._currentTarget = null;\r\n    }\r\n    else\r\n    {\r\n      this._currentTarget = this._targets[i];\r\n    }\r\n\r\n    if (this._currentTarget != null)\r\n    {\r\n      this.setPosition(this._currentTarget.position.x - 25, this._currentTarget.position.y - this._currentTarget.getRadius() - 30);\r\n    }\r\n    else\r\n    {\r\n      this.setPosition(-1000, -1000);\r\n    }\r\n  }\r\n  \r\n  drawPlanet(): void\r\n  {\r\n    stroke(300, 50, 100);\r\n    fill(0, 0, 0);\r\n    ellipse(this.position.x, this.position.y, this._bounds.x, this._bounds.y);\r\n  }\r\n}", "import { Button } from \"./Button\";\r\nimport { Actor } from \"./Entity\";\r\nimport { OWScreen } from \"./Screen\";\r\nimport { Sector } from \"./Sector\";\r\nimport { SectorButton, QuantumMoonButton, HourglassTwinsButton, TimberHearthButton, BrittleHollowButton, GiantsDeepButton, DarkBrambleButton, CometButton } from \"./SectorButtons\";\r\nimport { SolarSystem } from \"./SolarSystem\";\r\nimport { Telescope, SignalSource, FrequencyButton } from \"./Telescope\";\r\nimport { Vector2 } from \"./Vector2\";\r\nimport { gameManager, feed, timeLoop } from \"./app\";\r\n\r\nexport class SolarSystemScreen extends OWScreen\r\n{\r\n  _player: Actor;\r\n  _ship: Actor;\r\n  _solarSystem: SolarSystem;\r\n    \r\n  _cometButton: SectorButton;\r\n  _hourglassButton_left: SectorButton;\r\n  _hourglassButton_right: SectorButton;\r\n  _timberButton: SectorButton;\r\n  _brittleButton: SectorButton;\r\n  _giantsButton: SectorButton;\r\n  _darkButton: SectorButton;\r\n  _quantumButton: QuantumMoonButton;\r\n\r\n  _focusSectorButton: SectorButton;\r\n\r\n  _sectorButtons: SectorButton[];\r\n  \r\n  constructor(solarSystem: SolarSystem)\r\n  {\r\n    super();\r\n    \r\n    this._solarSystem = solarSystem;\r\n    this._player = solarSystem.player;\r\n    this._ship = solarSystem.ship;\r\n\r\n    this._sectorButtons = new Array<SectorButton>();\r\n    const buttonHeight: number = height / 2;\r\n\r\n    this._sectorButtons.push(this._hourglassButton_left = new HourglassTwinsButton(170, buttonHeight, false, this._solarSystem.rockyTwin));\r\n    this._sectorButtons.push(this._hourglassButton_right = new HourglassTwinsButton(170, buttonHeight, true, this._solarSystem.sandyTwin));\r\n    this._sectorButtons.push(this._timberButton = new TimberHearthButton(300, buttonHeight, this._solarSystem.timberHearth));\r\n    this._sectorButtons.push(this._brittleButton = new BrittleHollowButton(420, buttonHeight, this._solarSystem.brittleHollow));\r\n    this._sectorButtons.push(this._giantsButton = new GiantsDeepButton(580, buttonHeight, this._solarSystem.giantsDeep));\r\n    this._sectorButtons.push(this._darkButton = new DarkBrambleButton(810, buttonHeight, this._solarSystem.darkBramble));\r\n    this._sectorButtons.push(this._cometButton = new CometButton(600, buttonHeight + 200, this._solarSystem.comet));\r\n\r\n    const targets: SectorButton[] = [this._hourglassButton_right, this._timberButton, this._brittleButton, this._giantsButton];\r\n    this._sectorButtons.push(this._quantumButton = new QuantumMoonButton(targets, this._solarSystem.quantumMoon));\r\n\r\n    for (let i: number = 0; i < this._sectorButtons.length; i++)\r\n    {\r\n      this.addButton(this._sectorButtons[i]);\r\n    }\r\n  }\r\n\r\n  onEnter(): void\r\n  {\r\n    this._quantumButton.collapse();\r\n  }\r\n\r\n  update(): void {}\r\n  \r\n  render(): void\r\n  {\r\n    // draw sun\r\n    stroke(40, 100, 100);\r\n    fill(0, 0, 0);\r\n    //fill(20, 100, 100);\r\n    ellipse(-430, height/2, 1000, 1000);\r\n\r\n    if (this._ship.currentSector == null)\r\n    {\r\n      this._ship.render();\r\n    }\r\n    if (this._player.currentSector == null)\r\n    {\r\n      this._player.render();\r\n    }\r\n  }\r\n\r\n  onButtonEnterHover(button: Button): void\r\n  {\r\n    if (this._sectorButtons.includes(button as SectorButton))\r\n    {\r\n      this._focusSectorButton = button as SectorButton;\r\n    }\r\n  }\r\n\r\n  onButtonExitHover(button: Button): void\r\n  {\r\n    if (button === this._focusSectorButton)\r\n    {\r\n      this._focusSectorButton = null;\r\n    }\r\n  }\r\n  \r\n  onButtonUp(button: Button): void\r\n  { \r\n    /** SECTOR SELECTION **/\r\n    if (this._sectorButtons.includes(button as SectorButton))\r\n    {\r\n      this.selectSector((button as SectorButton).getSector());\r\n    }\r\n  }\r\n  \r\n  selectSector(selectedSector: Sector): void {}\r\n\r\n  getSectorScreenPosition(sector: Sector): Vector2\r\n  {\r\n    for (let i: number = 0; i < this._sectorButtons.length; i++)\r\n    {\r\n      if (this._sectorButtons[i].getSector() == sector)\r\n      {\r\n        return this._sectorButtons[i].screenPosition;\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n}\r\n\r\nexport class SolarSystemTelescopeScreen extends SolarSystemScreen\r\n{\r\n  _telescope: Telescope;\r\n  _exitButton: Button;\r\n  _nextFrequency: Button;\r\n  _previousFrequency: Button;\r\n\r\n  _signalSources: SignalSource[];\r\n\r\n  constructor(solarSystem: SolarSystem, telescope: Telescope)\r\n  {\r\n    super(solarSystem);\r\n    \r\n    this.addButton(this._nextFrequency = new FrequencyButton(true));\r\n    this.addButton(this._previousFrequency = new FrequencyButton(false));\r\n\r\n    this.addButtonToToolbar(this._exitButton = new Button(\"\u9000\u51FA\", 0, 0, 150, 50));\r\n\r\n    this._telescope = telescope;\r\n  }\r\n\r\n  onEnter(): void\r\n  {\r\n    super.onEnter();\r\n    noCursor();\r\n\r\n    // must do this after quantum moon collapses\r\n    this._signalSources = new Array<SignalSource>();\r\n    this._signalSources.push(new SignalSource(this._cometButton.screenPosition, this._cometButton.getSector()));\r\n    this._signalSources.push(new SignalSource(this._hourglassButton_left.screenPosition, this._hourglassButton_left.getSector()));\r\n    this._signalSources.push(new SignalSource(this._timberButton.screenPosition, this._timberButton.getSector()));\r\n    this._signalSources.push(new SignalSource(this._brittleButton.screenPosition, this._brittleButton.getSector()));\r\n    this._signalSources.push(new SignalSource(this._giantsButton.screenPosition, this._giantsButton.getSector()));\r\n    this._signalSources.push(new SignalSource(this._darkButton.screenPosition, this._darkButton.getSector()));\r\n    this._signalSources.push(new SignalSource(this._quantumButton.screenPosition, this._quantumButton.getSector()));\r\n  }\r\n\r\n  onExit(): void\r\n  {\r\n    cursor(HAND);\r\n  }\r\n\r\n  update(): void\r\n  {\r\n    super.update();\r\n    this._telescope.update(this._signalSources);\r\n  }\r\n\r\n  render(): void\r\n  {\r\n    super.render();\r\n    this._telescope.render();\r\n\r\n    if (this._focusSectorButton != null)\r\n    {\r\n      this._focusSectorButton.drawName();\r\n    }\r\n\r\n    if (this._focusSectorButton != null)\r\n    {\r\n      this._focusSectorButton.drawZoomPrompt();\r\n    }\r\n  }\r\n\r\n  selectSector(selectedSector: Sector): void\r\n  {\r\n    gameManager.loadSectorTelescopeView(selectedSector);\r\n  }\r\n\r\n  onButtonUp(button: Button): void\r\n  {\r\n    super.onButtonUp(button);\r\n\r\n    if (button == this._exitButton)\r\n    {\r\n      gameManager.popScreen();\r\n    }\r\n    else if (button == this._nextFrequency)\r\n    {\r\n      this._telescope.nextFrequency();\r\n    }\r\n    else if (button == this._previousFrequency)\r\n    {\r\n      this._telescope.previousFrequency();\r\n    }\r\n  }\r\n}\r\n\r\nexport class SolarSystemMapScreen extends SolarSystemScreen\r\n{\r\n  _databaseButton: Button;\r\n  _telescopeButton: Button;\r\n\r\n  constructor(solarSystem: SolarSystem)\r\n  {\r\n    super(solarSystem);\r\n    this.addButtonToToolbar(this._databaseButton = new Button(\"\u67E5\u770B\u6570\u636E\u5E93\", 0, 0, 150, 50));\r\n    this.addButtonToToolbar(this._telescopeButton = new Button(\"\u626B\u63CF\u4FE1\u53F7\", 0, 0, 150, 50));\r\n  }\r\n\r\n  render(): void\r\n  {\r\n    super.render();\r\n\r\n    if (this._focusSectorButton != null)\r\n    {\r\n      this._focusSectorButton.drawName();\r\n    }\r\n\r\n    feed.render();\r\n    timeLoop.renderTimer();\r\n  }\r\n\r\n  onEnter(): void\r\n  {\r\n    super.onEnter();\r\n    this.setActorPosition(this._player);\r\n    this.setActorPosition(this._ship);\r\n  }\r\n\r\n  setActorPosition(actor: Actor): void\r\n  {\r\n    const idlePos: Vector2 = new Vector2(200, height - 200);\r\n\r\n    // set player position\r\n    if (actor.lastSector != null)\r\n    {\r\n      actor.setScreenPosition(this.getSectorScreenPosition(actor.lastSector));\r\n    }\r\n    else\r\n    {\r\n      actor.setScreenPosition(idlePos);\r\n    }\r\n\r\n    actor.moveToScreenPosition(idlePos);\r\n    actor.lastSector = null;\r\n  }\r\n\r\n  update(): void\r\n  {\r\n    this._player.update();\r\n    this._ship.update();\r\n  }\r\n\r\n  onButtonUp(button: Button): void\r\n  {\r\n    /** OPEN DATABASE **/\r\n    if (button == this._databaseButton)\r\n    {\r\n      gameManager.pushScreen(gameManager.databaseScreen);\r\n    }\r\n    else if (button == this._telescopeButton)\r\n    {\r\n      gameManager.loadTelescopeView();\r\n    }\r\n\r\n    super.onButtonUp(button);\r\n  }\r\n\r\n  selectSector(selectedSector: Sector): void\r\n  {\r\n    const nextSector: Sector = selectedSector;\r\n    \r\n    // check if the player is already in a Sector...if not, fly to that Sector\r\n    if (this._solarSystem.ship.currentSector == null)\r\n    {\r\n      nextSector.addActor(this._solarSystem.ship);\r\n    }\r\n    \r\n    // check if the ship is already in a Sector...if not fly to that Sector\r\n    if (this._solarSystem.player.currentSector == null)\r\n    {\r\n      nextSector.addActor(this._solarSystem.player);\r\n    }\r\n\r\n    gameManager.loadSector(nextSector);\r\n    nextSector.onArrival();\r\n  }\r\n}", "import { Button } from \"./Button\";\r\nimport { OWScreen } from \"./Screen\";\r\nimport { feed, playerData, gameManager } from \"./app\";\r\n\r\nexport class SupernovaScreen extends OWScreen\r\n{\r\n  initTime: number = 0;\r\n  collapseTime: number;\r\n  supernovaTime: number;\r\n  collapsePercent: number = 0;\r\n  supernovaPercent: number = 0;\r\n\r\n  static SUN_SIZE: number = 300;\r\n  static COLLAPSE_DURATION: number = 2000;\r\n\r\n  static SUPERNOVA_SIZE: number = 2000;\r\n  static SUPERNOVA_DURATION: number = 2000;\r\n\r\n  constructor()\r\n  {\r\n    super();\r\n  }\r\n  \r\n  onEnter(): void\r\n  {\r\n    this.initTime = millis();\r\n    this.collapseTime = this.initTime + 1 * 500;\r\n    this.supernovaTime = this.collapseTime + SupernovaScreen.COLLAPSE_DURATION;\r\n\r\n    feed.clear();\r\n    feed.publish(\"\u592A\u9633\u6B63\u5728\u6F14\u5316\u4E3A\u8D85\u65B0\u661F\uFF01\", true);\r\n  }\r\n  \r\n  onExit(): void {}\r\n  \r\n  update(): void\r\n  {\r\n    this.collapsePercent = constrain((millis() - this.collapseTime) / SupernovaScreen.COLLAPSE_DURATION, 0, 1);\r\n    this.collapsePercent = this.collapsePercent * this.collapsePercent * this.collapsePercent;\r\n\r\n    this.supernovaPercent = constrain((millis() - this.supernovaTime) / SupernovaScreen.SUPERNOVA_DURATION, 0, 1);\r\n    this.supernovaPercent = this.supernovaPercent * this.supernovaPercent;\r\n\r\n    if (this.supernovaPercent == 1)\r\n    {\r\n      playerData.killPlayer();\r\n    }\r\n  }\r\n  \r\n  render(): void\r\n  {\r\n    push();\r\n    translate(width/2, height/2);\r\n\r\n      // draw supernova\r\n      noStroke();\r\n      fill(300 * this.supernovaPercent, 100, 100);\r\n      ellipse(0, 0, 5 + SupernovaScreen.SUPERNOVA_SIZE * this.supernovaPercent, 5 + SupernovaScreen.SUPERNOVA_SIZE * this.supernovaPercent * (1 - this.supernovaPercent * 0.5));\r\n\r\n      // draw sun\r\n      if (this.collapsePercent < 1)\r\n      {\r\n        stroke(40, 100, 100);\r\n        fill(0, 0, 0);\r\n        ellipse(0, 0, SupernovaScreen.SUN_SIZE * (1 - this.collapsePercent), SupernovaScreen.SUN_SIZE * (1 - this.collapsePercent));\r\n      }\r\n\r\n    pop();\r\n\r\n    feed.render();\r\n  }\r\n  \r\n  onButtonUp(button: Button): void {}\r\n}\r\n\r\nexport class FlashbackScreen extends OWScreen\r\n{\r\n  initTime: number = 0;\r\n  lastSpawnTime: number = 0;\r\n  flashbackPercent: number = 0;\r\n\r\n  _ringSizes: number[];\r\n\r\n  static FLASHBACK_DURATION: number = 2200;\r\n\r\n  constructor()\r\n  {\r\n    super();\r\n\r\n    this._ringSizes = new Array<number>();\r\n  }\r\n  \r\n  onEnter(): void\r\n  {\r\n    this.initTime = millis();\r\n\r\n    feed.clear();\r\n    feed.publish(\"?!gnineppah s'tahW\", true);\r\n  }\r\n  \r\n  onExit(): void\r\n  {\r\n\r\n  }\r\n  \r\n  update(): void\r\n  {\r\n    if (millis() - this.lastSpawnTime > 50 && random(1) > 0.3)\r\n    {\r\n      this.lastSpawnTime = millis();\r\n      this._ringSizes.push(5.0);\r\n    }\r\n\r\n    for (let i: number = 0; i < this._ringSizes.length; i++)\r\n    {\r\n      this._ringSizes[i] = this._ringSizes[i] + this._ringSizes[i] * 0.1 + 0.5;\r\n    }\r\n\r\n    if (this.getFlashBackPercent() == 1)\r\n    {\r\n      gameManager.resetTimeLoop();\r\n    }\r\n  }\r\n\r\n  getFlashBackPercent(): number\r\n  {\r\n    return constrain((millis() - this.initTime) / FlashbackScreen.FLASHBACK_DURATION, 0, 1);\r\n  }\r\n  \r\n  render(): void\r\n  {\r\n    push();\r\n    translate(width/2, height/2);\r\n\r\n      for (let i: number = 0; i < this._ringSizes.length; i++)\r\n      {\r\n        stroke(0, 0, 100);\r\n        noFill();\r\n        ellipse(0, 0, this._ringSizes[i], this._ringSizes[i]);\r\n      }\r\n\r\n    pop();\r\n\r\n    const fadeAlpha: number = constrain((this.getFlashBackPercent() - 0.9) / 0.1, 0, 1);\r\n    fill(0, 0, 100, fadeAlpha * 100);\r\n    rectMode(CORNER);\r\n    rect(0, 0, width, height);\r\n\r\n    feed.render();\r\n  }\r\n  \r\n  onButtonUp(button: Button): void {}\r\n}\r\n\r\nexport class GameOverScreen extends OWScreen\r\n{\r\n  constructor()\r\n  {\r\n    super();\r\n    this.addButtonToToolbar(new Button(\"\u518D\u6B21\u5C1D\u8BD5\"));\r\n  }\r\n\r\n  update(): void {}\r\n\r\n  render(): void\r\n  {\r\n    fill(0, 90, 90);\r\n    textAlign(CENTER, CENTER);\r\n    textSize(100);\r\n    text(\"\u4F60\u6B7B\u4E86\", width/2, height/2);\r\n  }\r\n\r\n  onButtonUp(button: Button): void\r\n  {\r\n    gameManager.resetTimeLoop();\r\n  }\r\n}", "import { DatabaseScreen } from \"./DatabaseScreen\";\r\nimport { SectorName } from \"./Enums\";\r\nimport { DeathByAnglerfishScreen, DiveAttemptScreen, FollowTheVineScreen, AncientVesselScreen, TimeLoopCentralScreen, EyeOfTheUniverseScreen, BrambleOutskirtsScreen } from \"./EventScreen\";\r\nimport { GlobalObserver, Message } from \"./GlobalMessenger\";\r\nimport { Locator } from \"./Locator\";\r\nimport { ScreenManager } from \"./ScreenManager\";\r\nimport { Sector } from \"./Sector\";\r\nimport { SectorScreen } from \"./SectorScreen\";\r\nimport { SectorTelescopeScreen } from \"./SectorTelescopeScreen\";\r\nimport { SolarSystem } from \"./SolarSystem\";\r\nimport { SolarSystemMapScreen, SolarSystemTelescopeScreen } from \"./SolarSystemScreen\";\r\nimport { FlashbackScreen, GameOverScreen } from \"./SupernovaScreen\";\r\nimport { Telescope } from \"./Telescope\";\r\nimport { TitleScreen } from \"./TitleScreen\";\r\nimport { messenger, feed, timeLoop, playerData, locator, resetLocator } from \"./app\";\r\n\r\nexport class GameManager extends ScreenManager implements GlobalObserver\r\n{\r\n  // game screens\r\n  titleScreen: TitleScreen;\r\n  databaseScreen: DatabaseScreen;\r\n  solarSystemMapScreen: SolarSystemMapScreen;\r\n  \r\n  // game objects\r\n  _solarSystem: SolarSystem;\r\n  _telescope: Telescope;\r\n\r\n  _flashbackTriggered: boolean = false;\r\n  \r\n  newGame(): void\r\n  {\r\n    this.setupSolarSystem();\r\n\r\n    this.titleScreen = new TitleScreen();\r\n    this.databaseScreen = new DatabaseScreen();\r\n    \r\n    this.pushScreen(this.titleScreen);\r\n  }\r\n\r\n  resetTimeLoop(): void\r\n  {\r\n    this._flashbackTriggered = false;\r\n    this._screenStack.length = 0;\r\n    this.setupSolarSystem();\r\n    this.loadSector(SectorName.TIMBER_HEARTH);\r\n  }\r\n\r\n  setupSolarSystem(): void\r\n  {\r\n    messenger.removeAllObservers();\r\n    messenger.addObserver(this);\r\n\r\n    feed.init();\r\n    timeLoop.init();\r\n    playerData.init();\r\n\r\n    this._telescope = new Telescope();\r\n\r\n    this._solarSystem = new SolarSystem();\r\n    this._solarSystem.timberHearth.addActor(this._solarSystem.player, \"\u6751\u5E84\");\r\n\r\n    this.solarSystemMapScreen = new SolarSystemMapScreen(this._solarSystem);\r\n\r\n    if (playerData.knowsLaunchCodes())\r\n    {\r\n      messenger.sendMessage(\"spawn ship\");\r\n    }\r\n\r\n    resetLocator();\r\n  }\r\n\r\n  // runs after everything else updates\r\n  lateUpdate(): void\r\n  {\r\n    // check if the sun explodes (this check has to be last to override all other screens)\r\n    timeLoop.lateUpdate();\r\n\r\n    // check if the player died\r\n    if (playerData.isPlayerDead() && !this._flashbackTriggered)\r\n    {\r\n      this._flashbackTriggered = true;\r\n\r\n      if (timeLoop.getEnabled())\r\n      {\r\n        this.swapScreen(new FlashbackScreen());\r\n      }\r\n      else\r\n      {\r\n        this.swapScreen(new GameOverScreen());\r\n      }\r\n    }\r\n  }\r\n\r\n  onReceiveGlobalMessage(message: Message): void\r\n  {\r\n    // TRIGGERED FROM SECTORSCREEN (NOT EXPLORE SCREEN)\r\n    if (message.id === \"death by anglerfish\")\r\n    {\r\n      this.pushScreen(new DeathByAnglerfishScreen());\r\n    }\r\n    else if (message.id === \"dive attempt\")\r\n    {\r\n      this.pushScreen(new DiveAttemptScreen());\r\n    }\r\n    // TRIGGERED FROM EVENT SCREEN\r\n    else if (message.id === \"follow the vine\")\r\n    {\r\n      this.swapScreen(new FollowTheVineScreen());\r\n    }\r\n    // TRIGGERED FROM EXPLORE DATA\r\n    else if (message.id === \"explore ancient vessel\")\r\n    {\r\n      this.swapScreen(new AncientVesselScreen());\r\n    }\r\n    else if (message.id === \"time loop central\")\r\n    {\r\n      this.swapScreen(new TimeLoopCentralScreen());\r\n    }\r\n    else if (message.id === \"older than the universe\")\r\n    {\r\n      this.swapScreen(new EyeOfTheUniverseScreen());\r\n    }\r\n    else if (message.id === \"explore bramble outskirts\")\r\n    {\r\n      this.swapScreen(new BrambleOutskirtsScreen());\r\n    }\r\n  }\r\n\r\n  loadTelescopeView(): void\r\n  {\r\n    this.pushScreen(new SolarSystemTelescopeScreen(this._solarSystem, this._telescope));\r\n\r\n    // if (_solarSystem.player.currentSector != null)\r\n    // {\r\n    //   loadSectorTelescopeView(_solarSystem.player.currentSector);\r\n    // }\r\n  }\r\n\r\n  loadSectorTelescopeView(sector: Sector): void\r\n  {\r\n    this.pushScreen(new SectorTelescopeScreen(sector, this._telescope));\r\n  }\r\n  \r\n  loadSolarSystemMap(): void\r\n  {\r\n    this.swapScreen(this.solarSystemMapScreen);\r\n  }\r\n  \r\n  loadSector(sectorName: SectorName): void\r\n  loadSector(sector: Sector): void\r\n  loadSector(sectorOrName: Sector | SectorName): void\r\n  {\r\n    const sector = sectorOrName instanceof Sector ? sectorOrName : this._solarSystem.getSectorByName(sectorOrName)\r\n    this.swapScreen(new SectorScreen(sector, this._solarSystem.player, this._solarSystem.ship));\r\n  }\r\n}", "import { Actor } from \"./Entity\";\r\nimport { QuantumMoon } from \"./SectorLibrary\";\r\nimport { gameManager } from \"./app\";\r\n\r\nexport class Locator\r\n{\r\n\tplayer: Actor;\r\n\tship: Actor;\r\n\r\n\t_quantumSector: QuantumMoon;\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tthis.player = gameManager._solarSystem.player;\r\n\t\tthis.ship = gameManager._solarSystem.ship;\r\n\t\tthis._quantumSector = gameManager._solarSystem.quantumMoon as QuantumMoon;\r\n\t}\r\n\r\n\tgetQuantumMoonLocation(): number\r\n\t{\r\n\t\treturn this._quantumSector.getQuantumLocation();\r\n\t}\r\n}", "import { Color } from \"p5\";\r\nimport { mediumFontData, messenger, smallFontData } from \"./app\";\r\nimport { GlobalObserver, Message } from \"./GlobalMessenger\";\r\n\r\nexport class StatusFeed implements GlobalObserver\r\n{\r\n  static MAX_LINES: number = 3;\r\n  \r\n  _feed: StatusLine[];\r\n\r\n  init(): void\r\n  {\r\n    this._feed = new Array<StatusLine>();\r\n    messenger.addObserver(this);\r\n  }\r\n\r\n  clear(): void\r\n  {\r\n    this._feed.length = 0;\r\n  }\r\n\r\n  onReceiveGlobalMessage(message: Message): void\r\n  {\r\n\r\n  }\r\n\r\n  publish(newLine: string, important: boolean = false): void\r\n  {\r\n    this._feed.push(new StatusLine(newLine, important));\r\n\r\n    if (this._feed.length > StatusFeed.MAX_LINES)\r\n    {\r\n      this._feed.splice(0, 1);\r\n    }\r\n  }\r\n  \r\n  render(): void\r\n  {\r\n    for (let i: number = 0; i < this._feed.length; i++)\r\n    {\r\n      if (!this._feed[i].draw(20, 30 + i * 25))\r\n      {\r\n        break; // break if the current line hasn't finished displaying\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport class StatusLine\r\n{\r\n  _line: string;\r\n  _initTime: number;\r\n  _displayTriggered: boolean = false;\r\n  _lineColor: Color = color(0, 0, 100);\r\n\r\n  static SPEED: number = 0.08;\r\n\r\n  constructor(newLine: string, important: boolean)\r\n  {\r\n    this._line = newLine;\r\n\r\n    if (important)\r\n    {\r\n      this._lineColor = color(100, 100, 100);\r\n    }\r\n  }\r\n\r\n  draw(x: number, y: number): boolean\r\n  {\r\n    if (!this._displayTriggered)\r\n    {\r\n      this._initTime = millis();\r\n      this._displayTriggered = true;\r\n    }\r\n\r\n    textAlign(LEFT);\r\n    textFont(mediumFontData);\r\n    textSize(18);\r\n    fill(this._lineColor);\r\n    text(this._line.substring(0, min(this._line.length, this.getDisplayLength())), x, y);\r\n    textFont(smallFontData);\r\n\r\n    // is this line fully displayed?\r\n    if (this._line.length <= this.getDisplayLength())\r\n    {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  getDisplayLength(): number\r\n  {\r\n    return (int)((millis() - this._initTime) * StatusLine.SPEED);\r\n  }\r\n}", "import { GlobalObserver, Message } from \"./GlobalMessenger\";\r\nimport { SupernovaScreen } from \"./SupernovaScreen\";\r\nimport { feed, messenger, gameManager, playerData } from \"./app\";\r\n\r\nexport class TimeLoop implements GlobalObserver\r\n{\r\n\tstatic ACTION_POINTS_PER_LOOP: number = 15;\r\n\t_actionPoints: number;\r\n\r\n\t_isTimeLoopEnabled: boolean;\r\n\t_triggerSupernova: boolean;\r\n\r\n\tinit(): void\r\n\t{\r\n\t\tthis._actionPoints = TimeLoop.ACTION_POINTS_PER_LOOP;\r\n\t\tthis._isTimeLoopEnabled = true;\r\n\t\tthis._triggerSupernova = false;\r\n\t\t\r\n\t\tfeed.publish(\"\u4F60\u5728\u6751\u5E84\u53D1\u5C04\u5854\u4E0B\u7684\u7BDD\u706B\u65C1\u9192\u6765\u3002\u4ECA\u5929\u662F\u4E2A\u5927\u65E5\u5B50\uFF01\");\r\n\t\tfeed.publish(\"\u5728\u5929\u4E0A\uFF0C\u4F60\u6CE8\u610F\u5230\u4E00\u4E2A\u660E\u4EAE\u7684\u7269\u4F53\u6B63\u4ECE\u6DF1\u5DE8\u661F\u98DE\u79BB...\", true);\r\n\r\n\t\tmessenger.addObserver(this);\r\n\t}\r\n\r\n\tonReceiveGlobalMessage(message: Message): void\r\n\t{\r\n\t\tif (message.id === \"\u5173\u95ED\u65F6\u95F4\u5FAA\u73AF\" && this._isTimeLoopEnabled)\r\n\t\t{\r\n\t\t\tthis._isTimeLoopEnabled = false;\r\n\t\t\tfeed.publish(\"\u4F60\u5173\u95ED\u4E86\u65F6\u95F4\u5FAA\u73AF\u88C5\u7F6E\", true);\r\n\t\t}\r\n\t}\r\n\r\n\tlateUpdate(): void\r\n\t{\r\n\t\tif (this._triggerSupernova)\r\n\t\t{\r\n\t\t\tthis._triggerSupernova = false;\r\n\t\t\tgameManager.swapScreen(new SupernovaScreen());\r\n\t\t}\r\n\t}\r\n\r\n\tgetEnabled(): boolean\r\n\t{\r\n\t\treturn this._isTimeLoopEnabled;\r\n\t}\r\n\r\n\tgetLoopPercent(): number\r\n\t{\r\n\t\treturn (TimeLoop.ACTION_POINTS_PER_LOOP - this._actionPoints) / TimeLoop.ACTION_POINTS_PER_LOOP;\r\n\t}\r\n\r\n\tgetActionPoints(): number\r\n\t{\r\n\t\treturn this._actionPoints;\r\n\t}\r\n\r\n\twaitFor(minutes: number): void\r\n\t{\r\n\t\tfeed.publish(\"\u4F60\u7B49\u5F85\u4E86 1 \u5206\u949F\", true);\r\n\t\tthis.spendActionPoints(minutes);\r\n\t}\r\n\r\n\tspendActionPoints(points: number): void\r\n\t{\r\n\t\tif (playerData.isPlayerAtEOTU()) {return;}\r\n\t\t\r\n\t\tconst lastActionPoints: number = this._actionPoints;\r\n\r\n\t\tthis._actionPoints = max(0, this._actionPoints - points);\r\n\t\tmessenger.sendMessage(\"action points spent\");\r\n\r\n\t\t// detect when you have 1/4 your action points remaining\r\n\t\tif (lastActionPoints > TimeLoop.ACTION_POINTS_PER_LOOP * 0.25 && this._actionPoints <= TimeLoop.ACTION_POINTS_PER_LOOP * 0.25)\r\n\t\t{\r\n\t\t\tfeed.publish(\"\u4F60\u6CE8\u610F\u5230\u592A\u9633\u6B63\u53D8\u5F97\u53C8\u5927\u53C8\u7EA2\uFF0C\u5341\u5206\u7CDF\u7CD5\", true);\r\n\t\t}\r\n\r\n\t\tif (this._actionPoints == 0)\r\n\t\t{\r\n\t\t\tthis._triggerSupernova = true;\r\n\t\t}\r\n\t}\r\n\r\n\trenderTimer(): void\r\n\t{\r\n\t\tif (playerData.isPlayerAtEOTU()) {return;}\r\n\r\n\t\tconst r: number = 50;\r\n\t\tconst x: number = 50;\r\n\t\tconst y: number = height - 50;\r\n\r\n\t\tstroke(0, 0, 100);\r\n\t\tfill(0, 0, 0);\r\n\t\tellipse(x, y, r, r);\r\n\t\tfill(30, 100, 100);\r\n\t\tarc(x, y, r, r, 0 - PI * 0.5 + TAU * this.getLoopPercent(), 1.5 * PI);\r\n\t\t// fill(0, 0, 100);\r\n\t\t// textSize(20);\r\n\t\t// textAlign(RIGHT, TOP);\r\n\t\t// text(\"Time Remaining: \" + _actionPoints + \" min\", width - 25, 25);\r\n\t}\r\n}", "import { Font } from \"p5\";\r\nimport { AudioManager } from \"./AudioManager\";\r\nimport { Frequency } from \"./Enums\";\r\nimport { GameManager } from \"./GameManager\";\r\nimport { GlobalMessenger } from \"./GlobalMessenger\";\r\nimport { Locator } from \"./Locator\";\r\nimport { PlayerData } from \"./PlayerData\";\r\nimport { StatusFeed } from \"./StatusFeed\";\r\nimport { TimeLoop } from \"./TimeLoop\";\r\nimport { Minim, preloadAudio, preloadJSONObject, println } from \"./compat\";\r\nimport { GameSave } from \"./GameSave\";\r\n\r\n/*** GLOBALS ***/\r\nexport const TEXT_SIZE: number = 14;\r\n\r\nexport let locator: Locator;\r\nexport let gameManager: GameManager;\r\nexport let timeLoop: TimeLoop;\r\nexport let messenger: GlobalMessenger;\r\nexport let feed: StatusFeed;\r\nexport let playerData: PlayerData;\r\n \r\nexport let minim: Minim;\r\nexport let audioManager: AudioManager;\r\n\r\n/*** DEBUG ***/\r\nexport const EDIT_MODE: boolean = false;\r\nexport const SKIP_TITLE: boolean = false;\r\nexport const START_WITH_LAUNCH_CODES: boolean = false;\r\nexport const START_WITH_CLUES: boolean = false;\r\nexport const START_WITH_SIGNALS: boolean = false;\r\nexport const START_WITH_COORDINATES: boolean = false;\r\n\r\nlet lastMillis: number;\r\nlet deltaMillis: number;\r\n\r\nexport let smallFontData: Font;\r\nexport let mediumFontData: Font;\r\n\r\n(window as any).preload = function preload(): void {\r\n  smallFontData = loadFont(\"data/fonts/JiangChengYuanTi-400W.ttf\");\r\n  mediumFontData = loadFont(\"data/fonts/JiangChengYuanTi-400W.ttf\");\r\n  preloadAudio(\"data/audio/ow_kazoo_theme.mp3\");\r\n  preloadJSONObject(\"data/sectors/brittle_hollow.json\");\r\n  preloadJSONObject(\"data/sectors/comet.json\");\r\n  preloadJSONObject(\"data/sectors/dark_bramble.json\");\r\n  preloadJSONObject(\"data/sectors/eye_of_the_universe.json\");\r\n  preloadJSONObject(\"data/sectors/giants_deep.json\");\r\n  preloadJSONObject(\"data/sectors/quantum_moon.json\");\r\n  preloadJSONObject(\"data/sectors/rocky_twin.json\");\r\n  preloadJSONObject(\"data/sectors/sandy_twin.json\");\r\n  preloadJSONObject(\"data/sectors/timber_hearth.json\");\r\n};\r\n\r\n(window as any).setup = function setup(): void\r\n{\r\n  const canvas = document.getElementById(\"game-canvas\");\r\n  createCanvas(960, 720, null, canvas);\r\n\r\n  // Prevent p5 from setting canvas size, we do it in css.\r\n  canvas.style.removeProperty(\"width\");\r\n  canvas.style.removeProperty(\"height\");\r\n\r\n  // Disable context menu on canvas,\r\n  // to avoid interfering with game's right click.\r\n  canvas.oncontextmenu = () => false;\r\n\r\n  canvas.ontouchstart = (e) => {\r\n    // Simulate right click on p5 when touching with a second finger\r\n    mouseButton = e.touches.length === 2 ? RIGHT : LEFT;\r\n  }\r\n\r\n  const fullScreenButton = document.getElementById(\"full-screen-button\");\r\n  fullScreenButton.onclick = () => {\r\n    if (document.fullscreenElement) {\r\n      document.exitFullscreen();\r\n    } else {\r\n      document.documentElement.requestFullscreen();\r\n    }\r\n  }\r\n\r\n  noSmooth();\r\n  colorMode(HSB, 360, 100, 100, 100);\r\n  rectMode(CENTER);\r\n  ellipseMode(CENTER);\r\n  \r\n  smallFont();\r\n    \r\n  minim = new Minim();\r\n\r\n  initGame();\r\n};\r\n\r\nfunction initGame(): void\r\n{\r\n  const startLoadTime: number = millis();\r\n  \r\n  timeLoop = new TimeLoop();\r\n  audioManager = new AudioManager();\r\n  messenger = new GlobalMessenger();\r\n  feed = new StatusFeed();\r\n  gameManager = new GameManager();\r\n  playerData =  GameSave.loadData();\r\n  gameManager.newGame();\r\n  \r\n  println(\"Load time:\", (millis() - startLoadTime));\r\n}\r\n\r\n(window as any).draw = function draw(): void\r\n{\r\n  gameManager.runGameLoop();\r\n\r\n  // stroke(0, 0, 100);\r\n  // fill(0, 0, 0);\r\n  // triangle(mouseX, mouseY, mouseX, mouseY - 10, mouseX + 10, mouseY - 10);\r\n  \r\n  deltaMillis = millis() - lastMillis;\r\n  lastMillis = millis();\r\n  \r\n  //println(deltaMillis);\r\n};\r\n\r\nexport function frequencyToString(frequency: Frequency): string\r\n{\r\n  switch(frequency)\r\n  {\r\n    case Frequency.TRAVELER:\r\n      return \"\u65C5\u884C\u8005\u9891\u7387\";\r\n    case Frequency.BEACON:\r\n      return \"\u6C42\u6551\u4FE1\u6807\";\r\n    case Frequency.QUANTUM:\r\n      return \"\u91CF\u5B50\u6CE2\u52A8\";\r\n    default:\r\n      return \"\";\r\n  }\r\n}\r\n\r\nexport function resetLocator(): void {\r\n  locator = new Locator();\r\n}\r\n\r\nexport function smallFont(): void\r\n{\r\n  textSize(14);\r\n  textFont(smallFontData);\r\n}\r\n\r\nexport function mediumFont(): void\r\n{\r\n  textSize(18);\r\n  textFont(mediumFontData);\r\n}\r\n"],
  "mappings": "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",
  "names": ["preloadCache", "println", "args", "preloadJSONObject", "path", "preloadAudio", "loadJSONObject", "JSONObject", "saveJSONObject", "obj", "exit", "Minim", "sound", "AudioPlayer", "JSONArray", "data", "index", "value", "key", "_JSONObject", "defaultValue", "SoundLibrary", "_SoundLibrary", "println", "minim", "AudioManager", "_AudioManager", "sound", "Frequency", "Vector2", "_Vector2", "vecOrX", "y", "vec", "v", "value", "mag", "v1", "v2", "dot", "Entity", "posOrX", "y", "pos", "Vector2", "newPosOrX", "parentScreenPos", "i", "newScreenPos", "child", "Actor", "_Actor", "d", "v", "node", "screenPos", "Player", "xPos", "yPos", "s", "Ship", "player", "skipFill", "Probe", "Button", "Entity", "buttonID", "x", "y", "w", "h", "Vector2", "newColor", "prompt", "observer", "alpha", "smallFontData", "OWScreen", "i", "Vector2", "Entity", "button", "toolbarWidth", "xPos", "buttonHalfWidth", "bgColor", "starColor", "playerData", "j", "DatabaseScreen", "OWScreen", "Button", "Entity", "i", "playerData", "clueButton", "ClueButton", "observer", "clue", "feed", "button", "gameManager", "x", "y", "w", "_displayText", "mediumFontData", "wrappedLines", "currentY", "lineHeight", "line", "text", "maxWidth", "lines", "paragraphs", "paragraph", "currentLine", "char", "testLine", "symbolColor", "GlobalMessenger", "observer", "messageOrID", "message", "Message", "i", "messageID", "PlayerData", "START_WITH_LAUNCH_CODES", "START_WITH_COORDINATES", "START_WITH_SIGNALS", "Clue", "messenger", "message", "feed", "GameSave", "locator", "gameManager", "frequency", "frequencyToString", "i", "id", "curiosity", "name", "description", "START_WITH_CLUES", "GameSave", "data", "playerData", "PlayerData", "playerDataSave", "TitleScreen", "OWScreen", "GameSave", "text", "xOffset", "Button", "SKIP_TITLE", "gameManager", "AudioManager", "SoundLibrary", "button", "exit", "EndScreen", "EventScreen", "_EventScreen", "OWScreen", "Button", "mediumFontData", "displayText", "wrappedLines", "y", "lineHeight", "line", "feed", "timeLoop", "text", "maxWidth", "lines", "paragraphs", "paragraph", "currentLine", "char", "testLine", "button", "gameManager", "clue", "DeathByAnglerfishScreen", "playerData", "DiveAttemptScreen", "TeleportScreen", "teleportText", "destination", "messenger", "Message", "MoveToScreen", "moveText", "SectorArrivalScreen", "arrivalText", "sectorName", "QuantumArrivalScreen", "QuantumEntanglementScreen", "locator", "FollowTheVineScreen", "AncientVesselScreen", "TimeLoopCentralScreen", "EyeOfTheUniverseScreen", "EndScreen", "BrambleOutskirtsScreen", "ScreenManager", "activeScreen", "lowestRenderIndex", "i", "println", "newScreen", "nextScreen", "ExploreData", "node", "nodeObj", "JSONArray", "i", "exploreObj", "turnCycle", "turn", "timeLoop", "clueID", "gameManager", "messenger", "eventID", "MoveToScreen", "TeleportScreen", "playerData", "pathArray", "feed", "FrequencyButton", "Button", "rightFacing", "Vector2", "alpha", "Telescope", "signalSources", "i", "frequencyText", "frequencyToString", "playerData", "xPos", "mediumFontData", "smallFontData", "index", "Frequency", "f", "SignalSource", "Entity", "nodeOrPos", "sector", "OWNode", "signal", "telescopePos", "frequency", "dist", "u", "Signal", "signalType", "OWNode", "_OWNode", "Entity", "xOrID", "yOrObj", "messenger", "Button", "nodeJSONObj", "ExploreData", "EDIT_MODE", "Signal", "println", "message", "node", "isPlayerInShip", "playerNode", "nodeOrID", "visible", "connection", "playerData", "textPos", "Vector2", "TEXT_SIZE", "observer", "button", "i", "NodeConnection", "n1", "n2", "connectionObj", "EDIT_MODE", "playerNode", "node", "startingNode", "messenger", "visible", "dir", "dist", "l", "segmentLength", "startPos", "endPos", "tip", "base", "right", "left", "Sector", "Vector2", "Entity", "OWNode", "messenger", "offsetX", "offsetY", "filename", "loadJSONObject", "nodes", "nodeName", "connectionJSONArray", "i", "connection", "node1", "node2", "NodeConnection", "name", "nodeObj", "saveJSONObject", "println", "message", "node", "gameManager", "SectorArrivalScreen", "locator", "QuantumEntanglementScreen", "clue", "isPlayerInShip", "playerNode", "indexOrID", "signalSources", "SignalSource", "nodeSignals", "observer", "actor", "nodeOrName", "atNode", "ExploreScreen", "_ExploreScreen", "OWScreen", "location", "Button", "mediumFontData", "exploreText", "wrappedLines", "y", "lineHeight", "line", "feed", "timeLoop", "text", "maxWidth", "lines", "paragraphs", "paragraph", "currentLine", "char", "testLine", "clue", "gameManager", "locator", "button", "NodeAction", "observer", "button", "description", "ProbeAction", "player", "location", "feed", "probe", "Probe", "ExploreAction", "timeLoop", "gameManager", "ExploreScreen", "TravelAction", "ship", "destination", "prompt", "connection", "messenger", "SectorEditor", "sector", "Button", "Vector2", "button", "node", "SectorScreen", "OWScreen", "sector", "player", "ship", "SectorEditor", "Button", "button", "gameManager", "feed", "timeLoop", "clue", "exploreData", "ExploreScreen", "EDIT_MODE", "mediumFontData", "target", "actions", "smallFont", "yOffset", "promptWidth", "i", "succeeded", "node", "connection", "ProbeAction", "TravelAction", "ExploreAction", "SectorTelescopeScreen", "OWScreen", "sector", "telescope", "FrequencyButton", "Button", "button", "gameManager", "AnglerfishNode", "OWNode", "nodeName", "nodeJSONObj", "messenger", "QuantumNode", "OWNode", "name", "nodeJSON", "quantumState", "visible", "connection", "locator", "Comet", "Sector", "RockyTwin", "SandyTwin", "TimberHearth", "BrittleHollow", "radius", "start", "end", "spirals", "step", "x0", "y0", "t", "theta", "r", "x3", "y3", "x2", "y2", "x1", "y1", "GiantsDeep", "DarkBramble", "i", "index", "name", "nodeObj", "newNode", "AnglerfishNode", "Vector2", "OWNode", "QuantumMoon", "message", "locator", "gameManager", "QuantumArrivalScreen", "QuantumNode", "tLocation", "actor", "EyeOfTheUniverse", "SolarSystem", "messenger", "println", "Comet", "RockyTwin", "SandyTwin", "TimberHearth", "BrittleHollow", "GiantsDeep", "DarkBramble", "QuantumMoon", "EyeOfTheUniverse", "Player", "Ship", "message", "tNode", "node", "feed", "i", "teleportNode", "gameManager", "nodeName", "sectorName", "SectorButton", "Button", "id", "x", "y", "w", "h", "sector", "OWNode", "name", "xPos", "locator", "smallFontData", "CometButton", "HourglassTwinsButton", "centerX", "isRightTwin", "TimberHearthButton", "BrittleHollowButton", "GiantsDeepButton", "DarkBrambleButton", "QuantumMoonButton", "targets", "i", "println", "SolarSystemScreen", "OWScreen", "solarSystem", "buttonHeight", "HourglassTwinsButton", "TimberHearthButton", "BrittleHollowButton", "GiantsDeepButton", "DarkBrambleButton", "CometButton", "targets", "QuantumMoonButton", "i", "button", "selectedSector", "sector", "SolarSystemTelescopeScreen", "telescope", "FrequencyButton", "Button", "SignalSource", "gameManager", "SolarSystemMapScreen", "feed", "timeLoop", "actor", "idlePos", "Vector2", "nextSector", "SupernovaScreen", "_SupernovaScreen", "OWScreen", "feed", "playerData", "button", "FlashbackScreen", "_FlashbackScreen", "i", "gameManager", "fadeAlpha", "GameOverScreen", "Button", "GameManager", "ScreenManager", "TitleScreen", "DatabaseScreen", "messenger", "feed", "timeLoop", "playerData", "Telescope", "SolarSystem", "SolarSystemMapScreen", "resetLocator", "FlashbackScreen", "GameOverScreen", "message", "DeathByAnglerfishScreen", "DiveAttemptScreen", "FollowTheVineScreen", "AncientVesselScreen", "TimeLoopCentralScreen", "EyeOfTheUniverseScreen", "BrambleOutskirtsScreen", "SolarSystemTelescopeScreen", "sector", "SectorTelescopeScreen", "sectorOrName", "Sector", "SectorScreen", "Locator", "gameManager", "StatusFeed", "_StatusFeed", "messenger", "message", "newLine", "important", "StatusLine", "i", "_StatusLine", "x", "y", "mediumFontData", "smallFontData", "TimeLoop", "_TimeLoop", "feed", "messenger", "message", "gameManager", "SupernovaScreen", "minutes", "points", "playerData", "lastActionPoints", "r", "x", "y", "TEXT_SIZE", "locator", "gameManager", "timeLoop", "messenger", "feed", "playerData", "minim", "audioManager", "EDIT_MODE", "SKIP_TITLE", "START_WITH_LAUNCH_CODES", "START_WITH_CLUES", "START_WITH_SIGNALS", "START_WITH_COORDINATES", "lastMillis", "deltaMillis", "smallFontData", "mediumFontData", "preloadAudio", "preloadJSONObject", "canvas", "e", "fullScreenButton", "smallFont", "Minim", "initGame", "startLoadTime", "TimeLoop", "AudioManager", "GlobalMessenger", "StatusFeed", "GameManager", "GameSave", "println", "frequencyToString", "frequency", "resetLocator", "Locator", "mediumFont"]
}
